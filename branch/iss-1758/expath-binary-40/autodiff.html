<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" lang="EN"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><!--Generated by the DeltaXML.com xhtml-outfilter.xsl--><!--Using XSL Processor: Saxonica--><title>EXPath Binary Module 4.0 </title><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link rel="stylesheet" type="text/css" href="css/w3c-base.css"><link rel="stylesheet" href="css/qtspecs.css"><link rel="stylesheet" href="css/xpath-functions-40.css"><script src="js/fo-datalist.js"></script><style type="text/css">
          body { margin-top: 50px }
          a.button { background: #DDD; border: 2px outset black; padding: 2px; margin: 2px; font-family: sans-serif; font-size: small;}
          a.button:hover { cursor:pointer; }
          a.button:active { border-style: inset; }
        </style><link rel="stylesheet" href="/css/autodiff.css"></head><body><div style="position:fixed; clear:both; top:0px" id="_autodiff_buttons"><p><a class="button" onclick="view('old')">
              View Old
            </a><a class="button" onclick="view('new')">
              View New
            </a><a class="button" onclick="view('both')">
              View Both
            </a><a class="button" onclick="view('only')">
              View Only
            </a><a class="button" onclick="scroll_to('prev')">
              Previous
            </a><a class="button" onclick="scroll_to('next')">
              Next
            </a><span id="__autodiff__"></span></p></div><div class="head"><p><a href="https://www.w3.org/"><img src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" alt="W3C" height="48" width="72"></a></p><h1><a id="title"></a>EXPath Binary Module 4.0 </h1><h2><a id="w3c-doctype"></a>W3C Editor's Draft <span class="deltaxml-old" style="background:#FF5555">3</span><span class="deltaxml-new" style="background:#90EE90">4</span>&nbsp;February&nbsp;2025</h2><dl><dt>This version:</dt><dd><a href="https://qt4cg.org/branch/iss-1758/EXPath/binary-40//">https://qt4cg.org/<span class="deltaxml-old" style="background:#FF5555">specifications/</span><span class="deltaxml-new" style="background:#90EE90">branch/iss-1758/</span>EXPath/binary-40/</a></dd><dt>Latest version of EXPath Binary Module 4.0:</dt><dd><a href="https://qt4cg.org/specifications/EXPath/binary-40/">https://qt4cg.org/specifications/EXPath/binary-40/</a></dd><dt>Most recent Recommendation of EXPath Binary Module:</dt><dd><a href="http://expath.org/spec/binary">http://expath.org/spec/binary</a></dd><dt>Editors:</dt><dd>Jirka Kosek <a href="http://www.saxonica.com/">&lt;http://kosek.com/&gt;</a></dd><dd>John Lumley <a href="http://www.saxonica.com/">&lt;http://www.saxonica.com/&gt;</a></dd><dd><span class="deltaxml-new" style="background:#90EE90">Michael Kay </span><a href="http://www.saxonica.com/"><span class="deltaxml-new" style="background:#90EE90">&lt;http://www.saxonica.com/&gt;</span></a></dd></dl><p>Please check the <a href="https://www.w3.org/XML/2017/qt-errata/xpath-functions-31-errata.html"><strong>errata</strong></a> for any errors or issues reported since publication.</p><p>See also <a href="https://www.w3.org/2003/03/Translations/byTechnology?technology=xpath-functions-40"><strong>translations</strong></a>.</p><p>This document is also available in these non-normative formats: <a href="binary-40.xml">Specification in XML format<span class="deltaxml-old" style="background:#FF5555"> using HTML5 vocabulary</span></a> and&nbsp;<a href="function-catalog.xml">XML function catalog</a>.</p><p class="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>&nbsp;©&nbsp;2000&nbsp;<a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p><hr></div><div><h2><a id="abstract"></a>Abstract</h2><p>This document defines an API for XPath 4.0 to handle the manipulation of binary data. It defines extension functions to process data from, and generate <span class="deltaxml-old" style="background:#FF5555">date</span><span class="deltaxml-new" style="background:#90EE90">data</span> for, binary resources, including extracting subparts, searching, basic binary operations and conversion between binary and structured forms of XDM numbers and strings.</p><p>The document is an update of the original <a href="#expath-bin">[EXPath Binary 1.0]</a> specification, developed by the <a href="http://www.w3.org/community/expath/">EXPath Community Group</a>, defined for <a href="#xpath20">[XML Path Language (XPath) 2.0]</a> and published in 2013.</p><p>The principal semantic alteration is use of functional argument defaults available in XPath 4.0.</p><p>These functions are defined for use in <a href="#xpath-40">[XML Path Language (XPath) 4.0]</a><span class="deltaxml-old" style="background:#FF5555"> and</span><span class="deltaxml-new" style="background:#90EE90">,</span> <a href="#xquery-40">[XQuery <span class="deltaxml-old" style="background:#FF5555">4.1</span><span class="deltaxml-new" style="background:#90EE90">4.0</span>: An XML Query Language]</a><span class="deltaxml-old" style="background:#FF5555"> and</span><span class="deltaxml-new" style="background:#90EE90">,</span> <a href="#xslt-40">[XSL Transformations (XSLT) Version 4.0]</a><span class="deltaxml-new" style="background:#90EE90">,</span> and other related XML standards. <span class="deltaxml-old" style="background:#FF5555">The signatures and summaries of functions defined in this document are available at: </span><a href="https://qt4cg.org/specifications/EXPath/binary-40/"><span class="deltaxml-old" style="background:#FF5555">https://qt4cg.org/specifications/EXPath/binary-40/</span></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><p>A summary of changes since published version 1.0 <span class="deltaxml-old" style="background:#FF5555">(the XPath 2.0 version) </span>is provided at <a href="#changelog"><b>F Changes since version 1.0</b></a>.</p></div><div><h2><a id="status"></a>Status of this Document</h2><p><span style="display: none;" class="delete_version">This version of the specification is work in progress. It is produced by the QT4 Working Group, officially the W3C XSLT 4.0 Extensions Community Group. Individual functions specified in the document may be at different stages of review, reflected in their <b>History</b> notes. Comments are invited, in the form of GitHub issues at <a href="https://github.com/qt4cg/qtspecs">https://github.com/qt4cg/qtspecs</a>.</span><span style="display: none;" class="add_version">This version of the specification is work in progress. It is produced by the QT4 Working Group, officially the W3C XSLT 4.0 Extensions Community Group. Individual functions specified in the document may be at different stages of review, reflected in their <b>Changes</b> notes. Comments are invited, in the form of GitHub issues at <a href="https://github.com/qt4cg/qtspecs">https://github.com/qt4cg/qtspecs</a>.</span><span class="modify_version">This version of the specification is work in progress. It is produced by the QT4 Working Group, officially the W3C XSLT 4.0 Extensions Community Group. Individual functions specified in the document may be at different stages of review, reflected in their <b><span class="deltaxml-old" style="background:#FF5555">History</span><span class="deltaxml-new" style="background:#90EE90">Changes</span></b> notes. Comments are invited, in the form of GitHub issues at <a href="https://github.com/qt4cg/qtspecs">https://github.com/qt4cg/qtspecs</a>.</span></p><div class="dedication" id="dedication"><h3>Dedication</h3><p>The publications of this community group <a href="../xquery-40/xpath-40.html#dedication">are dedicated</a> to our co-chair, Michael Sperberg-McQueen&nbsp;(1954–2024).</p></div></div><nav id="toc"><div id="function-finder"><div class="ffheader">FUNCTION FINDER</div><div><span>Function search: <input id="select-fn" list="fn-list" type="text"><button id="help-select-fn-button">?</button></span><p id="help-select-fn" style="display:none;">Type a function name, or press down arrow for a list.</p><datalist id="fn-list"><option value="bin:and⁣"></option><option value="bin:bin⁣"></option><option value="bin:decode-string⁣"></option><option value="bin:encode-string⁣"></option><option value="bin:find⁣"></option><option value="bin:from-octets⁣"></option><option value="bin:hex⁣"></option><option value="bin:insert-before⁣"></option><option value="bin:join⁣"></option><option value="bin:length⁣"></option><option value="bin:not⁣"></option><option value="bin:octal⁣"></option><option value="bin:or⁣"></option><option value="bin:pack-double⁣"></option><option value="bin:pack-float⁣"></option><option value="bin:pack-integer⁣"></option><option value="bin:pad-left⁣"></option><option value="bin:pad-right⁣"></option><option value="bin:part⁣"></option><option value="bin:shift⁣"></option><option value="bin:to-octets⁣"></option><option value="bin:unpack-double⁣"></option><option value="bin:unpack-float⁣"></option><option value="bin:unpack-integer⁣"></option><option value="bin:unpack-unsigned-integer⁣"></option><option value="bin:xor⁣"></option></datalist></div></div><h2><a id="contents"></a>Table of Contents<span class="expalltoc collapsed"> ▶</span></h2><ol class="toc"><li><details><summary><a href="#intro"><span class="secno">1 </span><span class="content toc-chg">Introduction</span></a><span class="exptoc collapsed"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#error.management"><span style="display: none;" class="delete_version"><span class="secno">1.1 </span><span class="content">Error management</span></span><span style="display: none;" class="add_version"><span class="secno">1.1 </span><span class="content">Error codes</span></span><span class="modify_version"><span class="secno">1.1 </span><span class="content">Error <span class="deltaxml-old" style="background:#FF5555">management</span><span class="deltaxml-new" style="background:#90EE90">codes</span></span></span></a></summary></details></li><li><details><summary><a href="#type"><span style="display: none;" class="delete_version"><span class="secno">1.2 </span><span class="content toc-chg">Binary type</span></span><span style="display: none;" class="add_version"><span class="secno">1.2 </span><span class="content toc-chg">Binary types</span></span><span class="modify_version"><span class="secno">1.2 </span><span class="content toc-chg">Binary <span class="deltaxml-old" style="background:#FF5555">type</span><span class="deltaxml-new" style="background:#90EE90">types</span></span></span></a></summary></details></li><li><details><summary><a href="#testing"><span class="secno">1.3 </span><span class="content">Test suite</span></a></summary></details></li><li><details><summary><a href="#conformance"><span class="secno">1.4 </span><span class="content">Conformance</span></a></summary></details></li><li><details><summary><a href="#namespace-prefixes"><span class="secno">1.5 </span><span class="content">Namespaces and prefixes</span></a></summary></details></li><li><details><summary><a href="#func-signatures"><span class="secno">1.6 </span><span class="content">Function signatures and descriptions</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#use-cases"><span class="secno">2 </span><span class="content">Use cases</span></a><span class="exptoc collapsed"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#example-JPEG"><span class="secno">2.1 </span><span class="content">Example – finding JPEG size</span></a></summary></details></li><li><details><summary><a href="#example-ASN1"><span class="secno">2.2 </span><span class="content toc-chg">Example – reading and writing variable length ASN.1 integers</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#loading"><span class="secno"><span class="deltaxml-old" style="background:#FF5555">3 </span></span><span class="content toc-chg"><span class="deltaxml-old" style="background:#FF5555">Loading and saving binary data</span></span></a></summary><summary><a href="#id-other-operations"><span class="secno"><span class="deltaxml-new" style="background:#90EE90">3 </span></span><span class="content"><span class="deltaxml-new" style="background:#90EE90">Other Operations on Binary Values</span></span></a><span class="exptoc collapsed"><span class="deltaxml-new" style="background:#90EE90"> ▶</span></span></summary><ol class="toc"><li><details><summary><a href="#conversion"><span class="secno"><span class="deltaxml-new" style="background:#90EE90">3.1 </span></span><span class="content"><span class="deltaxml-new" style="background:#90EE90">Conversions</span></span></a></summary></details></li><li><details><summary><a href="#comparison"><span class="secno"><span class="deltaxml-new" style="background:#90EE90">3.2 </span></span><span class="content"><span class="deltaxml-new" style="background:#90EE90">Comparison</span></span></a></summary></details></li><li><details><summary><a href="#numeric-representation"><span class="secno"><span class="deltaxml-new" style="background:#90EE90">3.3 </span></span><span class="content"><span class="deltaxml-new" style="background:#90EE90">Numeric representation</span></span></a></summary></details></li><li><details><summary><a href="#loading"><span class="secno"><span class="deltaxml-new" style="background:#90EE90">3.4 </span></span><span class="content toc-chg"><span class="deltaxml-new" style="background:#90EE90">Loading and saving binary data</span></span></a></summary></details></li></ol></details></li><li><details><summary><span style="display: none;" class="delete_version"><a href="#constants"><span class="delete_version"><span class="secno">4 </span><span class="content">Defining 'constants' and conversions</span></span><span class="modify_version"><span class="secno">4 </span><span class="content">Defining 'constants' and conversions</span></span></a><span class="exptoc collapsed"> ▶</span></span><span style="display: none;" class="add_version"><a href="#constants"><span class="add_version"><span class="secno">4 </span><span class="content">Defining constants and conversions</span></span><span class="modify_version"><span class="secno">4 </span><span class="content">Defining constants and conversions</span></span></a><span class="exptoc collapsed"> ▶</span></span><span class="modify_version"><a href="#constants"><span style="display: none;" class="delete_version"><span class="secno">4 </span><span class="content">Defining 'constants' and conversions</span></span><span style="display: none;" class="add_version"><span class="secno">4 </span><span class="content">Defining constants and conversions</span></span><span class="modify_version"><span class="secno">4 </span><span class="content">Defining <span class="deltaxml-old" style="background:#FF5555">'</span>constants<span class="deltaxml-old" style="background:#FF5555">'</span> and conversions</span></span></a><span class="exptoc collapsed"> ▶</span></span></summary><ol class="toc"><li><details><summary><a href="#func-bin-hex"><span style="display: none;" class="delete_version"><span class="secno">4.1 </span><span class="content">bin:hex</span></span><span style="display: none;" class="add_version"><span class="secno">4.1 </span><span class="content toc-chg">bin:hex</span></span><span class="modify_version"><span class="secno">4.1 </span><span class="content toc-chg">bin:hex</span></span></a></summary></details></li><li><details><summary><a href="#func-bin-binary"><span style="display: none;" class="delete_version"><span class="secno">4.2 </span><span class="content">bin:bin</span></span><span style="display: none;" class="add_version"><span class="secno">4.2 </span><span class="content toc-chg">bin:bin</span></span><span class="modify_version"><span class="secno">4.2 </span><span class="content toc-chg">bin:bin</span></span></a></summary></details></li><li><details><summary><a href="#func-bin-octal"><span style="display: none;" class="delete_version"><span class="secno">4.3 </span><span class="content">bin:octal</span></span><span style="display: none;" class="add_version"><span class="secno">4.3 </span><span class="content toc-chg">bin:octal</span></span><span class="modify_version"><span class="secno">4.3 </span><span class="content toc-chg">bin:octal</span></span></a></summary></details></li><li><details><summary><a href="#func-bin-to-octets"><span style="display: none;" class="delete_version"><span class="secno">4.4 </span><span class="content">bin:to-octets</span></span><span style="display: none;" class="add_version"><span class="secno">4.4 </span><span class="content toc-chg">bin:to-octets</span></span><span class="modify_version"><span class="secno">4.4 </span><span class="content toc-chg">bin:to-octets</span></span></a></summary></details></li><li><details><summary><a href="#func-bin-from-octets"><span style="display: none;" class="delete_version"><span class="secno">4.5 </span><span class="content">bin:from-octets</span></span><span style="display: none;" class="add_version"><span class="secno">4.5 </span><span class="content toc-chg">bin:from-octets</span></span><span class="modify_version"><span class="secno">4.5 </span><span class="content toc-chg">bin:from-octets</span></span></a></summary></details></li></ol></details></li><li><details><summary><a href="#basic-operations"><span class="secno">5 </span><span class="content toc-chg">Basic operations</span></a><span class="exptoc collapsed"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#func-bin-length"><span class="secno">5.1 </span><span class="content">bin:length</span></a></summary></details></li><li><details><summary><a href="#func-bin-part"><span class="secno">5.2 </span><span class="content">bin:part</span></a></summary></details></li><li><details><summary><a href="#func-bin-join"><span class="secno">5.3 </span><span class="content">bin:join</span></a></summary></details></li><li><details><summary><a href="#func-bin-insert-before"><span class="secno">5.4 </span><span class="content">bin:insert-before</span></a></summary></details></li><li><details><summary><a href="#func-bin-pad-left"><span style="display: none;" class="delete_version"><span class="secno">5.5 </span><span class="content">bin:pad-left</span></span><span style="display: none;" class="add_version"><span class="secno">5.5 </span><span class="content toc-chg">bin:pad-left</span></span><span class="modify_version"><span class="secno">5.5 </span><span class="content toc-chg">bin:pad-left</span></span></a></summary></details></li><li><details><summary><a href="#func-bin-pad-right"><span style="display: none;" class="delete_version"><span class="secno">5.6 </span><span class="content">bin:pad-right</span></span><span style="display: none;" class="add_version"><span class="secno">5.6 </span><span class="content toc-chg">bin:pad-right</span></span><span class="modify_version"><span class="secno">5.6 </span><span class="content toc-chg">bin:pad-right</span></span></a></summary></details></li><li><details><summary><a href="#func-bin-find"><span class="secno">5.7 </span><span class="content">bin:find</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#text-encoding"><span class="secno">6 </span><span class="content">Text decoding and encoding</span></a><span class="exptoc collapsed"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#func-bin-decode-string"><span class="secno">6.1 </span><span class="content">bin:decode-string</span></a></summary></details></li><li><details><summary><a href="#func-bin-encode-string"><span class="secno">6.2 </span><span class="content">bin:encode-string</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#numeric-packing"><span class="secno">7 </span><span class="content">Packing and unpacking of encoded numeric values</span></a><span class="exptoc collapsed"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#number-rep"><span class="secno">7.1 </span><span class="content">Numeric representation</span></a><span class="exptoc"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#endianness"><span class="secno"><span class="deltaxml-old" style="background:#FF5555">7.1.1 </span></span><span class="content"><span class="deltaxml-old" style="background:#FF5555">Number 'endianness'</span></span></a><a href="#endianness"><span class="secno"><span class="deltaxml-new" style="background:#90EE90">7.1.1 </span></span><span class="content toc-chg"><span class="deltaxml-new" style="background:#90EE90">Octet order</span></span></a></summary></details></li><li><details><summary><a href="#integer"><span class="secno">7.1.2 </span><span class="content">Integer representation</span></a></summary></details></li><li><details><summary><a href="#floating"><span class="secno">7.1.3 </span><span class="content">Representation of floating point numbers</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#func-bin-pack-double"><span class="secno">7.2 </span><span class="content">bin:pack-double</span></a></summary></details></li><li><details><summary><a href="#func-bin-pack-float"><span class="secno">7.3 </span><span class="content">bin:pack-float</span></a></summary></details></li><li><details><summary><a href="#func-bin-pack-integer"><span class="secno">7.4 </span><span class="content">bin:pack-integer</span></a></summary></details></li><li><details><summary><a href="#func-bin-unpack-double"><span class="secno">7.5 </span><span class="content">bin:unpack-double</span></a></summary></details></li><li><details><summary><a href="#func-bin-unpack-float"><span class="secno">7.6 </span><span class="content">bin:unpack-float</span></a></summary></details></li><li><details><summary><a href="#func-bin-unpack-integer"><span class="secno">7.7 </span><span class="content">bin:unpack-integer</span></a></summary></details></li><li><details><summary><a href="#func-bin-unpack-unsigned-integer"><span class="secno">7.8 </span><span class="content">bin:unpack-unsigned-integer</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#bitwise"><span class="secno">8 </span><span class="content">Bitwise operations</span></a><span class="exptoc collapsed"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#func-bin-or"><span class="secno">8.1 </span><span class="content">bin:or</span></a></summary></details></li><li><details><summary><a href="#func-bin-xor"><span class="secno">8.2 </span><span class="content">bin:xor</span></a></summary></details></li><li><details><summary><a href="#func-bin-and"><span class="secno">8.3 </span><span class="content">bin:and</span></a></summary></details></li><li><details><summary><a href="#func-bin-not"><span class="secno">8.4 </span><span class="content">bin:not</span></a></summary></details></li><li><details><summary><a href="#func-bin-shift"><span class="secno">8.5 </span><span class="content">bin:shift</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#biblio"><span class="secno">A </span><span class="content">References</span></a><span class="exptoc collapsed"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#normative-biblio"><span class="secno">A.1 </span><span class="content">Normative references</span></a></summary></details></li><li><details><summary><a href="#non-normative-biblio"><span class="secno">A.2 </span><span class="content">Non-normative references</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#error-summary"><span class="secno">B </span><span class="content">Error summary</span></a></summary></details></li><li><details><summary><a href="#glossary"><span class="secno">C </span><span class="content">Glossary</span></a> (Non-Normative)</summary></details></li><li><details><summary><a href="#other-functions"><span class="secno">D </span><span class="content">Other Functions</span></a> (Non-Normative)<span class="exptoc"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#functions-in-other-w3c-specs"><span class="secno">D.1 </span><span class="content">XPath Functions and Operators Defined in Other W3C Recommendations</span></a><span class="exptoc"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#functions-defined-in-XPathFO"><span class="secno">D.1.1 </span><span class="content">Functions and Operators Defined in XPath and XQuery Functions and Operators</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#functions-defined-by-community-groups"><span class="secno">D.2 </span><span class="content">Functions Defined by Community Groups</span></a><span class="exptoc"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#functions-defined-in-EXPathFile"><span class="secno">D.2.1 </span><span class="content">Functions Defined in EXPath File</span></a></summary></details></li></ol></details></li></ol></details></li><li><details><summary><a href="#impl-def"><span class="secno">E </span><span class="content">Checklist of implementation-defined features</span></a> (Non-Normative)</summary></details></li><li><details><summary><a href="#changelog"><span class="secno">F </span><span class="content">Changes since version 1.0</span></a> (Non-Normative)<span class="exptoc"> ▶</span></summary><ol class="toc"><li><details><summary><a href="#changes-summary"><span class="secno">F.1 </span><span class="content">Summary of Changes</span></a></summary></details></li><li><details><summary><a href="#changes-to-function-signatures"><span class="secno">F.2 </span><span class="content">Changes to Function Signatures</span></a></summary></details></li><li><details><summary><a href="#editorial-changes"><span class="secno">F.3 </span><span class="content">Editorial Changes</span></a></summary></details></li></ol></details></li><li><details><summary><a href="#back-compatibility"><span class="secno">G </span><span class="content">Compatibility with Previous Versions</span></a> (Non-Normative)</summary></details></li></ol></nav><hr><div class="body"><div class="div1"><h2><a id="intro"></a>1 <a href="#intro" style="text-decoration: none">Introduction</a></h2><div class="changes"><p class="changesHeading">Changes in 4.0&nbsp;<a href="#type">⬇</a></p><ol><li><p>Use the arrows to browse significant changes since the 1.0 version of this specification.</p></li><li><p>Sections with significant changes are marked Δ in the table of contents. New functions introduced in this version are marked ➕ in the table of contents.</p></li></ol></div><p>The purpose of this document is to define functions to manipulate binary data for inclusion in XPath 4.0, XQuery 4.0, and XSLT 4.0. The binary data is represented by the type <code>xs:base64Binary</code> as defined by <a href="https://www.w3.org/TR/xmlschema-2/#base64Binary">Section 3.2.16 base64Binary</a><sup><small>XS2</small></sup>.</p><p>The <span class="deltaxml-old" style="background:#FF5555">exact </span>syntax used to call these functions and operators is specified in <a href="#xpath-40">[XML Path Language (XPath) 4.0]</a><span class="deltaxml-old" style="background:#FF5555">,</span> <a href="#xquery-40"><span class="deltaxml-old" style="background:#FF5555">[XQuery 4.1: An XML Query Language]</span></a><span class="deltaxml-old" style="background:#FF5555"> and</span><span class="deltaxml-new" style="background:#90EE90">and</span> <a href="#xslt-40"><span class="deltaxml-old" style="background:#FF5555">[XSL Transformations (XSLT) Version 4.0]</span></a><a href="#xquery-40"><span class="deltaxml-new" style="background:#90EE90">[XQuery 4.0: An XML Query Language]</span></a>. </p><p>This document defines several classes of functions:</p><ul><li><p>Functions to create <span class="deltaxml-old" style="background:#FF5555">binary 'constants'</span><span class="deltaxml-new" style="background:#90EE90">constant binary values</span> and convert between the binary forms and sequences of octets. </p></li><li><p>Functions to perform basic operations on binary values, such as joining, selecting and searching.</p></li><li><p>Functions to perform bitwise operations.</p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Functions to pack or unpack numeric values from within or into binary data.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Functions to convert between binary data and numeric values.</span></p></li><li><p>Functions to decode or encode strings<span class="deltaxml-old" style="background:#FF5555"> from within or into binary data&gt;</span>.</p></li></ul><p>References to specific sections of some other specifications are indicated by cross-document links in this document. Each such link consists of a pointer to a specific section followed a superscript specifying the linked document. The superscripts have the following meanings: FILE40 <a href="#expath-file-40">[EXPath File 4.0]</a>, FO40 <a href="#xpath-functions-40">[XQuery and XPath Functions and Operators 4.0]</a> and XS2 <a href="#xmlschema-2">[XML Schema Part 2: Datatypes Second Edition]</a></p><div class="div2"><h3><a id="error.management"></a>1.1 <a style="text-decoration: none" href="#error.management">Error <span class="deltaxml-old" style="background:#FF5555">management</span><span class="deltaxml-new" style="background:#90EE90">codes</span></a></h3><p><span style="display: none;" class="delete_version">Error conditions are identified by a code (a <code>QName</code>.) When such an error condition is reached in the evaluation of an expression, a dynamic error is thrown, with the corresponding error code (as if the standard XPath function <code>error()</code> had been called.)</span><span style="display: none;" class="add_version">Error conditions are identified by a code (a QName). When such an error condition is reached in the evaluation of an expression, a dynamic error is thrown, with the corresponding error code (as if the standard XPath function <code>error()</code> had been called).</span><span class="modify_version">Error conditions are identified by a code (a QName<span class="deltaxml-new" style="background:#90EE90">)</span>.<span class="deltaxml-old" style="background:#FF5555">)</span> When such an error condition is reached in the evaluation of an expression, a dynamic error is thrown, with the corresponding error code (as if the standard XPath function <code>error()</code> had been called<span class="deltaxml-old" style="background:#FF5555">.</span>)<span class="deltaxml-new" style="background:#90EE90">.</span></span></p><p><span style="display: none;" class="delete_version">In this specification these codes use the <code>http://expath.org/ns/binary</code> namespace and a 'descriptive string' local part, e.g. <code>bin:index-out-of-range</code>, rather than the <code>http://www.w3.org/2005/xqt-errors</code> namespace and alpha-numeric local part, e.g. <code>err:FOCH0004</code>, used in <a href="#xpath-functions-40">[XQuery and XPath Functions and Operators 4.0]</a>. These error codes were chosen originally in the 1.0 version of 2013.</span><span style="display: none;" class="add_version">In this specification these codes use the <code>http://expath.org/ns/binary</code> namespace with a local part in the form of a descriptive string, for example <code>bin:index-out-of-range</code>. This convention is used in place of the <code>http://www.w3.org/2005/xqt-errors</code> namespace and alpha-numeric local part, e.g. <code>err:FOCH0004</code> used in <a href="#xpath-functions-40">[XQuery and XPath Functions and Operators 4.0]</a>. These error codes have been largely retained from the 1.0 version of the EXPath specification.</span><span class="modify_version">In this specification these codes use the <code>http://expath.org/ns/binary</code> namespace <span class="deltaxml-old" style="background:#FF5555">and a 'descriptive string' local part, e.g.</span><span class="deltaxml-new" style="background:#90EE90">with a local part in the form of a descriptive string, for example</span> <code>bin:index-out-of-range</code><span class="deltaxml-old" style="background:#FF5555">, rather than</span><span class="deltaxml-new" style="background:#90EE90">. This convention is used in place of</span> the <code>http://www.w3.org/2005/xqt-errors</code> namespace and alpha-numeric local part, e.g. <code>err:FOCH0004</code><span class="deltaxml-old" style="background:#FF5555">,</span> used in <a href="#xpath-functions-40">[XQuery and XPath Functions and Operators 4.0]</a>. These error codes <span class="deltaxml-old" style="background:#FF5555">were chosen originally in</span><span class="deltaxml-new" style="background:#90EE90">have been largely retained from</span> the 1.0 version of <span class="deltaxml-old" style="background:#FF5555">2013</span><span class="deltaxml-new" style="background:#90EE90">the EXPath specification</span>.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Error codes are summarized in </span><a href="#error-summary"><b><span class="deltaxml-new" style="background:#90EE90">B Error summary</span></b></a><span class="deltaxml-new" style="background:#90EE90">.</span></p></div><div class="div2"><h3><a id="type"></a>1.2 <a style="text-decoration: none" href="#type">Binary <span class="deltaxml-old" style="background:#FF5555">type</span><span class="deltaxml-new" style="background:#90EE90">types</span></a></h3><div class="changes"><p class="changesHeading">Changes in 4.0&nbsp;<a href="#example-ASN1">⬇</a>&nbsp;<a href="#intro">⬆</a></p><ol><li><p><span style="display: none;" class="delete_version">Binary 'data' arguments to the functions are now declared to be either <code>xs:hexBinary</code> or <code>xs:base64Binary</code>, but binary function results remain of type <code>xs:base64Binary</code>. This should not cause any backward incompatibilities as casting back and forth between the two representations has been possible since at least version 2.0</span><span style="display: none;" class="add_version">Binary arguments to the functions are now declared to be either <code>xs:hexBinary</code> or <code>xs:base64Binary</code>, but binary function results remain of type <code>xs:base64Binary</code>. This should not cause any backward incompatibilities as casting back and forth between the two representations has been possible since at least version 2.0</span><span class="modify_version">Binary <span class="deltaxml-old" style="background:#FF5555">'data' </span>arguments to the functions are now declared to be either <code>xs:hexBinary</code> or <code>xs:base64Binary</code>, but binary function results remain of type <code>xs:base64Binary</code>. This should not cause any backward incompatibilities as casting back and forth between the two representations has been possible since at least version 2.0</span></p></li></ol></div><p><span class="deltaxml-old" style="background:#FF5555">The principal binary type within this module is </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555"> as defined by </span><a href="https://www.w3.org/TR/xmlschema-2/#base64Binary"><span class="deltaxml-old" style="background:#FF5555">Section 3.2.16 base64Binary</span></a><sup><small><span class="deltaxml-old" style="background:#FF5555">XS2</span></small></sup><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">In general, for the functions defined in this specification, if the result return is binary data, it will </span><em><span class="deltaxml-old" style="background:#FF5555">always</span></em><span class="deltaxml-old" style="background:#FF5555"> be of type </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555">. Any arguments to a function which are considered to be binary data can be either of type </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555"> or </span><code><span class="deltaxml-old" style="background:#FF5555">xs:hexBinary</span></code><span class="deltaxml-old" style="background:#FF5555">. </span></p><p><span class="deltaxml-new" style="background:#90EE90">XML Schema, and therefore the XDM data model, defines two primitive atomic types holding binary data: </span><a href="https://www.w3.org/TR/xmlschema-2/#base64Binary"><span class="deltaxml-new" style="background:#90EE90">Section 3.2.16 base64Binary</span></a><sup><small><span class="deltaxml-new" style="background:#90EE90">XS2</span></small></sup><span class="deltaxml-new" style="background:#90EE90"> and </span><a href="https://www.w3.org/TR/xmlschema-2/#hexBinary"><span class="deltaxml-new" style="background:#90EE90">Section 3.2.15 hexBinary</span></a><sup><small><span class="deltaxml-new" style="background:#90EE90">XS2</span></small></sup><span class="deltaxml-new" style="background:#90EE90">. In both cases the value space is a sequence of octets; the two types differ only in how the binary value is converted to or from a string. Although most functions in this specification are not concerned with the string representation of the value, they need to distinguish these two types, and </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90"> has been chosen arbitrarily as the result type for functions that return binary values. Where binary data is supplied as input to a function, however, both </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64binary</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">xs:hexBinary</span></code><span class="deltaxml-new" style="background:#90EE90"> are accepted.</span></p><p><span class="termdef"><a id="dt-binary-value"></a><span class="deltaxml-new" style="background:#90EE90">[Definition] The term </span><b><span class="deltaxml-new" style="background:#90EE90">binary value</span></b><span class="deltaxml-new" style="background:#90EE90"> is used to mean a sequence of octets represented as an instance of </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code><span class="deltaxml-new" style="background:#90EE90">xs:hexBinary</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></span></p><p>Conversion to and from <code>xs:hexBinary</code> can be performed by casting with <code>xs:hexBinary()</code> and <code>xs:base64Binary()</code>.</p><div class="note"><p class="prefix"><b>Note:</b></p><p><span class="deltaxml-old" style="background:#FF5555">As these types are normally implemented as wrappers around byte array structures containing the data, and differ only when being serialized to or parsed from text, such casting in-process should not involve data copying.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Internally it is likely that implementations will use the same byte array representation for both data types, and that casting will merely involve a change in the type annotation; it should not require data to be copied.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">An item of type </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555"> can be </span><em><span class="deltaxml-old" style="background:#FF5555">empty</span></em><span class="deltaxml-old" style="background:#FF5555">, i.e. contain no data, (in the same way that items of type </span><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code><span class="deltaxml-old" style="background:#FF5555"> can contain no characters.) Where 'data' arguments to functions that return binary data are optional (i.e. </span><code><em><span class="deltaxml-old" style="background:#FF5555">$arg as type</span></em><span class="deltaxml-old" style="background:#FF5555">?</span></code><span class="deltaxml-old" style="background:#FF5555">) and any of those optional arguments is set to the empty sequence, in general an empty sequence is returned, rather than an empty item of type </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555">. </span></p><p><span class="termdef"><a id="dt-zero-length"></a><span class="deltaxml-new" style="background:#90EE90">[Definition] A </span><a title="binary value" class="termref" href="#dt-binary-value"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">binary value</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><span class="deltaxml-new" style="background:#90EE90"> that contains no octets is referred to as being </span><b><span class="deltaxml-new" style="background:#90EE90">zero-length</span></b><span class="deltaxml-new" style="background:#90EE90">. A zero-length binary value is an item, and as such is a sequence of length one, which is not the same thing as an empty sequence.</span></span></p></div><div class="div2"><h3><a id="testing"></a>1.3 <a href="#testing" style="text-decoration: none">Test suite</a></h3><p>A suite of test-cases for all the functions defined in this module, in <a href="#qt3">[QT3]</a> format, is defined at <a href="#tests.binary">[Test-suite]</a>.</p></div><div class="div2"><h3><a id="conformance"></a>1.4 <a href="#conformance" style="text-decoration: none">Conformance</a></h3><p>This specification follows the general remarks on and terminology for conformance given in <a href="https://qt4cg.org/specifications/xpath-functions-40/#conformance">Section 1.2 Conformance</a><sup><small>FO</small></sup></p><p>In this document, text labeled as an example or as a note is provided for explanatory purposes and is not normative.</p></div><div class="div2"><h3><a id="namespace-prefixes"></a>1.5 <a href="#namespace-prefixes" style="text-decoration: none">Namespaces and prefixes</a></h3><p><span style="display: none;" class="delete_version">The functions defined in this document are contained exclusively in the namespace <code>http://expath.org/ns/binary</code> and referenced using a <code>xs:QName</code> binding to that namespace.</span><span style="display: none;" class="add_version">The functions defined in this document are contained in the namespace <code>http://expath.org/ns/binary</code>. The conventional prefix for this namespace is <code>bin</code>.</span><span class="modify_version">The functions defined in this document are contained <span class="deltaxml-old" style="background:#FF5555">exclusively </span>in the namespace <code>http://expath.org/ns/binary</code><span class="deltaxml-old" style="background:#FF5555"> and referenced using a</span><span class="deltaxml-new" style="background:#90EE90">. The conventional prefix for</span> <span class="deltaxml-old" style="background:#FF5555">xs:QName</span><span class="deltaxml-new" style="background:#90EE90">this</span> <span class="deltaxml-old" style="background:#FF5555">binding to</span><span class="deltaxml-new" style="background:#90EE90">namespace is</span> <code><span class="deltaxml-old" style="background:#FF5555">that </span><span class="deltaxml-new" style="background:#90EE90">bin</span><span class="deltaxml-old" style="background:#FF5555">namespace</span></code>.</span></p><p><span style="display: none;" class="delete_version">This document uses the prefix <code>bin</code> to refer to this namespace. User-written applications can choose a different prefix to refer to the namespace, so long as it is bound to the correct URI. In accordance with current practice, it is recommended that the prefix <code>bin</code> be reserved for use with this namespace.</span><span style="display: none;" class="add_version">This document uses the prefix <code>bin</code> to refer to this namespace. User-written applications can choose a different prefix to refer to the namespace, so long as it is bound to the correct URI.</span><span class="modify_version">This document uses the prefix <code>bin</code> to refer to this namespace. User-written applications can choose a different prefix to refer to the namespace, so long as it is bound to the correct URI.<span class="deltaxml-old" style="background:#FF5555"> In accordance with current practice, it is recommended that the prefix </span><span class="deltaxml-old" style="background:#FF5555">bin</span><span class="deltaxml-old" style="background:#FF5555"> be reserved for use with this namespace.</span></span></p></div><div class="div2"><h3><a id="func-signatures"></a>1.6 <a href="#func-signatures" style="text-decoration: none">Function signatures and descriptions</a></h3><p><span style="display: none;" class="delete_version">Each function (or group of functions having the same name) is defined in this specification using a standard proforma, full details of which can be found in <a href="https://qt4cg.org/specifications/xpath-functions-40/#func-signatures">Section 1.5 Function signatures and descriptions</a><sup><small>FO</small></sup>. In particular in this update (trailing) optional arguments for functions (introduced in XPath 4.0) are used where appropriate in the signatures, rather than multiple-arity signatures as previously. </span><span style="display: none;" class="add_version">Each function (or group of functions having the same name) is defined in this specification using a standard proforma, full details of which can be found in <a href="https://qt4cg.org/specifications/xpath-functions-40/#func-signatures">Section 1.5 Function signatures and descriptions</a><sup><small>FO</small></sup>. In particular in this version (trailing) optional arguments for functions (introduced in XPath 4.0) are used where appropriate in the signatures, rather than multiple-arity signatures as previously. </span><span class="modify_version">Each function (or group of functions having the same name) is defined in this specification using a standard proforma, full details of which can be found in <a href="https://qt4cg.org/specifications/xpath-functions-40/#func-signatures">Section 1.5 Function signatures and descriptions</a><sup><small>FO</small></sup>. In particular in this <span class="deltaxml-old" style="background:#FF5555">update</span><span class="deltaxml-new" style="background:#90EE90">version</span> (trailing) optional arguments for functions (introduced in XPath 4.0) are used where appropriate in the signatures, rather than multiple-arity signatures as previously. </span></p><p><span class="deltaxml-new" style="background:#90EE90">All the functions defined in this specification are deterministic and independent of the static and dynamic context.</span></p><p><span class="deltaxml-new" style="background:#90EE90">All the functions described in this specification can in principle be defined in terms of two primitives: </span><code><span class="deltaxml-new" style="background:#90EE90">bin:to-octets</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">bin:from-octets</span></code><span class="deltaxml-new" style="background:#90EE90">, which convert between a </span><a title="binary value" class="termref" href="#dt-binary-value"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">binary value</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><span class="deltaxml-new" style="background:#90EE90"> and a sequence of </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90"> values (integers in the range 0 to 255). In many cases functions are specified with reference to a formal equivalent that defines the semantics of the function directly or indirectly in terms of these two primitives.</span></p></div></div><div class="div1"><h2><a id="use-cases"></a>2 <a href="#use-cases" style="text-decoration: none">Use cases</a></h2><p>Development of this specification was driven by requirements which some XML developers regularly encounter in examining or generating data which is presented in binary, or other non-textual forms. Some typical use cases include:</p><ul><li><p>Getting the dimensions of an image file.</p></li><li><p>Extracting image metadata.</p></li><li><p>Processing images embedded as base64 encodings within a SOAP message.</p></li><li><p>Processing legacy text files which use different encodings in separate sections.</p></li><li><p>Generating PDF files from SVG graphical data.</p></li></ul><div class="div2"><h3><a id="example-JPEG"></a>2.1 <a href="#example-JPEG" style="text-decoration: none">Example – finding JPEG size</a></h3><p><span style="display: none;" class="delete_version">As an example, the following code reads the binary form of a JPEG image file, searches for the 'Start of Frame/DCT' segment, and unpacks the relevant binary sections to integers of height and width:</span><span style="display: none;" class="add_version">As an example, the following code reads the binary form of a JPEG image file, searches for the 'Start of Frame/DCT' segment, and unpacks the relevant binary sections to integer-valued attributes <code>height</code> and <code>width</code>:</span><span class="modify_version">As an example, the following code reads the binary form of a JPEG image file, searches for the 'Start of Frame/DCT' segment, and unpacks the relevant binary sections to <span class="deltaxml-old" style="background:#FF5555">integers of</span><span class="deltaxml-new" style="background:#90EE90">integer-valued attributes</span> <code>height</code> and <code>width</code>:</span></p><div class="example"><div class="exampleInner"><pre class="small" xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">&lt;xsl:variable name="binary" select="file:read-binary(@href)" as="xs:base64Binary"/&gt;
&lt;xsl:variable name="location" select="bin:find($binary,0,bin:hex('FFC0'))"/&gt;
&lt;size width="{bin:unpack-unsigned-integer($binary,$location+5,2,'most-significant-first')}"
      height="{bin:unpack-unsigned-integer($binary,$location+7,2,'most-significant-first')}"/&gt;
               
      → &lt;size width="377" height="327"/&gt;</span></pre><pre class="small" xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">&lt;xsl:variable name="binary" 
              select="file:read-binary(@href)" 
              as="xs:base64Binary"/&gt;
&lt;xsl:variable name="location" 
              select="bin:find($binary, 0, bin:hex('FFC0'))"/&gt;
&lt;size width="{bin:unpack-unsigned-integer($binary, 
                                          $location+5,
                                          2, 
                                          'most-significant-first')}"
      height="{bin:unpack-unsigned-integer($binary,
                                           $location+7,
                                           2,
                                           'most-significant-first')}"/&gt;</span></pre></div><p><span class="deltaxml-new" style="background:#90EE90">The result is an element such as:</span></p><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">&lt;size width="377" height="327"/&gt;</span></pre></div></div><p><span class="deltaxml-old" style="background:#FF5555">(The </span><code><span class="deltaxml-old" style="background:#FF5555">'most-significant-first'</span></code><span class="deltaxml-old" style="background:#FF5555"> argument ensures the numeric conversion is 'big-endian', which is the format in JPEG.)</span></p><div class="note"><p class="prefix"><b><span class="deltaxml-new" style="background:#90EE90">Note:</span></b></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code><span class="deltaxml-new" style="background:#90EE90">'most-significant-first'</span></code><span class="deltaxml-new" style="background:#90EE90"> argument could be omitted, because it is the default. This is the numeric format used in JPEG: for further information see </span><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a><span class="deltaxml-new" style="background:#90EE90">.</span></p></div></div><div class="div2"><h3><a id="example-ASN1"></a>2.2 <a href="#example-ASN1" style="text-decoration: none">Example – reading and writing variable length ASN.1 integers</a></h3><div class="changes"><p class="changesHeading">Changes in 4.0&nbsp;<a href="#loading">⬇</a>&nbsp;<a href="#type">⬆</a></p><ol><li><p>The functions in this example have been moved into a differing namespace prefix (<code>asn:</code>) to avoid suggesting that they are part of the supported function set.</p></li></ol></div><p><span style="display: none;" class="delete_version"><a href="#asn1">[ASN.1]</a> defines several formats for identifying and encoding arbitrary-sized telecommunications data as streams of octets. Many of these forms specify the length of data as part of their encoding. For example, in the Basic Encoding Rules, an integer is represented as the following series of octets:</span><span style="display: none;" class="add_version"><a href="#asn1">[ASN.1]</a>, used in a number of telecommunications industry standards, defines a binary data syntax (the <b>basic encoding rules</b>) for identifying and encoding arbitrary data as streams of octets. Many of these forms specify the length of data as part of their encoding. For example, an integer has a variable-length representation as a sequence of octets:</span><span class="modify_version"><a href="#asn1">[ASN.1]</a><span class="deltaxml-old" style="background:#FF5555"> defines several formats</span><span class="deltaxml-new" style="background:#90EE90">, used in a number of telecommunications industry standards, defines a binary data syntax (the</span> <b><span class="deltaxml-new" style="background:#90EE90">basic encoding rules</span></b><span class="deltaxml-new" style="background:#90EE90">) </span>for identifying and encoding arbitrary<span class="deltaxml-old" style="background:#FF5555">-sized telecommunications</span> data as streams of octets. Many of these forms specify the length of data as part of their encoding. For example, <span class="deltaxml-old" style="background:#FF5555">in the Basic Encoding Rules, an integer is represented as the following series</span><span class="deltaxml-new" style="background:#90EE90">an integer has a variable-length representation as a sequence</span> of octets:</span></p><ul><li><p><span class="deltaxml-old" style="background:#FF5555">Type – 1 octet – in this case the value </span><code><span class="deltaxml-old" style="background:#FF5555">0x02</span></code></p><p><span class="deltaxml-new" style="background:#90EE90">The first octet has the value </span><code><span class="deltaxml-new" style="background:#90EE90">0x02</span></code><span class="deltaxml-new" style="background:#90EE90"> to indicate that this is an integer.</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Length – ≥ 1 octet – the number of octets in the integer value. The length field itself can be variable in length – to accommodate VERY large integers (requiring more than 127 octets to represent, e.g. 2048-bit crypto keys.)</span></p><p><span class="deltaxml-new" style="background:#90EE90">Next, a variable-length length field to indicate the length of the payload. (This is designed to accommodate very large integers, such as those found in cryptography.)</span></p></li><li><p><span class="deltaxml-old" style="background:#FF5555">Payload – ≥ 0 octets –</span><span class="deltaxml-new" style="background:#90EE90">Finally, the payload itself:</span> the octets of the integer value in most-significant-first order.</p></li></ul><div class="example"><p>To generate such a representation for an integer from XSLT/XPath, the following code might be used:</p><div class="exampleInner"><pre class="small" xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555"> &lt;xsl:function name="asn:int-octets" as="xs:integer*"&gt;
    &lt;xsl:param name="value" as="xs:integer"/&gt;
    &lt;xsl:sequence
            select="if($value ne 0) then (bin:int-octets($value idiv 256),$value mod 256) else ()"/&gt;
 &lt;/xsl:function&gt;
 &lt;xsl:function name="asn:encode-ASN-integer" as="xs:base64Binary"&gt;
     &lt;xsl:param name="int" as="xs:integer"/&gt;
     &lt;xsl:variable name="octets" select="bin:int-octets($int)"/&gt;
     &lt;xsl:variable name="length-octets"
         select="let $l := count($octets) return
         (if($l le 127) then $l 
         else (let $lo := bin:int-octets($l) return (128+count($lo),$lo)))"/&gt;
     &lt;xsl:sequence select="bin:from-octets((2,$length-octets,$octets))"/&gt;
 &lt;/xsl:function&gt;</span></pre><pre class="small" xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90"> &lt;xsl:function name="asn:int-octets" as="xs:integer*"&gt;
    &lt;xsl:param name="value" as="xs:integer"/&gt;
    &lt;xsl:sequence select="if ($value ne 0) 
                          then (bin:int-octets($value idiv 256), $value mod 256) 
                          else ()"/&gt;
 &lt;/xsl:function&gt;
 
 &lt;xsl:function name="asn:encode-ASN-integer" as="xs:base64Binary"&gt;
    &lt;xsl:param name="int" as="xs:integer"/&gt;
    &lt;xsl:variable name="octets" select="bin:int-octets($int)"/&gt;
    &lt;xsl:variable name="length-octets"
       select="let $l := count($octets) 
               return ( if ($l le 127) 
                        then $l 
                        else ( let $lo := bin:int-octets($l) 
                               return (128+count($lo), $lo)
                             )
                      )"/&gt;
    &lt;xsl:sequence select="bin:from-octets((2,$length-octets,$octets))"/&gt;
 &lt;/xsl:function&gt;</span></pre></div><p><span style="display: none;" class="delete_version">The function <code>asn:int-octets</code> returns a sequence of all the 'significant' octets of the integer (i.e. eliminating leading 'zeroes') in most-significant order. Examples of the encoding are: </span><span style="display: none;" class="add_version">The function <code>asn:int-octets</code> returns a sequence of all the significant octets of the integer (i.e. eliminating leading zeroes) in most-significant order. Examples of the encoding are: </span><span class="modify_version">The function <code>asn:int-octets</code> returns a sequence of all the <span class="deltaxml-old" style="background:#FF5555">'</span>significant<span class="deltaxml-old" style="background:#FF5555">'</span> octets of the integer (i.e. eliminating leading <span class="deltaxml-old" style="background:#FF5555">'</span>zeroes<span class="deltaxml-old" style="background:#FF5555">'</span>) in most-significant order. Examples of the encoding are: </span></p><div class="exampleInner"><pre xml:space="preserve" class="small"> asn:encode-ASN-integer(0) → "AgA="
 asn:encode-ASN-integer(1234) → "AgIE0g=="
 asn:encode-ASN-integer(123456789123456789123456789123456789) → "Ag8XxuPAMviQRa10ZoQEXxU="
               
 asn:encode-ASN-integer(123456789.. 900 digits... 123456789) → "AoIBdgaTo....EBF8V"</pre></div><p><span style="display: none;" class="delete_version">The first example requires no octets to encode zero, hence its octets are <code>2,0</code>. Both the second and third examples can be represented in less than 128 octets (2 and 15 respectively), so length is encoded as a single octet. The first three octets of the result for the last example, which encodes a 900-digit integer, are: <code>2,130,1</code> indicating that the data is represented by (130-128) * 256 + 1 = 513 octets and the length required two octets to encode.</span><span style="display: none;" class="add_version">The first example requires no octets to encode zero, hence its octets are <code>2, 0</code>. Both the second and third examples can be represented in less than 128 octets (2 and 15 respectively), so length is encoded as a single octet. The first three octets of the result for the last example, which encodes a 900-digit integer, are: <code>2, 130, 1</code> indicating that the data is represented by (130-128) * 256 + 1 = 513 octets and the length required two octets to encode.</span><span class="modify_version">The first example requires no octets to encode zero, hence its octets are <code><span class="deltaxml-old" style="background:#FF5555">2,0</span><span class="deltaxml-new" style="background:#90EE90">2, 0</span></code>. Both the second and third examples can be represented in less than 128 octets (2 and 15 respectively), so length is encoded as a single octet. The first three octets of the result for the last example, which encodes a 900-digit integer, are: <code><span class="deltaxml-old" style="background:#FF5555">2,130,1</span><span class="deltaxml-new" style="background:#90EE90">2, 130, 1</span></code> indicating that the data is represented by (130-128) * 256 + 1 = 513 octets and the length required two octets to encode.</span></p><p>Decoding is a matter of compound use of the integer decoding function:</p><div class="exampleInner"><pre class="small" xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555"> &lt;xsl:function name="asn:decode-ASN-integer" as="xs:integer"&gt;
     &lt;xsl:param name="in" as="xs:base64Binary"/&gt;
     &lt;xsl:sequence
         select="let $lo := bin:unpack-unsigned-integer($in,1,1,'BE') return (
         if($lo le 127) then bin:unpack-unsigned-integer($in,2,$lo,'BE') 
            else (let $lo2 := $lo - 128, $lo3 := bin:unpack-unsigned-integer($in,2,$lo2,'BE') return
            bin:unpack-unsigned-integer($in,2+$lo2,$lo3,'BE')))"
      /&gt;
 &lt;/xsl:function&gt;</span></pre><pre class="small" xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90"> &lt;xsl:function name="asn:decode-ASN-integer" as="xs:integer"&gt;
    &lt;xsl:param name="in" as="xs:base64Binary"/&gt;
    &lt;xsl:sequence
       select="let $lo := bin:unpack-unsigned-integer($in, 1, 1, 'BE') 
               return (
                  if ($lo le 127) 
                  then bin:unpack-unsigned-integer($in, 2, $lo, 'BE') 
                  else ( let $lo2 := $lo - 128, 
                             $lo3 := bin:unpack-unsigned-integer($in, 2 ,$lo2, 'BE') 
                         return bin:unpack-unsigned-integer($in, 2+$lo2, $lo3, 'BE')
                        )
               )"
    /&gt;
 &lt;/xsl:function&gt;</span></pre></div><p><span class="deltaxml-old" style="background:#FF5555">(all numbers in ASN are 'big-endian') and the examples from above reverse:</span></p><div class="note"><p class="prefix"><b><span class="deltaxml-new" style="background:#90EE90">Note:</span></b></p><p><span class="deltaxml-new" style="background:#90EE90">All numbers in ASN are 'big-endian'.</span></p></div><p><span class="deltaxml-new" style="background:#90EE90">This function is the inverse of the encoding function above:</span></p><div class="exampleInner"><pre class="small" xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555"> asn:decode-ASN-integer(xs:base64Binary("AgA=")) → 0
 asn:decode-ASN-integer(xs:base64Binary("AgIE0g==")) → 1234
 asn:encode-ASN-integer(xs:base64Binary("Ag8XxuPAMviQRa10ZoQEXxU=")) 
     → 123456789123456789123456789123456789              
 asn:encode-ASN-integer(xs:base64Binary("AoIBdgaTo....EBF8V")) 
     → 123456789.. 900 digits... 123456789</span></pre><pre class="small" xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90"> asn:decode-ASN-integer(xs:base64Binary("AgA=")) → 0
 asn:decode-ASN-integer(xs:base64Binary("AgIE0g==")) → 1234
 asn:decode-ASN-integer(xs:base64Binary("Ag8XxuPAMviQRa10ZoQEXxU=")) 
     → 123456789123456789123456789123456789              
 asn:decode-ASN-integer(xs:base64Binary("AoIBdgaTo....EBF8V")) 
     → 123456789.. 900 digits... 123456789</span></pre></div></div></div></div><div class="div1"><h2><a id="loading"></a><a id="id-other-operations"></a>3 <a style="text-decoration: none" href="#loading"><span class="deltaxml-old" style="background:#FF5555">Loading and saving binary data</span></a><a style="text-decoration: none" href="#id-other-operations"><span class="deltaxml-new" style="background:#90EE90">Other Operations on Binary Values</span></a></h2><div class="changes"><p class="changesHeading"><span class="deltaxml-old" style="background:#FF5555">Changes in 4.0&nbsp;</span><a href="#basic-operations"><span class="deltaxml-old" style="background:#FF5555">⬇</span></a><span class="deltaxml-old" style="background:#FF5555">&nbsp;</span><a href="#example-ASN1"><span class="deltaxml-old" style="background:#FF5555">⬆</span></a></p><ol><li><p><span class="deltaxml-old" style="background:#FF5555">The </span><a href="#xpath-functions-40"><span class="deltaxml-old" style="background:#FF5555">[XQuery and XPath Functions and Operators 4.0]</span></a><span class="deltaxml-old" style="background:#FF5555"> function </span><code><span class="deltaxml-old" style="background:#FF5555">fn:binary-resource</span></code><span class="deltaxml-old" style="background:#FF5555"> has been added to the list of useful functions.</span></p></li></ol></div><p><span class="deltaxml-old" style="background:#FF5555">This module defines no specific functions for reading and writing binary data from resources, but other specifications provide some suitable mechanisms.</span></p><p><a href="#xpath-functions-40"><span class="deltaxml-old" style="background:#FF5555">[XQuery and XPath Functions and Operators 4.0]</span></a><span class="deltaxml-old" style="background:#FF5555"> provides a function to retrieve binary resources:</span></p><p><span class="deltaxml-new" style="background:#90EE90">This section provides a summary of operations on binary values beyond those defined in this document.</span></p><div class="div2"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-old" style="background:#FF5555">fn:fn:binary-resource</span></code><span class="deltaxml-old" style="background:#FF5555">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-old" style="background:#FF5555">$filesource</span></code></td><td><code class="as"><span class="deltaxml-old" style="background:#FF5555">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string?</span></code></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-old" style="background:#FF5555">)</span><code class="as"><span class="deltaxml-old" style="background:#FF5555">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code></code></td></tr></tbody></table><h3><a id="conversion"></a><span class="deltaxml-new" style="background:#90EE90">3.1 </span><a href="#conversion" style="text-decoration: none"><span class="deltaxml-new" style="background:#90EE90">Conversions</span></a></h3><p><span class="deltaxml-new" style="background:#90EE90">Casting is defined:</span></p><ul><li><p><span class="deltaxml-new" style="background:#90EE90">Between </span><code><span class="deltaxml-new" style="background:#90EE90">xs:hexBinary</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90">, in either direction. Since the two types have the same value space, conversion is lossless, and can be expected in most implementations to have very low cost.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">From </span><code><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:hexBinary</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90">. The semantics correspond to the XSD rules for validation of simple types. The two binary types have different lexical representation, so conversion from strings requires different input.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">From </span><code><span class="deltaxml-new" style="background:#90EE90">xs:hexBinary</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code><span class="deltaxml-new" style="background:#90EE90">. The rules are defined in </span><span class="markup-error"><span class="deltaxml-new" style="background:#90EE90">[TITLE OF XP40 SPEC, TITLE OF casting-to-string SECTION]</span><sup><small><span class="deltaxml-new" style="background:#90EE90">XP40</span></small></sup></span><span class="deltaxml-new" style="background:#90EE90">. The two binary types have different lexical representation, so the output in the two cases is different.</span></p></li></ul></div><p><span class="deltaxml-old" style="background:#FF5555">The EXPath File Module </span><a href="#expath-file-40"><span class="deltaxml-old" style="background:#FF5555">[EXPath File 4.0]</span></a><span class="deltaxml-old" style="background:#FF5555"> provides three functions suitable for use in file-based situations:</span></p><div class="div2"><h3><a id="comparison"></a><span class="deltaxml-new" style="background:#90EE90">3.2 </span><a href="#comparison" style="text-decoration: none"><span class="deltaxml-new" style="background:#90EE90">Comparison</span></a></h3><p><span class="deltaxml-new" style="background:#90EE90">Comparison of binary values is defined using any of the value comparison operators </span><code><span class="deltaxml-new" style="background:#90EE90">eq</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">ne</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">le</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">lt</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">ge</span></code><span class="deltaxml-new" style="background:#90EE90">, or </span><code><span class="deltaxml-new" style="background:#90EE90">gt</span></code><span class="deltaxml-new" style="background:#90EE90">. It is therefore defined also for the general comparison operators </span><code><span class="deltaxml-new" style="background:#90EE90">=</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">!=</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">&lt;=</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">&lt;</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">&gt;=</span></code><span class="deltaxml-new" style="background:#90EE90">, and </span><code><span class="deltaxml-new" style="background:#90EE90">&gt;</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The semantics are defined in </span><a href="#func-binary-equal"><code><span class="deltaxml-new" style="background:#90EE90">op:binary-equal</span></code></a><span class="deltaxml-new" style="background:#90EE90"> and </span><a href="#func-binary-less-than"><code><span class="deltaxml-new" style="background:#90EE90">op:binary-less-than</span></code></a><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The two types </span><code><span class="deltaxml-new" style="background:#90EE90">xs:hexBinary</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90"> can be compared interchangeably.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Because binary values are ordered, sequences of binary values can be sorted using the function </span><a href="#func-sort"><code><span class="deltaxml-new" style="background:#90EE90">fn:sort</span></code></a><span class="deltaxml-new" style="background:#90EE90">, or by using the </span><code><span class="deltaxml-new" style="background:#90EE90">xsl:sort</span></code><span class="deltaxml-new" style="background:#90EE90"> instruction in XSLT or the </span><code><span class="deltaxml-new" style="background:#90EE90">order by</span></code><span class="deltaxml-new" style="background:#90EE90"> clause in XQuery.</span></p></div><div class="div2"><h3><a id="numeric-representation"></a><span class="deltaxml-new" style="background:#90EE90">3.3 </span><a href="#numeric-representation" style="text-decoration: none"><span class="deltaxml-new" style="background:#90EE90">Numeric representation</span></a></h3><p><span class="deltaxml-new" style="background:#90EE90">Integers can be converted to a string representation using any radix in the range 2 to 36 using the function </span><a href="#func-format-integer"><code><span class="deltaxml-new" style="background:#90EE90">fn:format-integer</span></code></a><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Conversely, strings representing an integer using any radix in the range 2 to 36 can be converted to an integer using the function </span><a href="#func-parse-integer"><code><span class="deltaxml-new" style="background:#90EE90">fn:parse-integer</span></code></a><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">These functions do not directly involve binary values, but they can be used to convert between numbers and binary values by using a string representation as an intermediate format.</span></p><p><span class="deltaxml-new" style="background:#90EE90">See also the functions </span><code><span class="deltaxml-new" style="background:#90EE90">bin:pack-integer</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-integer</span></code><span class="deltaxml-new" style="background:#90EE90">, and </span><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-unsigned-integer</span></code><span class="deltaxml-new" style="background:#90EE90"> defined in this specification.</span></p></div><div class="div2"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-old" style="background:#FF5555">fn:file:read-binary</span></code><span class="deltaxml-old" style="background:#FF5555">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-old" style="background:#FF5555">$file</span></code></td><td><code class="as"><span class="deltaxml-old" style="background:#FF5555">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code></code><span class="deltaxml-old" style="background:#FF5555">,</span></td><td></td></tr><tr class="arg"><td><code><span class="deltaxml-old" style="background:#FF5555">$offset</span></code></td><td><code class="as"><span class="deltaxml-old" style="background:#FF5555">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:integer?</span></code></code></td><td><code class="assign"><span class="deltaxml-old" style="background:#FF5555">:=&nbsp;</span></code><code><span class="deltaxml-old" style="background:#FF5555">0</span></code><span class="deltaxml-old" style="background:#FF5555">,</span></td></tr><tr class="arg"><td><code><span class="deltaxml-old" style="background:#FF5555">$size</span></code></td><td><code class="as"><span class="deltaxml-old" style="background:#FF5555">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:integer?</span></code></code></td><td><code class="assign"><span class="deltaxml-old" style="background:#FF5555">:=&nbsp;</span></code><code><span class="deltaxml-old" style="background:#FF5555">()</span></code></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-old" style="background:#FF5555">)</span><code class="as"><span class="deltaxml-old" style="background:#FF5555">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code></code></td></tr></tbody></table><h3><a id="loading"></a><span class="deltaxml-new" style="background:#90EE90">3.4 </span><a href="#loading" style="text-decoration: none"><span class="deltaxml-new" style="background:#90EE90">Loading and saving binary data</span></a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#func-bin-hex"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#example-ASN1"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">The </span><a href="#xpath-functions-40"><span class="deltaxml-new" style="background:#90EE90">[XQuery and XPath Functions and Operators 4.0]</span></a><span class="deltaxml-new" style="background:#90EE90"> function </span><code><span class="deltaxml-new" style="background:#90EE90">fn:binary-resource</span></code><span class="deltaxml-new" style="background:#90EE90"> has been added to the list of useful functions.</span></p></li></ol></div><p><span class="deltaxml-new" style="background:#90EE90">This module defines no specific functions for reading and writing binary data from external resources, but other specifications provide some suitable mechanisms.</span></p><p><a href="#xpath-functions-40"><span class="deltaxml-new" style="background:#90EE90">[XQuery and XPath Functions and Operators 4.0]</span></a><span class="deltaxml-new" style="background:#90EE90"> provides a function to retrieve binary resources:</span></p><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-new" style="background:#90EE90">fn:binary-resource</span></code><span class="deltaxml-new" style="background:#90EE90">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$filesource</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">xs:string?</span></code></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-new" style="background:#90EE90">)</span><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code></code></td></tr></tbody></table></div><p><span class="deltaxml-new" style="background:#90EE90">The EXPath File Module </span><a href="#expath-file-40"><span class="deltaxml-new" style="background:#90EE90">[EXPath File 4.0]</span></a><span class="deltaxml-new" style="background:#90EE90"> provides three functions suitable for use in file-based situations:</span></p><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-new" style="background:#90EE90">file:read-binary</span></code><span class="deltaxml-new" style="background:#90EE90">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$file</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code></code><span class="deltaxml-new" style="background:#90EE90">,</span></td><td></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$offset</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">xs:integer?</span></code></code></td><td><code class="assign"><span class="deltaxml-new" style="background:#90EE90">:=&nbsp;</span></code><code><span class="deltaxml-new" style="background:#90EE90">0</span></code><span class="deltaxml-new" style="background:#90EE90">,</span></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$size</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">xs:integer?</span></code></code></td><td><code class="assign"><span class="deltaxml-new" style="background:#90EE90">:=&nbsp;</span></code><code><span class="deltaxml-new" style="background:#90EE90">()</span></code></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-new" style="background:#90EE90">)</span><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code></code></td></tr></tbody></table></div><p><span class="deltaxml-new" style="background:#90EE90">which reads binary data from an existing file, with an optional offset and size.</span></p><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-new" style="background:#90EE90">file:write-binary</span></code><span class="deltaxml-new" style="background:#90EE90">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$file</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code></code><span class="deltaxml-new" style="background:#90EE90">,</span></td><td></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-new" style="background:#90EE90">)</span><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-new" style="background:#90EE90">empty-sequence()</span></code></code></td></tr></tbody></table></div><p><span class="deltaxml-new" style="background:#90EE90">which writes binary data into a new or existing file.</span></p><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-new" style="background:#90EE90">file:append-binary</span></code><span class="deltaxml-new" style="background:#90EE90">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$file</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">xs:string</span></code></code><span class="deltaxml-new" style="background:#90EE90">,</span></td><td></td></tr><tr class="arg"><td><code><span class="deltaxml-new" style="background:#90EE90">$value</span></code></td><td><code class="as"><span class="deltaxml-new" style="background:#90EE90">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-new" style="background:#90EE90">)</span><code class="as"><span class="deltaxml-new" style="background:#90EE90">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-new" style="background:#90EE90">empty-sequence()</span></code></code></td></tr></tbody></table></div><p><span class="deltaxml-new" style="background:#90EE90">which appends binary data onto the end of an existing file.</span></p></div><p><span class="deltaxml-old" style="background:#FF5555">which reads binary data from an existing file, with an optional offset and size.</span></p><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-old" style="background:#FF5555">fn:file:write-binary</span></code><span class="deltaxml-old" style="background:#FF5555">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-old" style="background:#FF5555">$file</span></code></td><td><code class="as"><span class="deltaxml-old" style="background:#FF5555">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code></code><span class="deltaxml-old" style="background:#FF5555">,</span></td><td></td></tr><tr class="arg"><td><code><span class="deltaxml-old" style="background:#FF5555">$value</span></code></td><td><code class="as"><span class="deltaxml-old" style="background:#FF5555">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-old" style="background:#FF5555">)</span><code class="as"><span class="deltaxml-old" style="background:#FF5555">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-old" style="background:#FF5555">empty-sequence()</span></code></code></td></tr></tbody></table></div><p><span class="deltaxml-old" style="background:#FF5555">which writes binary data into a new or existing file.</span></p><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function"><span class="deltaxml-old" style="background:#FF5555">fn:file:append-binary</span></code><span class="deltaxml-old" style="background:#FF5555">(</span></td></tr><tr class="arg"><td><code><span class="deltaxml-old" style="background:#FF5555">$file</span></code></td><td><code class="as"><span class="deltaxml-old" style="background:#FF5555">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span></code></code><span class="deltaxml-old" style="background:#FF5555">,</span></td><td></td></tr><tr class="arg"><td><code><span class="deltaxml-old" style="background:#FF5555">$value</span></code></td><td><code class="as"><span class="deltaxml-old" style="background:#FF5555">as&nbsp;</span></code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span class="deltaxml-old" style="background:#FF5555">)</span><code class="as"><span class="deltaxml-old" style="background:#FF5555">&nbsp;as&nbsp;</span></code><code><code><span class="deltaxml-old" style="background:#FF5555">empty-sequence()</span></code></code></td></tr></tbody></table></div><p><span class="deltaxml-old" style="background:#FF5555">which appends binary data onto the end of an extant file.</span></p></div><div class="div1"><h2><a id="constants"></a>4 <a style="text-decoration: none" href="#constants">Defining <span class="deltaxml-old" style="background:#FF5555">'</span>constants<span class="deltaxml-old" style="background:#FF5555">'</span> and conversions</a></h2><p><span class="deltaxml-old" style="background:#FF5555">Users of the package may need to define binary 'constants' within their code or examine the basic octets. The following functions support these:</span></p><p><span class="deltaxml-new" style="background:#90EE90">The functions in this section can be used to define constant binary values or to perform simple conversions to string representations:</span></p><div class="div2"><h3><a id="func-bin-hex"></a>4.1 <a href="#func-bin-hex" style="text-decoration: none">bin:hex</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#func-bin-binary"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#loading"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">The input string is now allowed to include embedded underscores and whitespace.</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/1750"><span class="deltaxml-new" style="background:#90EE90">1750</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1753"><span class="deltaxml-new" style="background:#90EE90">1753</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;3 February 2025]</span></i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns the binary form of the set of octets written as a sequence of (ASCII) hex digits ([0-9A-Fa-f]).</span></p><p><span class="deltaxml-new" style="background:#90EE90">Constructs a binary value from a string of hexadecimal digits (</span><code><span class="deltaxml-new" style="background:#90EE90">[0-9A-Fa-f]*</span></code><span class="deltaxml-new" style="background:#90EE90">).</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:hex</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> will be effectively zero-padded from the left to generate an integral number of octets, i.e. an even number of hexadecimal digits.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Byte order in the result follows (per-octet) character order in the string.</span></p><p><span class="deltaxml-old" style="background:#FF5555"> If </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is an empty string, then the result will be a </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555"> with no embedded data.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Any whitespace and underscore characters are stripped from </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90"> If the length of of the resulting string is an odd number, then a single "0" digit is prepended to the value, so that it contains an even number of hexadecimal digits.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The resulting string is then cast to type </span><code><span class="deltaxml-new" style="background:#90EE90">xs:hexBinary</span></code><span class="deltaxml-new" style="background:#90EE90">, which is then cast to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">$in ! ( replace(., '[_\s]', '') 
           -&gt; concat(if (string-length(.) mod 2) eq 1 then "0" else "", .)
           -&gt; xs:hexBinary(.)
           -&gt; xs:base64Binary(.) )</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40non-numeric-character" title="bin:non-numeric-character">bin:non-numeric-character</a>] is raised if <code>$in</code> cannot be parsed as a hexadecimal number.</p></dd><dt class="label">Notes</dt><dd><p class="note"><span class="deltaxml-old" style="background:#FF5555">When the input string has an even number of characters, this function behaves similarly to the double cast </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary(xs:hexBinary(</span><em><span class="deltaxml-old" style="background:#FF5555">$string</span></em><span class="deltaxml-old" style="background:#FF5555">))</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">The order of octets in the result follows the order of characters in the string.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is an empty string, the result will be a </span><a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">zero-length</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90"> value.</span></p><p><span class="deltaxml-new" style="background:#90EE90">When the input string has an even number of characters, this function delivers the same result as the expression </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary(xs:hexBinary(</span><em><span class="deltaxml-new" style="background:#90EE90">$string</span></em><span class="deltaxml-new" style="background:#90EE90">))</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:hex('11223F4E') → "ESI/Tg=="</span></pre><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:hex('1122_3F4E')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary("ESI/Tg==")</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:hex('1223F4E') → "ASI/Tg=="</span></pre><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:hex('122 3F4E')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary("ASI/Tg==")</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-binary"></a>4.2 <a href="#func-bin-binary" style="text-decoration: none">bin:bin</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#func-bin-octal"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#func-bin-hex"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">The input string is now allowed to include embedded underscores and whitespace.</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/1750"><span class="deltaxml-new" style="background:#90EE90">1750</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1753"><span class="deltaxml-new" style="background:#90EE90">1753</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;3 February 2025]</span></i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns the binary form of the set of octets written as a sequence of (8-wise) (ASCII) binary digits ([01]).</span></p><p><span class="deltaxml-new" style="background:#90EE90">Constructs a binary value from a string of zeroes and ones (</span><code><span class="deltaxml-new" style="background:#90EE90">[01]*</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:bin</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> will be effectively zero-padded from the left to generate an integral number of octets (i.e. the number of characters in </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> will be a multiple of 8).</span></p><p><span class="deltaxml-old" style="background:#FF5555">Byte order in the result follows (per-octet) character order in the string.</span></p><p><span class="deltaxml-old" style="background:#FF5555"> If </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is an empty string, then the result will be a </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555"> with no embedded data.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Any whitespace and underscore characters are stripped from </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">As many zero digits (</span><span class="unicode-codepoint"><span class="deltaxml-new" style="background:#90EE90">U+0030</span></span><span class="deltaxml-new" style="background:#90EE90"> (</span><span class="unicode-name"><span class="deltaxml-new" style="background:#90EE90">DIGIT ZERO</span></span><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">0</span></code><span class="deltaxml-new" style="background:#90EE90">) ) as necessary are prepended to </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> to make its string length a multiple of 8.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The string is then partitioned into substrings of length 8, and each such substring </span><var><span class="deltaxml-new" style="background:#90EE90">B</span></var><span class="deltaxml-new" style="background:#90EE90"> is converted to an integer in the range 0 to 255 by applying the function </span><code><span class="deltaxml-new" style="background:#90EE90">fn:parse-integer(</span><var><span class="deltaxml-new" style="background:#90EE90">B</span></var><span class="deltaxml-new" style="background:#90EE90">, 2)</span></code><span class="deltaxml-new" style="background:#90EE90">. The resulting sequence of integers is then converted to a </span><a title="binary value" class="termref" href="#dt-binary-value"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">binary value</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><span class="deltaxml-new" style="background:#90EE90"> by applying the function </span><code><span class="deltaxml-new" style="background:#90EE90">bin:from-octets</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">$in ! ( (: process input if present, otherwise return () :)
               (: strip underscores and whitespace :)
           replace(., '[_\s]', '')
               (: extend to a multiple of 8 binary digits :)
       -&gt;  concat((1 to (8 - string-length(.) mod 8) ! "0"), .)
               (: insert a separator after every 8 digits :)
       -&gt;  replace(., "(.{8})", "$1/")
               (: split into groups of 8 digits :)
       -&gt;  tokenize(., "/")
               (: parse each group of 8 binary digits as a radix-2 integer :)
       =!&gt; parse-integer(2)
               (: construct a binary value from these octets :)
       -&gt;  bin:from-octets(.) 
   )</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40non-numeric-character" title="bin:non-numeric-character">bin:non-numeric-character</a>] is raised if <code>$in</code> cannot be parsed as a binary number.</p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Notes</span></dt><dd><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">The order of octets in the result follows the order of characters in the string.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is an empty string, the result will be a </span><a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">zero-length</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90"> value.</span></p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:bin('1101000111010101') → "0dU="</span></pre><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:bin('1101_0001_1101_0101')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex("D1D5")</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:bin('1000111010101') → "EdU="</span></pre><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:bin('1 0001 1101 0101')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex("11D5")</span></pre></div></td></tr><tr class="add_version" style="display: none;"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>bin:bin(' 101 ')</code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex("05")</pre></div></td></tr><tr class="modify_version"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:bin(' 101 ')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex("05")</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-octal"></a>4.3 <a href="#func-bin-octal" style="text-decoration: none">bin:octal</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#func-bin-to-octets"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#func-bin-binary"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">The input string is now allowed to include embedded underscores and whitespace.</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/1750"><span class="deltaxml-new" style="background:#90EE90">1750</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1753"><span class="deltaxml-new" style="background:#90EE90">1753</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;3 February 2025]</span></i></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">The way in which the value is adjusted to a whole number of octets has been clarified. The rules have been made more precise, and might not match the interpretation adopted by existing implementations.</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/1750"><span class="deltaxml-new" style="background:#90EE90">1750</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1753"><span class="deltaxml-new" style="background:#90EE90">1753</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;3 February 2025]</span></i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns the binary form of the set of octets written as a sequence of (ASCII) octal digits ([0-7]).</span></p><p><span class="deltaxml-new" style="background:#90EE90">Constructs a binary value from a string of octal digits (</span><code><span class="deltaxml-new" style="background:#90EE90">[0-7]*</span></code><span class="deltaxml-new" style="background:#90EE90">)</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:octal</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> will be effectively zero-padded from the left to generate an integral number of octets.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise:</span></p><ol class="enumar"><li><p><span class="deltaxml-new" style="background:#90EE90">Any whitespace and underscore characters are stripped from </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Each octal digit in </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is replaced by its binary equivalent (</span><code><span class="deltaxml-new" style="background:#90EE90">"0"</span></code><span class="deltaxml-new" style="background:#90EE90"> → </span><code><span class="deltaxml-new" style="background:#90EE90">"000"</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">"1"</span></code><span class="deltaxml-new" style="background:#90EE90"> → </span><code><span class="deltaxml-new" style="background:#90EE90">"001"</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">"2"</span></code><span class="deltaxml-new" style="background:#90EE90"> → </span><code><span class="deltaxml-new" style="background:#90EE90">"010"</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">"3"</span></code><span class="deltaxml-new" style="background:#90EE90"> → </span><code><span class="deltaxml-new" style="background:#90EE90">"011"</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">"4"</span></code><span class="deltaxml-new" style="background:#90EE90"> → </span><code><span class="deltaxml-new" style="background:#90EE90">"100"</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">"5"</span></code><span class="deltaxml-new" style="background:#90EE90"> → </span><code><span class="deltaxml-new" style="background:#90EE90">"101"</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">"6"</span></code><span class="deltaxml-new" style="background:#90EE90"> → </span><code><span class="deltaxml-new" style="background:#90EE90">"110"</span></code><span class="deltaxml-new" style="background:#90EE90">, </span><code><span class="deltaxml-new" style="background:#90EE90">"7"</span></code><span class="deltaxml-new" style="background:#90EE90"> → </span><code><span class="deltaxml-new" style="background:#90EE90">"111"</span></code><span class="deltaxml-new" style="background:#90EE90">).</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">A maximum of two leading zero digits are stripped.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">The resulting string is converted to a </span><a title="binary value" class="termref" href="#dt-binary-value"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">binary value</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><span class="deltaxml-new" style="background:#90EE90"> by applying the function </span><code><span class="deltaxml-new" style="background:#90EE90">bin:bin</span></code><span class="deltaxml-new" style="background:#90EE90"> to the result.</span></p></li></ol><p><span class="deltaxml-old" style="background:#FF5555">Byte order</span><span class="deltaxml-new" style="background:#90EE90">The order of octets</span> in the result follows <span class="deltaxml-old" style="background:#FF5555">(per-octet) character order</span><span class="deltaxml-new" style="background:#90EE90">the order of characters</span> in the string.</p><p><span class="deltaxml-old" style="background:#FF5555"> If </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is an empty string, then the result will be a </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555"> with no embedded data.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">$in ! ( replace(., '[_\s]', '') 
           =&gt;  characters()
           =!&gt; {"0":"000", "1":"001", "2":"010", "3":"011", 
                "4":"100", "5":"101", "6":"110", "7":"111"}()
           =!&gt; replace("^0?0?", "")     
           =&gt;  string-join()
           =&gt;  bin:bin() )</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40non-numeric-character" title="bin:non-numeric-character">bin:non-numeric-character</a>] is raised if <code>$in</code> cannot be parsed as an octal number.</p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Notes</span></dt><dd><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">The order of octets in the result follows the order of characters in the string.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is a zero-length string, the result will be a </span><a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">zero-length</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90"> value.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The rule for padding to a whole number of octets ensures that leading zeroes are significant in determining the length of the final binary value, while also allowing a value of any length to be constructed. For example (underscores added for readability):</span></p><ul><li><p><span class="deltaxml-new" style="background:#90EE90">An input of </span><code><span class="deltaxml-new" style="background:#90EE90">"0"</span></code><span class="deltaxml-new" style="background:#90EE90"> translates first to the string </span><code><span class="deltaxml-new" style="background:#90EE90">"000"</span></code><span class="deltaxml-new" style="background:#90EE90">; two leading zeros are removed producing </span><code><span class="deltaxml-new" style="background:#90EE90">"0"</span></code><span class="deltaxml-new" style="background:#90EE90">, which </span><code><span class="deltaxml-new" style="background:#90EE90">bin:bin</span></code><span class="deltaxml-new" style="background:#90EE90"> converts to </span><code><span class="deltaxml-new" style="background:#90EE90">bin:hex("00")</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">An input of </span><code><span class="deltaxml-new" style="background:#90EE90">"155"</span></code><span class="deltaxml-new" style="background:#90EE90"> translates to the binary string </span><code><span class="deltaxml-new" style="background:#90EE90">"001_101_101"</span></code><span class="deltaxml-new" style="background:#90EE90">. The first two zeroes are removed, and </span><code><span class="deltaxml-new" style="background:#90EE90">bin:bin</span></code><span class="deltaxml-new" style="background:#90EE90"> converts the result to </span><code><span class="deltaxml-new" style="background:#90EE90">bin:hex("6D")</span></code></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">An input of </span><code><span class="deltaxml-new" style="background:#90EE90">"355"</span></code><span class="deltaxml-new" style="background:#90EE90"> translates to the binary string </span><code><span class="deltaxml-new" style="background:#90EE90">"011_101_101"</span></code><span class="deltaxml-new" style="background:#90EE90">. The first zero is removed, and </span><code><span class="deltaxml-new" style="background:#90EE90">bin:bin</span></code><span class="deltaxml-new" style="background:#90EE90"> converts the result to </span><code><span class="deltaxml-new" style="background:#90EE90">bin:hex("ED")</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">An input of </span><code><span class="deltaxml-new" style="background:#90EE90">"555"</span></code><span class="deltaxml-new" style="background:#90EE90"> translates to the string </span><code><span class="deltaxml-new" style="background:#90EE90">"101_101_101"</span></code><span class="deltaxml-new" style="background:#90EE90">, which </span><code><span class="deltaxml-new" style="background:#90EE90">bin:bin</span></code><span class="deltaxml-new" style="background:#90EE90"> converts to </span><code><span class="deltaxml-new" style="background:#90EE90">bin:hex("016D")</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">An input of </span><code><span class="deltaxml-new" style="background:#90EE90">"0155"</span></code><span class="deltaxml-new" style="background:#90EE90"> translates to the string </span><code><span class="deltaxml-new" style="background:#90EE90">"000_001_101_101"</span></code><span class="deltaxml-new" style="background:#90EE90">. The first two zeros are stripped giving </span><code><span class="deltaxml-new" style="background:#90EE90">"0_001_101_101"</span></code><span class="deltaxml-new" style="background:#90EE90">, which </span><code><span class="deltaxml-new" style="background:#90EE90">bin:bin</span></code><span class="deltaxml-new" style="background:#90EE90"> converts to </span><code><span class="deltaxml-new" style="background:#90EE90">bin:hex("006D")</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></li></ul></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:octal('11223047') → "JSYn"</span></pre><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:octal('')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('')</span></pre></div></td></tr><tr class="add_version" style="display: none;"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>bin:octal('0')</code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('00')</pre></div></td></tr><tr class="modify_version"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:octal('0')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('00')</span></pre></div></td></tr><tr class="add_version" style="display: none;"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>bin:octal('377')</code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('FF')</pre></div></td></tr><tr class="modify_version"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:octal('377')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FF')</span></pre></div></td></tr><tr class="add_version" style="display: none;"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>bin:octal('777')</code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('01FF')</pre></div></td></tr><tr class="modify_version"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:octal('777')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('01FF')</span></pre></div></td></tr><tr class="add_version" style="display: none;"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>bin:octal('0377')</code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('00FF')</pre></div></td></tr><tr class="modify_version"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:octal('0377')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('00FF')</span></pre></div></td></tr><tr class="add_version" style="display: none;"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code>bin:octal('11_223_047')</code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('252627')</pre></div></td></tr><tr class="modify_version"><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:octal('11_223_047')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('252627')</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-to-octets"></a>4.4 <a href="#func-bin-to-octets" style="text-decoration: none">bin:to-octets</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#func-bin-from-octets"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#func-bin-octal"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">The result type is changed from </span><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90">. This is made possible by the more liberal coercion rules defined in XPath 4.0.</span></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Returns binary data as a sequence of integer octets.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:to-octets</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)</code></code></td><td></td></tr><tr class="return-type"><td colspan="3"><span style="display: none;" class="delete_version">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer*</code></code></span><span style="display: none;" class="add_version">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:unsignedByte*</code></code></span><span class="modify_version">)<code class="as">&nbsp;as&nbsp;</code><code><code><span class="deltaxml-old" style="background:#FF5555">xs:integer</span><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span>*</code></code></span></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span style="display: none;" class="delete_version">If <code>$in</code> is a zero length binary data then the empty sequence is returned.</span><span style="display: none;" class="add_version">If <code>$in</code> is a <a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow">·</span>zero-length<span class="arrow">·</span></a><a title="binary value" class="termref" href="#dt-binary-value"><span class="arrow">·</span>binary value<span class="arrow">·</span></a> then the empty sequence is returned.</span><span class="modify_version">If <code>$in</code> is a <span class="deltaxml-old" style="background:#FF5555">zero</span><a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">zero-length</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><a title="binary value" class="termref" href="#dt-binary-value"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">binary value</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a> <span class="deltaxml-old" style="background:#FF5555">length binary data </span>then the empty sequence is returned.</span></p><p><span style="display: none;" class="delete_version">Octets are returned as integers from 0 to 255.</span><span style="display: none;" class="add_version">Octets are returned in sequence, as instances of <code>xs:unsignedByte</code> (integers ranging from 0 to 255).</span><span class="modify_version">Octets are returned <span class="deltaxml-old" style="background:#FF5555">as</span><span class="deltaxml-new" style="background:#90EE90">in sequence, as instances of</span> <code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90"> (</span>integers <span class="deltaxml-new" style="background:#90EE90">ranging </span>from 0 to 255<span class="deltaxml-new" style="background:#90EE90">)</span>.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:to-octets(bin:hex('1122AAFF')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">17, 34, 170, 255</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:to-octets(bin:hex(''))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">()</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-from-octets"></a>4.5 <a href="#func-bin-from-octets" style="text-decoration: none">bin:from-octets</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#basic-operations"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#func-bin-to-octets"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">The argument type is changed from </span><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90">. This is made possible by the more liberal coercion rules defined in XPath 4.0. A consequence of the change is that supplying an out-of-range integer value is now a type error with the standard error code </span><code><span class="deltaxml-new" style="background:#90EE90">XPTY0004</span></code><span class="deltaxml-new" style="background:#90EE90">, rather than the custom error code </span><code><span class="deltaxml-new" style="background:#90EE90">bin:octet-out-of-range</span></code><span class="deltaxml-new" style="background:#90EE90"> previously used.</span></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p>Converts a sequence of octets into binary data.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:from-octets</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:integer*</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:unsignedByte*</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:integer</span><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span>*</code></code></span></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p>Octets are integers from 0 to 255.</p><p><span style="display: none;" class="delete_version">If <code>$in</code> is the empty sequence, the function returns zero-sized binary data.</span><span style="display: none;" class="add_version">If <code>$in</code> is the empty sequence, the function returns a <a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow">·</span>zero-length<span class="arrow">·</span></a> binary value.</span><span class="modify_version">If <code>$in</code> is the empty sequence, the function returns <span class="deltaxml-old" style="background:#FF5555">zero-sized</span><span class="deltaxml-new" style="background:#90EE90">a</span> <a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">zero-length</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><span class="deltaxml-new" style="background:#90EE90"> </span>binary <span class="deltaxml-old" style="background:#FF5555">data</span><span class="deltaxml-new" style="background:#90EE90">value</span>.</span></p></dd><dt class="label"><span class="deltaxml-old" style="background:#FF5555">Error Conditions</span></dt><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40octet-out-of-range" title="bin:octet-out-of-range"><span class="deltaxml-old" style="background:#FF5555">bin:octet-out-of-range</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if one of the octets lies outside the range 0 – 255. </span></p><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:from-octets((17, 34, 170, 255))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('1122AAFF')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:from-octets(())</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('')</span></pre></div></td></tr></tbody></table></div></dd></dl></div></div><div class="div1"><h2><a id="basic-operations"></a>5 <a href="#basic-operations" style="text-decoration: none">Basic operations</a></h2><div class="changes"><p class="changesHeading">Changes in 4.0&nbsp;<a href="#func-bin-pad-left"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#func-bin-from-octets">⬆</a></p><ol><li><p>The function <code>find-all</code> in the example for <a href="#func-bin-find"><code>bin:find</code></a> has been moved into a differing namespace prefix (<code>f:</code>) to avoid suggesting that it is part of the supported function set.</p></li></ol></div><div class="div2"><h3><a id="func-bin-length"></a>5.1 <a href="#func-bin-length" style="text-decoration: none">bin:length</a></h3><dl><dt class="label">Summary</dt><dd><p>Returns the size of <span class="deltaxml-new" style="background:#90EE90">a </span>binary <span class="deltaxml-old" style="background:#FF5555">data</span><span class="deltaxml-new" style="background:#90EE90">value</span>, measured in octets.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:length</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns the size of binary data in octets.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Returns the number of octets in the binary value </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></dd><dt class="label">Formal Equivalent</dt><dd><p>The effect of the function is equivalent to the result of the following XPath expression.</p><div class="exampleInner"><pre xml:space="preserve">count(bin:to-octets($in))</pre></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:length(bin:hex('FFFF'))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">2</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:length(bin:hex(''))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">0</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-part"></a>5.2 <a href="#func-bin-part" style="text-decoration: none">bin:part</a></h3><dl><dt class="label">Summary</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns a specified part of binary data.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Selects a specified range of octets from a binary value.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:part</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$offset</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$size</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-new" style="background:#90EE90">If the value of </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span style="display: none;" class="delete_version">Returns a section of binary data starting at the <code>$offset</code> octet. If <code>$size</code> is defined, the size of the returned binary data is <code>$size</code> octets. If <code>$size</code> is absent, all remaining data from <code>$offset</code> is returned.</span><span style="display: none;" class="add_version">Otherwise, the function returns a section of binary data starting at <code>$offset</code>. The offset is zero-based. If <code>$size</code> is present and non-empty, the size of the returned binary data is <code>$size</code> octets. If <code>$size</code> is absent or empty, all remaining data from <code>$offset</code> is returned.</span><span class="modify_version"><span class="deltaxml-old" style="background:#FF5555">Returns</span><span class="deltaxml-new" style="background:#90EE90">Otherwise, the function returns</span> a section of binary data starting at <span class="deltaxml-old" style="background:#FF5555">the </span><code>$offset</code><span class="deltaxml-old" style="background:#FF5555"> octet</span><span class="deltaxml-new" style="background:#90EE90">. The offset is zero-based</span>. If <code>$size</code> is <span class="deltaxml-old" style="background:#FF5555">defined</span><span class="deltaxml-new" style="background:#90EE90">present and non-empty</span>, the size of the returned binary data is <code>$size</code> octets. If <code>$size</code> is absent<span class="deltaxml-new" style="background:#90EE90"> or empty</span>, all remaining data from <code>$offset</code> is returned.</span></p><p>The <code>$offset</code> is zero based.</p><p>The values of <code>$offset</code> and <code>$size</code><span class="verb">must</span> be non-negative integers.</p><p>It is a dynamic error if <code>$offset</code> + <code>$size</code> is larger than the size of the binary data in <code>$in</code>.</p><p><span class="deltaxml-old" style="background:#FF5555">If the value of </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">$in =&gt; bin:to-octets() =&gt; subsequence($offset + 1, $size) =&gt; bin:from-octets()</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40index-out-of-range" title="bin:index-out-of-range">bin:index-out-of-range</a>] is raised if <code>$offset</code> is negative or <code>$offset + $size</code> is larger than the size of the binary data of <code>$in</code>.</p><p>[<a href="#ERRBIN40negative-size" title="bin:negative-size">bin:negative-size</a>] is raised if <code>$size</code> is negative.</p></dd><dt class="label">Notes</dt><dd><p class="note"><span class="deltaxml-old" style="background:#FF5555">Note that </span><code><span class="deltaxml-old" style="background:#FF5555">fn:subsequence()</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code><span class="deltaxml-old" style="background:#FF5555">fn:substring()</span></code><span class="deltaxml-old" style="background:#FF5555"> both use </span><code><span class="deltaxml-old" style="background:#FF5555">xs:double</span></code><span class="deltaxml-old" style="background:#FF5555"> for offset and size – this is a legacy from XPath 1.0.</span></p><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">The function differs in several ways from </span><code><span class="deltaxml-new" style="background:#90EE90">fn:subsequence()</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">fn:substring()</span></code><span class="deltaxml-new" style="background:#90EE90">:</span></p><ul><li><p><span class="deltaxml-new" style="background:#90EE90">The </span><code><span class="deltaxml-new" style="background:#90EE90">$offset</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">$size</span></code><span class="deltaxml-new" style="background:#90EE90"> are supplied as integers, not doubles.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">The </span><code><span class="deltaxml-new" style="background:#90EE90">$offset</span></code><span class="deltaxml-new" style="background:#90EE90"> is zero-based, not one-based.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">An error is raised if the selection goes outside the bounds of the value.</span></p></li></ul></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="add_version" style="display: none;"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><p><code>bin:part(bin:hex('11223344556677'), 0, 4)</code></p></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><p><code><span class="deltaxml-new" style="background:#90EE90">bin:part(bin:hex('11223344556677'), 0, 4)</span></code></p></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('11223344')</pre></div></td></tr><tr class="modify_version"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('11223344')</span></pre></div></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><p><code>bin:part(bin:hex('11223344556677'), 4)</code></p></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><p><code><span class="deltaxml-new" style="background:#90EE90">bin:part(bin:hex('11223344556677'), 4)</span></code></p></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('556677')</pre></div></td></tr><tr class="modify_version"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('556677')</span></pre></div></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><p><code>bin:part(bin:hex('11223344556677'), 7)</code></p></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><p><code><span class="deltaxml-new" style="background:#90EE90">bin:part(bin:hex('11223344556677'), 7)</span></code></p></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('')</pre></div></td></tr><tr class="modify_version"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('')</span></pre></div></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><p><code>bin:part(bin:hex('11223344556677'), 5, 0)</code></p></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><p><code><span class="deltaxml-new" style="background:#90EE90">bin:part(bin:hex('11223344556677'), 5, 0)</span></code></p></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex('')</pre></div></td></tr><tr class="modify_version"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('')</span></pre></div></td></tr><tr><td colspan="2"><p><span style="display: none;" class="delete_version">Testing whether <code>$data</code> variable starts with binary content consistent with a PDF file:</span><span style="display: none;" class="add_version">This example tests whether <code>$data</code> starts with binary content consistent with a PDF file:</span><span class="modify_version"><span class="deltaxml-old" style="background:#FF5555">Testing</span><span class="deltaxml-new" style="background:#90EE90">This example tests</span> whether <code>$data</code> <span class="deltaxml-old" style="background:#FF5555">variable </span>starts with binary content consistent with a PDF file:</span></p></td></tr><tr><td colspan="2"><div class="exampleInner"><pre xml:space="preserve">bin:part($data, 0, 4) eq bin:hex("25504446")</pre></div></td></tr><tr><td colspan="2"><p><span style="display: none;" class="delete_version"><code>25504446</code> is the magic number for PDF files: it is the US-ASCII encoded hexadecimal value for <code>%PDF</code>. <a href="#func-bin-encode-string"><code>bin:encode-string</code></a> can be used to convert a string to its binary representation.</span><span style="display: none;" class="add_version"><code>25504446</code> is the magic number for PDF files: it is the hexadecimal representation of the result of encoding the string <code>"%PDF"</code> in UTF-8 (or US-ASCII). Note that the function <code>bin:encode-string</code> can be used to convert a string to its binary representation.</span><span class="modify_version"><code>25504446</code> is the magic number for PDF files: it is the <span class="deltaxml-new" style="background:#90EE90">hexadecimal representation of the result of encoding the string </span><code><span class="deltaxml-new" style="background:#90EE90">"%PDF"</span></code><span class="deltaxml-new" style="background:#90EE90"> in UTF-8 (or </span>US-ASCII<span class="deltaxml-old" style="background:#FF5555"> encoded hexadecimal value for</span><span class="deltaxml-new" style="background:#90EE90">). Note that the function</span> <code><span class="deltaxml-old" style="background:#FF5555">%PDF</span><span class="deltaxml-new" style="background:#90EE90">bin:encode-string</span></code><span class="deltaxml-old" style="background:#FF5555">.</span> <a href="#func-bin-encode-string"><code><span class="deltaxml-old" style="background:#FF5555">bin:encode-string</span></code></a><span class="deltaxml-old" style="background:#FF5555"> </span>can be used to convert a string to its binary representation.</span></p></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-join"></a>5.3 <a href="#func-bin-join" style="text-decoration: none">bin:join</a></h3><dl><dt class="label">Summary</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns the binary data created by concatenating the binary data items in a sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Concatenates a sequence of binary values in order.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:join</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)*</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span style="display: none;" class="delete_version">The function returns an <code>xs:base64Binary</code> created by concatenating the items in the sequence <code>$in</code>, in order.</span><span style="display: none;" class="add_version">The function returns an <code>xs:base64Binary</code> value created by concatenating the binary values in the sequence <code>$in</code>, in order.</span><span class="modify_version">The function returns an <code>xs:base64Binary</code> <span class="deltaxml-new" style="background:#90EE90">value </span>created by concatenating the <span class="deltaxml-old" style="background:#FF5555">items</span><span class="deltaxml-new" style="background:#90EE90">binary values</span> in the sequence <code>$in</code>, in order.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the value of </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns a binary item containing no data bytes.</span></p></dd><dt class="label">Formal Equivalent</dt><dd><p>The effect of the function is equivalent to the result of the following XPath expression.</p><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:from-octets($in !
            bin:to-octets(.))</span></pre><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">$in =!&gt; bin:to-octets() =&gt; bin:from-octets()</span></pre></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Notes</span></dt><dd><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns a </span><a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">zero-length</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><span class="deltaxml-new" style="background:#90EE90"> binary value.</span></p></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:join((bin:hex('0000'), bin:hex('FFFF'), bin:hex('0000'))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('0000FFFF0000')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:join(())</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:join( (1 to 4) ! bin:hex('F0') )</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('F0F0F0F0')</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-insert-before"></a>5.4 <a href="#func-bin-insert-before" style="text-decoration: none">bin:insert-before</a></h3><dl><dt class="label">Summary</dt><dd><p>Inserts <span class="deltaxml-old" style="background:#FF5555">additional binary data</span><span class="deltaxml-new" style="background:#90EE90">octets</span> at a given point in <span class="deltaxml-old" style="background:#FF5555">other binary data</span><span class="deltaxml-new" style="background:#90EE90">a binary value</span>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:insert-before</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$offset</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$extra</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:base64Binary?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span><span class="deltaxml-new" style="background:#90EE90">(xs:hexBinary | xs:base64Binary)</span>?</code></code></span></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns binary data consisting sequentially of the data from </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> upto and including the </span><code><span class="deltaxml-old" style="background:#FF5555">$offset - 1</span></code><span class="deltaxml-old" style="background:#FF5555"> octet, followed by all the data from </span><code><span class="deltaxml-old" style="background:#FF5555">$extra</span></code><span class="deltaxml-old" style="background:#FF5555">, and then the remaining data from </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The </span><code><span class="deltaxml-old" style="background:#FF5555">$offset</span></code><span class="deltaxml-old" style="background:#FF5555"> is zero based.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The value of </span><code><span class="deltaxml-old" style="background:#FF5555">$offset</span></code><span class="verb"><span class="deltaxml-old" style="background:#FF5555">must</span></span><span class="deltaxml-old" style="background:#FF5555"> be a non-negative integer.</span></p><p>If the value of <code>$in</code> is the empty sequence, the function returns an empty sequence.</p><p>If the value of <code>$extra</code> is the empty sequence, the function returns <code>$in</code>.</p><p><span class="deltaxml-old" style="background:#FF5555">If </span><code><span class="deltaxml-old" style="background:#FF5555">$offset eq 0</span></code><span class="deltaxml-old" style="background:#FF5555"> the result is the binary concatenation of </span><code><span class="deltaxml-old" style="background:#FF5555">$extra</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555">, i.e. equivalent to </span><code><span class="deltaxml-old" style="background:#FF5555">bin:join(($extra,$in))</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, the function returns a binary value formed by concatenating the </span><code><span class="deltaxml-new" style="background:#90EE90">bin:part($in, 0, $offset)</span></code><span class="deltaxml-new" style="background:#90EE90">, then </span><code><span class="deltaxml-new" style="background:#90EE90">$extra</span></code><span class="deltaxml-new" style="background:#90EE90">, then </span><code><span class="deltaxml-new" style="background:#90EE90">bin:part($in, $offset)</span></code><code><span class="deltaxml-new" style="background:#90EE90">$extra</span></code><span class="deltaxml-new" style="background:#90EE90">, and then the remaining data from </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The </span><code><span class="deltaxml-new" style="background:#90EE90">$offset</span></code><span class="deltaxml-new" style="background:#90EE90"> is zero based, and </span><span class="verb"><span class="deltaxml-new" style="background:#90EE90">must</span></span><span class="deltaxml-new" style="background:#90EE90"> be non-negative.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">$in =&gt; bin:to-octets() 
    =&gt; insert-before($offset + 1, bin:to-octets($extra)) 
    =&gt; bin:from-octets()</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40index-out-of-range" title="bin:index-out-of-range">bin:index-out-of-range</a>] is raised if <code>$offset</code> is negative or <code>$offset</code> is larger than the size of the binary data of <code>$in</code>.</p></dd><dt class="label">Notes</dt><dd><p class="note"><span class="deltaxml-old" style="background:#FF5555">Note that when </span><code><span class="deltaxml-old" style="background:#FF5555">$offset gt 0 and $offset lt bin:size($in)</span></code><span class="deltaxml-old" style="background:#FF5555"> the function is equivalent to:</span></p><div class="note"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:join((bin:part($in,0,$offset - 1),$extra,bin:part($in,$offset)))</span></pre><p><span class="deltaxml-new" style="background:#90EE90">If </span><code><span class="deltaxml-new" style="background:#90EE90">$offset</span></code><span class="deltaxml-new" style="background:#90EE90"> is zero, the result is the binary concatenation of </span><code><span class="deltaxml-new" style="background:#90EE90">$extra</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:insert-before(bin:hex('FFFF'), 1, bin:hex('00'))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FF00FF')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:insert-before(bin:hex('FFFF'), 0, bin:hex('00'))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('00FFFF')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:insert-before(bin:hex('FFFF'), 2, bin:hex('00'))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FFFF00')</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-pad-left"></a>5.5 <a href="#func-bin-pad-left" style="text-decoration: none">bin:pad-left</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#func-bin-pad-right"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#basic-operations"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">The argument type for </span><code><span class="deltaxml-new" style="background:#90EE90">$octet</span></code><span class="deltaxml-new" style="background:#90EE90"> is changed from </span><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90">. This is made possible by the more liberal coercion rules defined in XPath 4.0. A consequence of the change is that supplying an out-of-range integer value is now a type error with the standard error code </span><code><span class="deltaxml-new" style="background:#90EE90">XPTY0004</span></code><span class="deltaxml-new" style="background:#90EE90">, rather than the custom error code </span><code><span class="deltaxml-new" style="background:#90EE90">bin:octet-out-of-range</span></code><span class="deltaxml-new" style="background:#90EE90"> previously used.</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/1750"><span class="deltaxml-new" style="background:#90EE90">1750</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1753"><span class="deltaxml-new" style="background:#90EE90">1753</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;3 February 2025]</span></i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p><span style="display: none;" class="delete_version">Returns the binary data created by padding <code>$in</code> with <code>$size</code> octets from the left. The padding octet values are <code>$octet</code> or zero if omitted.</span><span style="display: none;" class="add_version">Returns a binary value created by padding <code>$in</code> on the left with <code>$count</code> occurrences of <code>$octet</code>.</span><span class="modify_version">Returns <span class="deltaxml-old" style="background:#FF5555">the binary data</span><span class="deltaxml-new" style="background:#90EE90">a binary value</span> created by padding <code>$in</code> <span class="deltaxml-new" style="background:#90EE90">on the left </span>with <code>$<span class="deltaxml-old" style="background:#FF5555">size</span><span class="deltaxml-new" style="background:#90EE90">count</span></code> <span class="deltaxml-old" style="background:#FF5555">octets from the left. The padding octet values are</span><span class="deltaxml-new" style="background:#90EE90">occurrences of</span> <code>$octet</code><span class="deltaxml-old" style="background:#FF5555"> or zero if omitted</span>.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:pad-left</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><span style="display: none;" class="delete_version"><code>$size</code></span><span style="display: none;" class="add_version"><code>$count</code></span><span class="modify_version"><code>$<span class="deltaxml-old" style="background:#FF5555">size</span><span class="deltaxml-new" style="background:#90EE90">count</span></code></span></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:integer?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:unsigned-byte?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:integer</span><span class="deltaxml-new" style="background:#90EE90">xs:unsigned-byte</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>0</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The function returns an </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555"> created by padding the input with </span><code><span class="deltaxml-old" style="background:#FF5555">$size</span></code><span class="deltaxml-old" style="background:#FF5555"> octets </span><em><span class="deltaxml-old" style="background:#FF5555">in front of</span></em><span class="deltaxml-old" style="background:#FF5555"> the input. If </span><code><span class="deltaxml-old" style="background:#FF5555">$octet</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified, the padding octets each have that value, otherwise they are initialized to 0.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the value of </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, the function returns a binary value consisting of </span><code><span class="deltaxml-new" style="background:#90EE90">$count</span></code><span class="deltaxml-new" style="background:#90EE90"> instances of </span><code><span class="deltaxml-new" style="background:#90EE90">$octet</span></code><span class="deltaxml-new" style="background:#90EE90">, followed by </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90">. The default for </span><code><span class="deltaxml-new" style="background:#90EE90">$octet</span></code><span class="deltaxml-new" style="background:#90EE90"> is zero (0).</span></p><p><code>$size</code><span class="verb">must</span> be a non-negative integer.</p><p><span class="deltaxml-old" style="background:#FF5555">If the value of </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p></dd><dt class="label">Formal Equivalent</dt><dd><p>The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</p><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:join((bin:from-octets((1 to $size) ! $octet), $in))</span></pre><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">(((1 to $count) ! $octet), bin:to-octets($in)) 
=&gt; bin:from-octets()</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40negative-size" title="bin:negative-size">bin:negative-size</a>] is raised if <code>$size</code> is negative.</p><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40octet-out-of-range" title="bin:octet-out-of-range"><span class="deltaxml-old" style="background:#FF5555">bin:octet-out-of-range</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if </span><code><span class="deltaxml-old" style="background:#FF5555">$octet</span></code><span class="deltaxml-old" style="background:#FF5555"> lies outside the range 0 – 255. </span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pad-left(bin:hex('FFFF'), 3)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('000000FFFF')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pad-left(bin:hex('0000'), 3, 255)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FFFFFF0000')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pad-left(bin:hex(''), 8)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('0000000000000000')</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-pad-right"></a>5.6 <a href="#func-bin-pad-right" style="text-decoration: none">bin:pad-right</a></h3><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#endianness"><span class="deltaxml-new" style="background:#90EE90">⬇</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;</span><a href="#func-bin-pad-left"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90">The argument type for </span><code><span class="deltaxml-new" style="background:#90EE90">$octet</span></code><span class="deltaxml-new" style="background:#90EE90"> is changed from </span><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90">. This is made possible by the more liberal coercion rules defined in XPath 4.0. A consequence of the change is that supplying an out-of-range integer value is now a type error with the standard error code </span><code><span class="deltaxml-new" style="background:#90EE90">XPTY0004</span></code><span class="deltaxml-new" style="background:#90EE90">, rather than the custom error code </span><code><span class="deltaxml-new" style="background:#90EE90">bin:octet-out-of-range</span></code><span class="deltaxml-new" style="background:#90EE90"> previously used.</span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/1750"><span class="deltaxml-new" style="background:#90EE90">1750</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1753"><span class="deltaxml-new" style="background:#90EE90">1753</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;3 February 2025]</span></i></p></li></ol></div><dl><dt class="label">Summary</dt><dd><p><span style="display: none;" class="delete_version">Returns the binary data created by padding <code>$in</code> with <code>$size</code> blank octets from the right. The padding octet values are <code>$octet</code> or zero if omitted.</span><span style="display: none;" class="add_version">Returns a binary value created by padding <code>$in</code> on the right with <code>$count</code> occurrences of <code>$octet</code>.</span><span class="modify_version">Returns <span class="deltaxml-old" style="background:#FF5555">the binary data</span><span class="deltaxml-new" style="background:#90EE90">a binary value</span> created by padding <code>$in</code> <span class="deltaxml-new" style="background:#90EE90">on the right </span>with <code>$<span class="deltaxml-old" style="background:#FF5555">size</span><span class="deltaxml-new" style="background:#90EE90">count</span></code> <span class="deltaxml-old" style="background:#FF5555">blank octets from the right. The padding octet values are</span><span class="deltaxml-new" style="background:#90EE90">occurrences of</span> <code>$octet</code><span class="deltaxml-old" style="background:#FF5555"> or zero if omitted</span>.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:pad-right</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><span style="display: none;" class="delete_version"><code>$size</code></span><span style="display: none;" class="add_version"><code>$count</code></span><span class="modify_version"><code>$<span class="deltaxml-old" style="background:#FF5555">size</span><span class="deltaxml-new" style="background:#90EE90">count</span></code></span></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:integer?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:unsignedByte?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:integer</span><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>0</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The function returns an </span><code><span class="deltaxml-old" style="background:#FF5555">xs:base64Binary</span></code><span class="deltaxml-old" style="background:#FF5555"> created by padding the input with </span><code><span class="deltaxml-old" style="background:#FF5555">$size</span></code><span class="deltaxml-old" style="background:#FF5555"> blank octets </span><em><span class="deltaxml-old" style="background:#FF5555">after</span></em><span class="deltaxml-old" style="background:#FF5555"> the input. If </span><code><span class="deltaxml-old" style="background:#FF5555">$octet</span></code><span class="deltaxml-old" style="background:#FF5555"> is specified, the padding octets each have that value, otherwise they are initialized to 0.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the value of </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, the function returns a binary value consisting of </span><code><span class="deltaxml-new" style="background:#90EE90">$in, followed by </span></code><code><span class="deltaxml-new" style="background:#90EE90">$count</span></code><span class="deltaxml-new" style="background:#90EE90"> instances of </span><code><span class="deltaxml-new" style="background:#90EE90">$octet</span></code><span class="deltaxml-new" style="background:#90EE90">. The default for </span><code><span class="deltaxml-new" style="background:#90EE90">$octet</span></code><span class="deltaxml-new" style="background:#90EE90"> is zero (0).</span></p><p><code>$size</code><span class="verb">must</span> be a non-negative integer.</p><p><span class="deltaxml-old" style="background:#FF5555">If the value of </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p></dd><dt class="label">Formal Equivalent</dt><dd><p>The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</p><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-old" style="background:#FF5555">bin:join((bin:from-octets($in,(1 to $size) ! $octet)))</span></pre><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">(bin:to-octets($in), (1 to $count) ! $octet) 
=&gt; bin:from-octets()</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40negative-size" title="bin:negative-size">bin:negative-size</a>] is raised if <code>$size</code> is negative.</p><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40octet-out-of-range" title="bin:octet-out-of-range"><span class="deltaxml-old" style="background:#FF5555">bin:octet-out-of-range</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if </span><code><span class="deltaxml-old" style="background:#FF5555">$octet</span></code><span class="deltaxml-old" style="background:#FF5555"> lies outside the range 0 – 255. </span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pad-right(bin:hex('FFFF'), 3)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FFFF000000')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pad-right(bin:hex('0000'), 3, 255)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('0000FFFFFF')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pad-right(bin:hex(''), 8)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('0000000000000000')</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-find"></a>5.7 <a href="#func-bin-find" style="text-decoration: none">bin:find</a></h3><dl><dt class="label">Summary</dt><dd><p><span style="display: none;" class="delete_version">Returns the first location in <code>$in</code> of <code>$search</code>, starting at the <code>$offset</code> octet.</span><span style="display: none;" class="add_version">Returns the position of the first occurrence of <code>$search</code> within <code>$in</code>, starting at <code>$offset</code>.</span><span class="modify_version">Returns the <span class="deltaxml-old" style="background:#FF5555">first location in</span><span class="deltaxml-new" style="background:#90EE90">position of the first occurrence of</span> <code>$<span class="deltaxml-old" style="background:#FF5555">in</span><span class="deltaxml-new" style="background:#90EE90">search</span></code> <span class="deltaxml-old" style="background:#FF5555">of</span><span class="deltaxml-new" style="background:#90EE90">within</span> <code>$<span class="deltaxml-old" style="background:#FF5555">search</span><span class="deltaxml-new" style="background:#90EE90">in</span></code>, starting at <span class="deltaxml-old" style="background:#FF5555">the </span><code>$offset</code><span class="deltaxml-old" style="background:#FF5555"> octet</span>.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:find</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$offset</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$search</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">The function returns the first location of the binary search sequence in the input, or if not found, the empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">If the value of </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, the function returns the lowest value of </span><var><span class="deltaxml-new" style="background:#90EE90">P</span></var><span class="deltaxml-new" style="background:#90EE90"> that is greater than or equal to </span><code><span class="deltaxml-new" style="background:#90EE90">$offset</span></code><span class="deltaxml-new" style="background:#90EE90">, such that </span><code><span class="deltaxml-new" style="background:#90EE90">bin:part($in, </span><var><span class="deltaxml-new" style="background:#90EE90">P</span></var><span class="deltaxml-new" style="background:#90EE90">, bin:length($search)) eq </span><var><span class="deltaxml-new" style="background:#90EE90">P</span></var></code><span class="deltaxml-new" style="background:#90EE90">. If there is no such value (that is, if </span><code><span class="deltaxml-new" style="background:#90EE90">$search</span></code><span class="deltaxml-new" style="background:#90EE90"> is not found), the function returns the empty sequence.</span></p><p><span style="display: none;" class="delete_version">If <code>$search</code> is empty <code>$offset</code> is returned.</span><span style="display: none;" class="add_version">If <code>$search</code> is <a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow">·</span>zero-length<span class="arrow">·</span></a> then <code>$offset</code> is returned.</span><span class="modify_version">If <code>$search</code> is <span class="deltaxml-old" style="background:#FF5555">empty</span><a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">zero-length</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a> <span class="deltaxml-new" style="background:#90EE90">then </span><code>$offset</code> is returned.</span></p><p>The value of <code>$offset</code><span class="verb">must</span> be a non-negative integer.</p><p>The <code>$offset</code> is zero based.</p><p>The returned location is zero based.</p><p><span class="deltaxml-old" style="background:#FF5555">If the value of </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">($offset to (bin:length($in) - bin:length($search)))
       [bin:part($in, 0, bin:length($search)) eq $search][1]</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40index-out-of-range" title="bin:index-out-of-range">bin:index-out-of-range</a>] is raised if <code>$offset</code> is negative or <code>$offset</code> is larger than the size of the binary data of <code>$in</code>.</p></dd><dt class="label">Notes</dt><dd><p class="note"><span class="deltaxml-old" style="background:#FF5555">Finding all the matches can be accomplished with simple recursive application:</span></p><div class="note"><pre xml:space="preserve" class="small"><span class="deltaxml-old" style="background:#FF5555">&lt;xsl:function name="f:find-all" as="xs:integer*"&gt;
     &lt;xsl:param name="data" as="xs:base64Binary?"/&gt;
     &lt;xsl:param name="offset" as="xs:integer"/&gt;
     &lt;xsl:param name="pattern" as="xs:base64Binary"/&gt;
     &lt;xsl:sequence
         select="if(bin:length($pattern) = 0) then ()
         else let $found := bin:find($data,$offset,$pattern) return
         if($found) then ($found,
             if($found + 1 lt bin:length($data)) then f:find-all($data,$found + 1,$pattern) else ())
             else ()"/&gt;
&lt;/xsl:function&gt;</span></pre><p><span class="deltaxml-new" style="background:#90EE90">Finding all the matches can be accomplished with simple recursive application:</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">&lt;xsl:function name="f:find-all" as="xs:integer*"&gt;
     &lt;xsl:param name="data" as="xs:base64Binary?"/&gt;
     &lt;xsl:param name="offset" as="xs:integer"/&gt;
     &lt;xsl:param name="pattern" as="xs:base64Binary"/&gt;
     &lt;xsl:sequence
         select="if (bin:length($pattern) eq 0) 
                 then ()
                 else let $found := bin:find($data,$offset,$pattern) 
                      return if ($found) 
                             then ($found,
                                   if ($found + 1 lt bin:length($data)) 
                                   then f:find-all($data, $found + 1, $pattern) 
                                   else ())
                             else ()"/&gt;
&lt;/xsl:function&gt;</span></pre></div></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:find((bin:hex('AABBCCDD'), 0, bin:hex('DD'))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">3</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:find((bin:hex('AABBCCDD'), 0, bin:hex('FF'))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">()</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:find((bin:hex('AABBCCDDBBCC'), 2, bin:hex('BBCC'))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">4</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:find((bin:hex('AABBCCDD'), 2, bin:hex(''))</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">2</span></pre></div></td></tr></tbody></table></div></dd></dl></div></div><div class="div1"><h2><a id="text-encoding"></a>6 <a href="#text-encoding" style="text-decoration: none">Text decoding and encoding</a></h2><div class="div2"><h3><a id="func-bin-decode-string"></a>6.1 <a href="#func-bin-decode-string" style="text-decoration: none">bin:decode-string</a></h3><dl><dt class="label">Summary</dt><dd><p>Decodes <span class="deltaxml-new" style="background:#90EE90">a </span>binary <span class="deltaxml-old" style="background:#FF5555">data</span><span class="deltaxml-new" style="background:#90EE90">value</span> as a string in a given encoding.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:decode-string</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$encoding</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>'utf-8'</code>,</td></tr><tr class="arg"><td><code>$offset</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer?</code></code></td><td><code class="assign">:=&nbsp;</code><code>0</code>,</td></tr><tr class="arg"><td><code>$size</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer?</code></code></td><td><code class="assign">:=&nbsp;</code><code>()</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:string?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-new" style="background:#90EE90">If the value of </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span style="display: none;" class="delete_version">If <code>$offset</code> and <code>$size</code> are provided, the <code>$size</code> octets from <code>$offset</code> are decoded. If <code>$offset</code> alone is provided, octets from <code>$offset</code> to the end are decoded, otherwise the entire octet sequence is used.</span><span style="display: none;" class="add_version">If <code>$offset</code> and <code>$size</code> are provided, the <code>$size</code> octets from <code>$offset</code> are decoded. If <code>$offset</code> alone is provided, octets from <code>$offset</code> to the end are decoded, otherwise the entire octet sequence is decoded.</span><span class="modify_version">If <code>$offset</code> and <code>$size</code> are provided, the <code>$size</code> octets from <code>$offset</code> are decoded. If <code>$offset</code> alone is provided, octets from <code>$offset</code> to the end are decoded, otherwise the entire octet sequence is <span class="deltaxml-old" style="background:#FF5555">used</span><span class="deltaxml-new" style="background:#90EE90">decoded</span>.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The function returns the string obtained by decoding the selected octets using the specified </span><code><span class="deltaxml-new" style="background:#90EE90">$encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> name.</span></p><p><span style="display: none;" class="delete_version">The <code>$encoding</code> argument is the name of an encoding. The values for this attribute follow the same rules as for the <code>encoding</code> attribute in an XML declaration. The only values which every implementation is <span class="verb">required</span> to recognize are <code>utf-8</code> and <code>utf-16</code>.</span><span style="display: none;" class="add_version">The <code>$encoding</code> argument is the name of an encoding. The values for <code>$encoding</code> follow the same rules as for the <code>encoding</code> attribute in an XML declaration. The only values which every implementation is <span class="verb">required</span> to recognize are <code>utf-8</code> and <code>utf-16</code>.</span><span class="modify_version">The <code>$encoding</code> argument is the name of an encoding. The values for <code><span class="deltaxml-old" style="background:#FF5555">this</span><span class="deltaxml-new" style="background:#90EE90">$encoding</span></code> <span class="deltaxml-old" style="background:#FF5555">attribute </span>follow the same rules as for the <code>encoding</code> attribute in an XML declaration. The only values which every implementation is <span class="verb">required</span> to recognize are <code>utf-8</code> and <code>utf-16</code>.</span></p><p>If <code>$encoding</code> is omitted, <code>utf-8</code> encoding is assumed.</p><p><span style="display: none;" class="delete_version">The values of <code>$offset</code> and <code>$size</code><span class="verb">must</span> be non-negative integers.</span><span style="display: none;" class="add_version">The values of <code>$offset</code> and <code>$size</code>, if present, <span class="verb">must</span> be non-negative integers.</span><span class="modify_version">The values of <code>$offset</code> and <code>$size</code><span class="deltaxml-new" style="background:#90EE90">, if present, </span><span class="verb">must</span> be non-negative integers.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the value of </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p><p><code>$offset</code> is zero based.</p></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40index-out-of-range" title="bin:index-out-of-range">bin:index-out-of-range</a>]is raised if <code>$offset</code> is negative or <code>$offset + $size</code> is larger than the size of the binary data of <code>$in</code>.</p><p>[<a href="#ERRBIN40negative-size" title="bin:negative-size">bin:negative-size</a>] is raised if <code>$size</code> is negative.</p><p>[<a href="#ERRBIN40unknown-encoding" title="bin:unknown-encoding">bin:unknown-encoding</a>] is raised if <code>$encoding</code> is invalid or not supported by the implementation.</p><p>[<a href="#ERRBIN40conversion-error" title="bin:conversion-error">bin:conversion-error</a>] is raised if there is an error or malformed input during decoding the string. Additional information about the error may be passed through suitable error reporting mechanisms – this is implementation-dependant.</p></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="add_version" style="display: none;"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><p><code>bin:decode-string(bin:hex('414243'))</code></p></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><p><code><span class="deltaxml-new" style="background:#90EE90">bin:decode-string(bin:hex('414243'))</span></code></p></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">"ABC"</pre></div></td></tr><tr class="modify_version"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">"ABC"</span></pre></div></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><p><code>bin:decode-string(bin:hex('FEFF004100420043'), 'utf-16')</code></p></td></tr><tr class="testdiv"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Expression:</span></th><td style="vertical-align:top"><p><code><span class="deltaxml-new" style="background:#90EE90">bin:decode-string(bin:hex('FEFF004100420043'), 'utf-16')</span></code></p></td></tr><tr class="add_version" style="display: none;"><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">"ABC"</pre></div><p><em>(TODO: See issue 1751 regarding the BOM.)</em></p></td></tr><tr class="modify_version"><th style="vertical-align:top"><span class="deltaxml-new" style="background:#90EE90">Result:</span></th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">"ABC"</span></pre></div><p><em><span class="deltaxml-new" style="background:#90EE90">(TODO: See issue 1751 regarding the BOM.)</span></em></p></td></tr><tr><td colspan="2"><p><span class="deltaxml-old" style="background:#FF5555">Testing whether </span><code><span class="deltaxml-old" style="background:#FF5555">$data</span></code><span class="deltaxml-old" style="background:#FF5555"> variable starts with binary content consistent with a PDF file:</span></p><p><span class="deltaxml-new" style="background:#90EE90">The following tests whether the binary value </span><code><span class="deltaxml-new" style="background:#90EE90">$data</span></code><span class="deltaxml-new" style="background:#90EE90"> starts with four octets that decode to the string '%PDF' (which always appears at the start of a PDF file)</span></p></td></tr><tr><td colspan="2"><div class="exampleInner"><pre xml:space="preserve">bin:decode-string($data, 'UTF-8', 0, 4) eq '%PDF'</pre></div></td></tr><tr class="delete_version" style="display: none;"><td colspan="2"><p>The first four characters of a PDF file are <code>'%PDF'</code>.</p></td></tr><tr class="modify_version"><td colspan="2"><p><span class="deltaxml-old" style="background:#FF5555">The first four characters of a PDF file are </span><code><span class="deltaxml-old" style="background:#FF5555">'%PDF'</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-encode-string"></a>6.2 <a href="#func-bin-encode-string" style="text-decoration: none">bin:encode-string</a></h3><dl><dt class="label">Summary</dt><dd><p>Encodes a string into <span class="deltaxml-new" style="background:#90EE90">a </span>binary <span class="deltaxml-old" style="background:#FF5555">data</span><span class="deltaxml-new" style="background:#90EE90">value</span> using a given encoding.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:encode-string</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$encoding</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></td><td><code class="assign">:=&nbsp;</code><code>'utf-8'</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-new" style="background:#90EE90">If the value of </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span style="display: none;" class="delete_version">The <code>$encoding</code> argument is the name of an encoding. The values for this attribute follow the same rules as for the <code>encoding</code> attribute in an XML declaration. The only values which every implementation is <span class="verb">required</span> to recognize are <code>utf-8</code> and <code>utf-16</code>.</span><span style="display: none;" class="add_version">The <code>$encoding</code> argument is the name of an encoding. The values for <code>$encoding</code> follow the same rules as for the <code>encoding</code> attribute in an XML declaration. The only values which every implementation is <span class="verb">required</span> to recognize are <code>utf-8</code> and <code>utf-16</code>.</span><span class="modify_version">The <code>$encoding</code> argument is the name of an encoding. The values for <code><span class="deltaxml-old" style="background:#FF5555">this</span><span class="deltaxml-new" style="background:#90EE90">$encoding</span></code> <span class="deltaxml-old" style="background:#FF5555">attribute </span>follow the same rules as for the <code>encoding</code> attribute in an XML declaration. The only values which every implementation is <span class="verb">required</span> to recognize are <code>utf-8</code> and <code>utf-16</code>.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The function returns the binary value obtained by encoding the string </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> using the specified </span><code><span class="deltaxml-new" style="background:#90EE90">$encoding</span></code><span class="deltaxml-new" style="background:#90EE90"> name.</span></p><p>If <code>$encoding</code> is omitted, <code>utf-8</code> encoding is assumed.</p><p><span class="deltaxml-old" style="background:#FF5555">If the value of </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40unknown-encoding" title="bin:unknown-encoding">bin:unknown-encoding</a>] is raised if <code>$encoding</code> is invalid or not supported by the implementation.</p><p>[<a href="#ERRBIN40conversion-error" title="bin:conversion-error">bin:conversion-error</a>]is raised if there is an error or malformed input during encoding the string. Additional information about the error may be passed through suitable error reporting mechanisms – this is implementation-dependant.</p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:encode-string('ABC')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('414243')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:encode-string('ABC', 'utf-16')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FEFF004100420043')</span></pre></div><p><em><span class="deltaxml-new" style="background:#90EE90">(TODO: The result has a BOM. See issue 1751.)</span></em></p></td></tr></tbody></table></div></dd></dl></div></div><div class="div1"><h2><a id="numeric-packing"></a>7 <a href="#numeric-packing" style="text-decoration: none">Packing and unpacking of encoded numeric values</a></h2><div class="div2"><h3><a id="number-rep"></a>7.1 <a href="#number-rep" style="text-decoration: none">Numeric representation</a></h3><div class="div3"><h4><a id="endianness"></a>7.1.1 <a style="text-decoration: none" href="#endianness"><span class="deltaxml-old" style="background:#FF5555">Number 'endianness'</span></a><a style="text-decoration: none" href="#endianness"><span class="deltaxml-new" style="background:#90EE90">Octet order</span></a></h4><div class="changes"><p class="changesHeading"><span class="deltaxml-new" style="background:#90EE90">Changes in 4.0&nbsp;</span><a href="#func-bin-pad-right"><span class="deltaxml-new" style="background:#90EE90">⬆</span></a></p><ol><li><p><span class="deltaxml-new" style="background:#90EE90"> The </span><code><span class="deltaxml-new" style="background:#90EE90">octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> parameter of relevant functions now has an </span><code><span class="deltaxml-new" style="background:#90EE90">enum</span></code><span class="deltaxml-new" style="background:#90EE90"> type rather than a string type. In consequence, supplying an incorrect value is now a type error ([</span><a href="https://www.w3.org/TR/xpath20/#ERRXPTY0004" title="bin:TY0004"><span class="deltaxml-new" style="background:#90EE90">bin:TY0004</span></a><span class="deltaxml-new" style="background:#90EE90">]</span><sup><small><span class="deltaxml-new" style="background:#90EE90">XP</span></small></sup><span class="deltaxml-new" style="background:#90EE90">) and no longer has a custom error code. </span><i><span class="deltaxml-new" style="background:#90EE90">&nbsp;&nbsp;[Issue </span><a href="https://github.com/qt4cg/qtspecs/issues/1750"><span class="deltaxml-new" style="background:#90EE90">1750</span></a><span class="deltaxml-new" style="background:#90EE90">&nbsp;]</span></i></p></li></ol></div><p>Packing and unpacking numeric values within binary data can be performed in 'most-significant-first' ('big-endian') or 'least-significant-first' ('little-endian') octet order. The default is <em>'most-significant-first'</em>. The relevant functions have an optional parameter <code>$octet-order</code> whose string value controls the order. Least-significant-first order is indicated by any of the values <code>least-significant-first</code>, <code>little-endian</code> or <code>LE</code>. Most-significant-first order is indicated by any of the values <code>most-significant-first</code>, <code>big-endian</code> or <code>BE</code>.</p><p><span class="deltaxml-new" style="background:#90EE90">The type of the </span><code><span class="deltaxml-new" style="background:#90EE90">octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> argument to the relevant function is given as </span><code><span class="deltaxml-new" style="background:#90EE90">enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">By default, functions that convert numeric values to binary use most-significant-first ordering. This corresponds to the order most commonly used in network protocols, and is often referred to as </span><b><span class="deltaxml-new" style="background:#90EE90">network order</span></b><span class="deltaxml-new" style="background:#90EE90">. If least-significant-first ordering is requested, the order of octets in the result is reversed. This ordering, although often used internally within computer hardware, is less commonly encountered in network protocol standards: two places where it is used are the DICOM standard for medical imaging, and the Bitcoin standard for cryptocurrency.</span></p></div><div class="div3"><h4><a id="integer"></a>7.1.2 <a href="#integer" style="text-decoration: none">Integer representation</a></h4><p></p><p>Integers within binary data are represented, or assumed to be represented, as an integral number of octets. Integers where <code>$length</code> is greater than 8 octets (and thus not representable as a <code>long</code>) might be expected in some situations, e.g. encryption. Whether the range of integers is limited to <code>±2^63</code> is <a href="https://qt4cg.org/specifications/xpath-functions-40/#implementation-dependent">implementation-dependent</a><sup><small>FO</small></sup>.</p></div><div class="div3"><h4><a id="floating"></a>7.1.3 <a href="#floating" style="text-decoration: none">Representation of floating point numbers</a></h4><p><span style="display: none;" class="delete_version">Care should be taken with the packing and unpacking of floating point numbers (<code>xs:float</code> and <code>xs:double</code>). The binary representations are expected to correspond with those of the IEEE single/double-precision 32/64-bit floating point types <a href="#ieee754">[IEEE 754-1985]</a>. Consequently they will occupy 4 or 8 octets when packed.</span><span style="display: none;" class="add_version">When packing and unpacking floating point numbers (<code>xs:float</code> and <code>xs:double</code>), the binary representations are expected to correspond with those of the IEEE single/double-precision 32/64-bit floating point types <a href="#ieee754">[IEEE 754-1985]</a>. Consequently they will occupy 4 or 8 octets when packed.</span><span class="modify_version"><span class="deltaxml-old" style="background:#FF5555">Care should be taken with the</span><span class="deltaxml-new" style="background:#90EE90">When</span> packing and unpacking <span class="deltaxml-old" style="background:#FF5555">of </span>floating point numbers (<code>xs:float</code> and <code>xs:double</code>)<span class="deltaxml-old" style="background:#FF5555">. The</span><span class="deltaxml-new" style="background:#90EE90">, the</span> binary representations are expected to correspond with those of the IEEE single/double-precision 32/64-bit floating point types <a href="#ieee754">[IEEE 754-1985]</a>. Consequently they will occupy 4 or 8 octets when packed.</span></p><p><span class="deltaxml-old" style="background:#FF5555">Positive and negative infinities are supported. </span><code><span class="deltaxml-old" style="background:#FF5555">INF</span></code><span class="deltaxml-old" style="background:#FF5555"> maps to </span><code><span class="deltaxml-old" style="background:#FF5555">0x7f80 0000</span></code><span class="deltaxml-old" style="background:#FF5555"> (float), </span><code><span class="deltaxml-old" style="background:#FF5555">0x7ff0 0000 0000 0000</span></code><span class="deltaxml-old" style="background:#FF5555"> (double). </span><code><span class="deltaxml-old" style="background:#FF5555">-INF</span></code><span class="deltaxml-old" style="background:#FF5555"> maps to </span><code><span class="deltaxml-old" style="background:#FF5555">0xff80 0000</span></code><span class="deltaxml-old" style="background:#FF5555"> (float), </span><code><span class="deltaxml-old" style="background:#FF5555">0xfff0 0000 0000 0000</span></code><span class="deltaxml-old" style="background:#FF5555"> (double).</span></p><p><span class="deltaxml-old" style="background:#FF5555">Negative zero (</span><code><span class="deltaxml-old" style="background:#FF5555">0x8000 0000 0000 0000</span></code><span class="deltaxml-old" style="background:#FF5555"> double, </span><code><span class="deltaxml-old" style="background:#FF5555">0x8000 0000</span></code><span class="deltaxml-old" style="background:#FF5555"> float) encountered during unpacking will yield negative zero forms (e.g. </span><code><span class="deltaxml-old" style="background:#FF5555">-xs:double(0.0)</span></code><span class="deltaxml-old" style="background:#FF5555">) and negative zeros will be written as a result of packing.</span></p><p><a href="#xmlschema-2"><span class="deltaxml-old" style="background:#FF5555">[XML Schema Part 2: Datatypes Second Edition]</span></a><span class="deltaxml-old" style="background:#FF5555"> provides only one form of </span><code><span class="deltaxml-old" style="background:#FF5555">NaN</span></code><span class="deltaxml-old" style="background:#FF5555"> which corresponds to a 'quiet' </span><code><span class="deltaxml-old" style="background:#FF5555">NaN</span></code><span class="deltaxml-old" style="background:#FF5555"> with zero payload of </span><a href="#ieee754"><span class="deltaxml-old" style="background:#FF5555">[IEEE 754-1985]</span></a><span class="deltaxml-old" style="background:#FF5555"> with forms </span><code><span class="deltaxml-old" style="background:#FF5555">0x7fc0 0000</span></code><span class="deltaxml-old" style="background:#FF5555"> (float), </span><code><span class="deltaxml-old" style="background:#FF5555">0x7ff8 0000 0000 0000</span></code><span class="deltaxml-old" style="background:#FF5555"> (double). These are the bit forms that will be packed.</span></p><p><span class="deltaxml-old" style="background:#FF5555"> 'Signalling' </span><code><span class="deltaxml-old" style="background:#FF5555">NaN</span></code><span class="deltaxml-old" style="background:#FF5555"> values (</span><code><span class="deltaxml-old" style="background:#FF5555">0x7f80 0001</span></code><span class="deltaxml-old" style="background:#FF5555"> → </span><code><span class="deltaxml-old" style="background:#FF5555">0x7fbf ffff</span></code><span class="deltaxml-old" style="background:#FF5555"> or </span><code><span class="deltaxml-old" style="background:#FF5555">0xff80 0001</span></code><span class="deltaxml-old" style="background:#FF5555"> → </span><code><span class="deltaxml-old" style="background:#FF5555">0xffbf ffff</span></code><span class="deltaxml-old" style="background:#FF5555">, </span><code><span class="deltaxml-old" style="background:#FF5555">0x7ff0 0000 0000 0001</span></code><span class="deltaxml-old" style="background:#FF5555"> → </span><code><span class="deltaxml-old" style="background:#FF5555">0x7ff7 ffff ffff ffff</span></code><span class="deltaxml-old" style="background:#FF5555"> or </span><code><span class="deltaxml-old" style="background:#FF5555">0xfff0 0000 0000 0001</span></code><span class="deltaxml-old" style="background:#FF5555"> → </span><code><span class="deltaxml-old" style="background:#FF5555">0xfff7 ffff ffff ffff</span></code><span class="deltaxml-old" style="background:#FF5555">) encountered during unpacking will be replaced by 'quiet' </span><code><span class="deltaxml-old" style="background:#FF5555">NaN</span></code><span class="deltaxml-old" style="background:#FF5555">. Any low-order payload in a unpacked 'quiet' </span><code><span class="deltaxml-old" style="background:#FF5555">NaN</span></code><span class="deltaxml-old" style="background:#FF5555"> is also zeroed. </span></p><p><span class="deltaxml-new" style="background:#90EE90">Special float and double formats are represented in IEEE format as follows:</span></p><ul><li><p><code><span class="deltaxml-new" style="background:#90EE90">INF</span></code><span class="deltaxml-new" style="background:#90EE90"> maps to </span><code><span class="deltaxml-new" style="background:#90EE90">0x7f80_0000</span></code><span class="deltaxml-new" style="background:#90EE90"> (float), or </span><code><span class="deltaxml-new" style="background:#90EE90">0x7ff0_0000_0000_0000</span></code><span class="deltaxml-new" style="background:#90EE90"> (double). </span></p></li><li><p><code><span class="deltaxml-new" style="background:#90EE90">-INF</span></code><span class="deltaxml-new" style="background:#90EE90"> maps to </span><code><span class="deltaxml-new" style="background:#90EE90">0xff80_0000</span></code><span class="deltaxml-new" style="background:#90EE90"> (float), or </span><code><span class="deltaxml-new" style="background:#90EE90">0xfff0_0000_0000_0000</span></code><span class="deltaxml-new" style="background:#90EE90"> (double).</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">Negative zero maps to </span><code><span class="deltaxml-new" style="background:#90EE90">0x8000_0000</span></code><span class="deltaxml-new" style="background:#90EE90"> (float), or </span><code><span class="deltaxml-new" style="background:#90EE90">0x8000_0000_0000_0000</span></code><span class="deltaxml-new" style="background:#90EE90"> (double).</span></p></li><li><p><code><span class="deltaxml-new" style="background:#90EE90">NaN</span></code><span class="deltaxml-new" style="background:#90EE90"> in the XSD and XDM type system corresponds to a </span><b><span class="deltaxml-new" style="background:#90EE90">quiet NaN</span></b><span class="deltaxml-new" style="background:#90EE90"> as defined in </span><a href="#ieee754"><span class="deltaxml-new" style="background:#90EE90">[IEEE 754-1985]</span></a><span class="deltaxml-new" style="background:#90EE90">, and therefore maps to </span><code><span class="deltaxml-new" style="background:#90EE90">0x7fc0_0000</span></code><span class="deltaxml-new" style="background:#90EE90"> (float), or </span><code><span class="deltaxml-new" style="background:#90EE90">0x7ff8_0000_0000_0000</span></code><span class="deltaxml-new" style="background:#90EE90"> (double). These are the bit forms that will be packed.</span></p></li><li><p><span class="deltaxml-new" style="background:#90EE90">IEEE </span><b><span class="deltaxml-new" style="background:#90EE90">signalling NaN</span></b><span class="deltaxml-new" style="background:#90EE90"> values may be encountered in binary data, with the value range </span><code><span class="deltaxml-new" style="background:#90EE90">0x7f80_0001</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">0x7fbf_ffff</span></code><span class="deltaxml-new" style="background:#90EE90"> (float), or </span><code><span class="deltaxml-new" style="background:#90EE90">0x7ff0_0000_0000_0001</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">0x7ff7_ffff_ffff_ffff</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code><span class="deltaxml-new" style="background:#90EE90">0xfff0_0000_0000_0001</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">0xfff7_ffff_ffff_ffff</span></code><span class="deltaxml-new" style="background:#90EE90"> (double). Any such value encountered during unpacking will be replaced by a quiet </span><code><span class="deltaxml-new" style="background:#90EE90">NaN</span></code><span class="deltaxml-new" style="background:#90EE90">. Any low-order payload in an unpacked quiet </span><code><span class="deltaxml-new" style="background:#90EE90">NaN</span></code><span class="deltaxml-new" style="background:#90EE90"> is also zeroed.</span></p></li></ul></div></div><div class="div2"><h3><a id="func-bin-pack-double"></a>7.2 <a href="#func-bin-pack-double" style="text-decoration: none">bin:pack-double</a></h3><dl><dt class="label">Summary</dt><dd><p><span style="display: none;" class="delete_version">Returns the 8-octet binary representation of a <a href="http://www.w3.org/TR/xmlschema-2/#double">double</a> value.</span><span style="display: none;" class="add_version">Returns the 8-octet binary representation of an <code>xs:double</code> value.</span><span class="modify_version">Returns the 8-octet binary representation of <span class="deltaxml-old" style="background:#FF5555">a</span><span class="deltaxml-new" style="background:#90EE90">an</span> <a href="http://www.w3.org/TR/xmlschema-2/#double"><span class="deltaxml-old" style="background:#FF5555">double</span></a><code><span class="deltaxml-new" style="background:#90EE90">xs:double</span></code> value.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:pack-double</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:double</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet-order</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span><span class="deltaxml-new" style="background:#90EE90">enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>'most-significant-first'</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span style="display: none;" class="delete_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter is specified. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b>7.1.1 Number 'endianness'</b></a>.</span><span style="display: none;" class="add_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter specifies otherwise. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b>7.1.1 Octet order</b></a>.</span><span class="modify_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter <span class="deltaxml-old" style="background:#FF5555">is specified</span><span class="deltaxml-new" style="background:#90EE90">specifies otherwise</span>. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b><span class="deltaxml-old" style="background:#FF5555">7.1.1 Number 'endianness'</span></b></a><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a>.</span></p><p>The binary representation will correspond with that of the IEEE double-precision 64-bit floating point type <a href="#ieee754">[IEEE 754-1985]</a>. For more details see <a href="#floating"><b>7.1.3 Representation of floating point numbers</b></a>.</p></dd><dt class="label"><span class="deltaxml-old" style="background:#FF5555">Error Conditions</span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40unknown-significance-order" title="bin:unknown-significance-order"><span class="deltaxml-old" style="background:#FF5555">bin:unknown-significance-order</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if the value </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> is unrecognized.</span></p></dd></dl></div><div class="div2"><h3><a id="func-bin-pack-float"></a>7.3 <a href="#func-bin-pack-float" style="text-decoration: none">bin:pack-float</a></h3><dl><dt class="label">Summary</dt><dd><p>Returns the 4-octet binary representation of a <a href="http://www.w3.org/TR/xmlschema-2/#float">float</a> value.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:pack-float</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:float</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet-order</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span><span class="deltaxml-new" style="background:#90EE90">xs:enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>'most-significant-first'</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span style="display: none;" class="delete_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter is specified. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b>7.1.1 Number 'endianness'</b></a>.</span><span style="display: none;" class="add_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter is specified. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b>7.1.1 Octet order</b></a>.</span><span class="modify_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter is specified. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b><span class="deltaxml-old" style="background:#FF5555">7.1.1 Number 'endianness'</span></b></a><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a>.</span></p><p>The binary representation will correspond with that of the IEEE single-precision 32-bit floating point type <a href="#ieee754">[IEEE 754-1985]</a>. For more details see <a href="#floating"><b>7.1.3 Representation of floating point numbers</b></a>.</p></dd><dt class="label"><span class="deltaxml-old" style="background:#FF5555">Error Conditions</span></dt><dd><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40unknown-significance-order" title="bin:unknown-significance-order"><span class="deltaxml-old" style="background:#FF5555">bin:unknown-significance-order</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if the value </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> is unrecognized.</span></p></dd></dl></div><div class="div2"><h3><a id="func-bin-pack-integer"></a>7.4 <a href="#func-bin-pack-integer" style="text-decoration: none">bin:pack-integer</a></h3><dl><dt class="label">Summary</dt><dd><p><span style="display: none;" class="delete_version">Returns the <em>twos-complement</em> binary representation of an integer value treated as <code>$size</code> octets long. Any 'excess' high-order bits are discarded.</span><span style="display: none;" class="add_version">Returns the <em>twos-complement</em> binary representation of an integer value as a binary value of a given size.</span><span class="modify_version">Returns the <em>twos-complement</em> binary representation of an integer value <span class="deltaxml-old" style="background:#FF5555">treated </span>as <span class="deltaxml-old" style="background:#FF5555">$size</span><span class="deltaxml-new" style="background:#90EE90">a</span> <span class="deltaxml-old" style="background:#FF5555">octets long. Any 'excess' high-order bits are discarded</span><span class="deltaxml-new" style="background:#90EE90">binary value of a given size</span>.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:pack-integer</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$size</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet-order</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span><span class="deltaxml-new" style="background:#90EE90">enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>'most-significant-first'</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Most-significant-octet-first number representation is assumed unless the </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> parameter is specified. Acceptable values for </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> are described in </span><a href="#endianness"><b><span class="deltaxml-old" style="background:#FF5555">7.1.1 Number 'endianness'</span></b></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The function produces a binary value containing the twos-complement representation of </span><code><span class="deltaxml-new" style="background:#90EE90">$in mod math:pow(256, $size)</span></code><span class="deltaxml-new" style="background:#90EE90">, padded on the left to </span><code><span class="deltaxml-new" style="background:#90EE90">$size</span></code><span class="deltaxml-new" style="background:#90EE90"> octets with zero bits if the value is positive, or one bits if it is negative.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The order of octets in the result is most-significant-first unless </span><code><span class="deltaxml-new" style="background:#90EE90">$octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> specifies otherwise. Acceptable values for </span><code><span class="deltaxml-new" style="background:#90EE90">$octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> are described in </span><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a><span class="deltaxml-new" style="background:#90EE90">. If least-significant-first ordering is requested then the order of octets in the result is reversed.</span></p><p><span style="display: none;" class="delete_version">Specifying a <code>$size</code> of zero yields an empty binary data.</span><span style="display: none;" class="add_version">Specifying a <code>$size</code> of zero yields a <a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow">·</span>zero-length<span class="arrow">·</span></a> binary value.</span><span class="modify_version">Specifying a <code>$size</code> of zero yields <span class="deltaxml-old" style="background:#FF5555">an empty</span><span class="deltaxml-new" style="background:#90EE90">a </span><a title="zero-length" class="termref" href="#dt-zero-length"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">zero-length</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a> binary <span class="deltaxml-old" style="background:#FF5555">data</span><span class="deltaxml-new" style="background:#90EE90">value</span>.</span></p></dd><dt class="label">Error Conditions</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40unknown-significance-order" title="bin:unknown-significance-order"><span class="deltaxml-old" style="background:#FF5555">bin:unknown-significance-order</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if the value </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> is unrecognized.</span></p><p>[<a href="#ERRBIN40negative-size" title="bin:negative-size">bin:negative-size</a>] is raised if <code>$size</code> is negative.</p></dd><dt class="label">Notes</dt><dd><p class="note"><span class="deltaxml-old" style="background:#FF5555">If the integer being packed has a maximum precision of </span><code><span class="deltaxml-old" style="background:#FF5555">$size</span></code><span class="deltaxml-old" style="background:#FF5555"> octets, then signed/unsigned versions are not necessary. If the data is considered unsigned, then the most significant bit of the bottom </span><code><span class="deltaxml-old" style="background:#FF5555">$size</span></code><span class="deltaxml-old" style="background:#FF5555"> octets has a normal positive (</span><code><span class="deltaxml-old" style="background:#FF5555">2^(8 *$size - 1)</span></code><span class="deltaxml-old" style="background:#FF5555">) meaning. If it is considered to be a signed value, then the MSB and all the higher order, discarded bits will be '1' for a negative value and '0' for a positive or zero. If this function were to check the 'sizing' of the supplied integer against the packing size, then any values of MSB and the discarded higher order bits other than 'all 1' or 'all 0' would constitute an error. </span><em><span class="deltaxml-old" style="background:#FF5555">This function does not perform such checking.</span></em></p><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">If the integer being packed has a maximum precision of </span><code><span class="deltaxml-new" style="background:#90EE90">$size</span></code><span class="deltaxml-new" style="background:#90EE90"> octets, then signed/unsigned versions are not necessary. If the data is considered unsigned, then the most significant bit of the bottom </span><code><span class="deltaxml-new" style="background:#90EE90">$size</span></code><span class="deltaxml-new" style="background:#90EE90"> octets has a normal positive (</span><code><span class="deltaxml-new" style="background:#90EE90">2^(8 *$size - 1)</span></code><span class="deltaxml-new" style="background:#90EE90">) meaning. If it is considered to be a signed value, then the MSB and all the higher order, discarded bits will be '1' for a negative value and '0' for a positive or zero. If this function were to check the sizing of the supplied integer against the packing size, then any values of MSB and the discarded higher order bits other than 'all 1' or 'all 0' would constitute an error. </span><em><span class="deltaxml-new" style="background:#90EE90">This function does not perform such checking.</span></em></p><p><span class="deltaxml-new" style="background:#90EE90">Least-significant-first byte ordering simply reverses the octets in the result.</span></p></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pack-integer(256, 2)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('0100')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pack-integer(256, 4)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('00000100')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pack-integer(65536, 2)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('0000')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pack-integer(256, 2, "LE")</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('0001')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pack-integer(-1, 2)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FFFF')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pack-integer(-2, 4)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FFFFFFFE')</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:pack-integer(-2, 4, 'LE')</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">bin:hex('FEFFFFFF')</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-unpack-double"></a>7.5 <a href="#func-bin-unpack-double" style="text-decoration: none">bin:unpack-double</a></h3><dl><dt class="label">Summary</dt><dd><p><span style="display: none;" class="delete_version">Extract <a href="http://www.w3.org/TR/xmlschema-2/#double">double</a> value stored at the particular offset in binary data.</span><span style="display: none;" class="add_version">Extracts an <code>xs:double</code> value held in IEEE format at the given offset in a binary value.</span><span class="modify_version"><span class="deltaxml-old" style="background:#FF5555">Extract</span><span class="deltaxml-new" style="background:#90EE90">Extracts</span> <a href="http://www.w3.org/TR/xmlschema-2/#double"><span class="deltaxml-old" style="background:#FF5555">double</span></a><span class="deltaxml-new" style="background:#90EE90">an</span> <code><span class="deltaxml-new" style="background:#90EE90">xs:double</span></code><span class="deltaxml-new" style="background:#90EE90"> </span>value <span class="deltaxml-old" style="background:#FF5555">stored</span><span class="deltaxml-new" style="background:#90EE90">held in IEEE format</span> at the <span class="deltaxml-old" style="background:#FF5555">particular</span><span class="deltaxml-new" style="background:#90EE90">given</span> offset in <span class="deltaxml-new" style="background:#90EE90">a </span>binary <span class="deltaxml-old" style="background:#FF5555">data</span><span class="deltaxml-new" style="background:#90EE90">value</span>.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:unpack-double</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)</code></code>,</td><td></td></tr><tr class="arg"><td><code>$offset</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet-order</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span><span class="deltaxml-new" style="background:#90EE90">enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>'most-significant-first'</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:double</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p>Extract the <a href="http://www.w3.org/TR/xmlschema-2/#double">double</a> value stored in the 8 successive octets from the <code>$offset</code> octet of the binary data of <code>$in</code>.</p><p><span style="display: none;" class="delete_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter is specified. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b>7.1.1 Number 'endianness'</b></a>.</span><span style="display: none;" class="add_version">Most-significant-first number representation is assumed unless the <code>$octet-order</code> parameter specifies otherwise. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b>7.1.1 Octet order</b></a>.</span><span class="modify_version">Most-significant-<span class="deltaxml-old" style="background:#FF5555">octet-</span>first number representation is assumed unless the <code>$octet-order</code> parameter <span class="deltaxml-old" style="background:#FF5555">is specified</span><span class="deltaxml-new" style="background:#90EE90">specifies otherwise</span>. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b><span class="deltaxml-old" style="background:#FF5555">7.1.1 Number 'endianness'</span></b></a><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a>.</span></p><p>The value of <code>$offset</code><span class="verb">must</span> be a non-negative integer.</p><p>The <code>$offset</code> is zero based.</p><p>The binary representation is expected to correspond with that of the IEEE double-precision 64-bit floating point type <a href="#ieee754">[IEEE 754-1985]</a>. For more details see <a href="#floating"><b>7.1.3 Representation of floating point numbers</b></a>.</p></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40index-out-of-range" title="bin:index-out-of-range">bin:index-out-of-range</a>] is raised if <code>$offset</code> is negative or <code>$offset + 8</code> (octet-length of <code>xs:double</code>) is larger than the size of the binary data of <code>$in</code>.</p><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40unknown-significance-order" title="bin:unknown-significance-order"><span class="deltaxml-old" style="background:#FF5555">bin:unknown-significance-order</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if the value </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> is unrecognized.</span></p></dd></dl></div><div class="div2"><h3><a id="func-bin-unpack-float"></a>7.6 <a href="#func-bin-unpack-float" style="text-decoration: none">bin:unpack-float</a></h3><dl><dt class="label">Summary</dt><dd><p>Extract <a href="http://www.w3.org/TR/xmlschema-2/#float">float</a> value stored at the particular offset in binary data.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:unpack-float</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)</code></code>,</td><td></td></tr><tr class="arg"><td><code>$offset</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet-order</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span><span class="deltaxml-new" style="background:#90EE90">enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>'most-significant-first'</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:float</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p>Extract the <a href="http://www.w3.org/TR/xmlschema-2/#float">float</a> value stored in the 4 successive octets from the <code>$offset</code> octet of the binary data of <code>$in</code>.</p><p><span style="display: none;" class="delete_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter is specified. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b>7.1.1 Number 'endianness'</b></a>.</span><span style="display: none;" class="add_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter specifies otherwise. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b>7.1.1 Octet order</b></a>.</span><span class="modify_version">Most-significant-octet-first number representation is assumed unless the <code>$octet-order</code> parameter <span class="deltaxml-old" style="background:#FF5555">is specified</span><span class="deltaxml-new" style="background:#90EE90">specifies otherwise</span>. Acceptable values for <code>$octet-order</code> are described in <a href="#endianness"><b><span class="deltaxml-old" style="background:#FF5555">7.1.1 Number 'endianness'</span></b></a><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a>.</span></p><p>The value of <code>$offset</code><span class="verb">must</span> be a non-negative integer.</p><p>The <code>$offset</code> is zero based.</p><p>The binary representation is expected to correspond with that of the IEEE single-precision 32-bit floating point type <a href="#ieee754">[IEEE 754-1985]</a>. For more details see <a href="#floating"><b>7.1.3 Representation of floating point numbers</b></a>.</p></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40index-out-of-range" title="bin:index-out-of-range">bin:index-out-of-range</a>] is raised if <code>$offset</code> is negative or <code>$offset + 4</code> (octet-length of <code>xs:float</code>) is larger than the size of the binary data of <code>$in</code>.</p><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40unknown-significance-order" title="bin:unknown-significance-order"><span class="deltaxml-old" style="background:#FF5555">bin:unknown-significance-order</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if the value </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> is unrecognized.</span></p></dd></dl></div><div class="div2"><h3><a id="func-bin-unpack-integer"></a>7.7 <a href="#func-bin-unpack-integer" style="text-decoration: none">bin:unpack-integer</a></h3><dl><dt class="label">Summary</dt><dd><p><span style="display: none;" class="delete_version">Returns a signed integer value represented by the <code>$size</code> octets starting from <code>$offset</code> in the input binary representation. Necessary sign extension is performed (i.e. the result is negative if the high order bit is '1').</span><span style="display: none;" class="add_version">Returns a signed integer value represented by the <code>$size</code> octets starting from <code>$offset</code> in the input binary value.</span><span class="modify_version">Returns a signed integer value represented by the <code>$size</code> octets starting from <code>$offset</code> in the input binary <span class="deltaxml-old" style="background:#FF5555">representation. Necessary sign extension is performed (i.e. the result is negative if the high order bit is '1').</span><span class="deltaxml-new" style="background:#90EE90">value.</span></span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:unpack-integer</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)</code></code>,</td><td></td></tr><tr class="arg"><td><code>$offset</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$size</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet-order</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span><span class="deltaxml-new" style="background:#90EE90">enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>'most-significant-first'</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Most-significant-octet-first number representation is assumed unless the </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> parameter is specified. Acceptable values for </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> are described in </span><a href="#endianness"><b><span class="deltaxml-old" style="background:#FF5555">7.1.1 Number 'endianness'</span></b></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The function produces an integer represented by the binary value </span><code><span class="deltaxml-new" style="background:#90EE90">bin:part($in, $offset, $size)</span></code><span class="deltaxml-new" style="background:#90EE90">. This is interpreted as a twos-complement representation of a signed integer, with the most significant octet first unless the </span><code><span class="deltaxml-new" style="background:#90EE90">$octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> option specifies otherwise.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Acceptable values for </span><code><span class="deltaxml-new" style="background:#90EE90">$octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> are described in </span><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a><span class="deltaxml-new" style="background:#90EE90">. If least-significant-first ordering is requested then the order of octets in the input is reversed.</span></p><p>The values of <code>$offset</code> and <code>$size</code><span class="verb">must</span> be non-negative integers.</p><p><code>$offset</code> is zero based.</p><p>Specifying a <code>$size</code> of zero yields the integer <code>0</code>.</p></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40index-out-of-range" title="bin:index-out-of-range">bin:index-out-of-range</a>] is raised if <code>$offset</code> is negative or <code>$offset + $size</code> is larger than the size of the binary data of <code>$in</code>.</p><p>[<a href="#ERRBIN40negative-size" title="bin:negative-size">bin:negative-size</a>] is raised if <code>$size</code> is negative.</p><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40unknown-significance-order" title="bin:unknown-significance-order"><span class="deltaxml-old" style="background:#FF5555">bin:unknown-significance-order</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if the value </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> is unrecognized.</span></p></dd><dt class="label">Notes</dt><dd><p class="note"><span class="deltaxml-old" style="background:#FF5555">For discussion on integer range see </span><a href="#integer"><b><span class="deltaxml-old" style="background:#FF5555">7.1.2 Integer representation</span></b></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">For discussion on integer range see </span><a href="#integer"><b><span class="deltaxml-new" style="background:#90EE90">7.1.2 Integer representation</span></b></a><span class="deltaxml-new" style="background:#90EE90">.</span></p></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-integer(bin:hex('0100'), 0, 2)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">256</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-integer(bin:hex('00000100'), 0, 4)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">256</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-integer(bin:hex('FFFF'), 0, 2)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">-1</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-integer(bin:hex('00FFFFFFFF'), 1, 4)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">-1</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-integer(bin:hex('FEFF'), 0, 2, "LE")</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">-2</span></pre></div></td></tr></tbody></table></div></dd></dl></div><div class="div2"><h3><a id="func-bin-unpack-unsigned-integer"></a>7.8 <a href="#func-bin-unpack-unsigned-integer" style="text-decoration: none">bin:unpack-unsigned-integer</a></h3><dl><dt class="label">Summary</dt><dd><p>Returns an unsigned integer value represented by the <code>$size</code> octets starting from <code>$offset</code> in the input binary representation.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:unpack-unsigned-integer</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)</code></code>,</td><td></td></tr><tr class="arg"><td><code>$offset</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$size</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code>,</td><td></td></tr><tr class="arg"><td><code>$octet-order</code></td><td><span style="display: none;" class="delete_version"><code class="as">as&nbsp;</code><code class="type"><code>xs:string?</code></code></span><span style="display: none;" class="add_version"><code class="as">as&nbsp;</code><code class="type"><code>enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')?</code></code></span><span class="modify_version"><code class="as">as&nbsp;</code><code class="type"><code><span class="deltaxml-old" style="background:#FF5555">xs:string</span><span class="deltaxml-new" style="background:#90EE90">enum('least-significant-first', 'little-endian', 'LE', 'most-significant-first', 'big-endian', 'BE')</span>?</code></code></span></td><td><code class="assign">:=&nbsp;</code><code>'most-significant-first'</code></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:integer</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Most-significant-octet-first number representation is assumed unless the </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> parameter is specified. Acceptable values for </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> are described in </span><a href="#endianness"><b><span class="deltaxml-old" style="background:#FF5555">7.1.1 Number 'endianness'</span></b></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The function produces an integer represented by the binary value </span><code><span class="deltaxml-new" style="background:#90EE90">bin:part($in, $offset, $size)</span></code><span class="deltaxml-new" style="background:#90EE90">. This is interpreted as a representation of an unsigned integer, with the most significant octet first unless the </span><code><span class="deltaxml-new" style="background:#90EE90">$octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> option specifies otherwise.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Acceptable values for </span><code><span class="deltaxml-new" style="background:#90EE90">$octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> are described in </span><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a><span class="deltaxml-new" style="background:#90EE90">. If least-significant-first ordering is requested then the order of octets in the input is reversed.</span></p><p>The values of <code>$offset</code> and <code>$size</code><span class="verb">must</span> be non-negative integers.</p><p><span style="display: none;" class="delete_version">The <code>$offset</code> is zero based.</span><span style="display: none;" class="add_version"><code>$offset</code> is zero based.</span><span class="modify_version"><span class="deltaxml-old" style="background:#FF5555">The </span><code>$offset</code> is zero based.</span></p><p>Specifying a <code>$size</code> of zero yields the integer <code>0</code>.</p></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40index-out-of-range" title="bin:index-out-of-range">bin:index-out-of-range</a>] is raised if <code>$offset</code> is negative or <code>$offset + $size</code> is larger than the size of the binary data of <code>$in</code>.</p><p>[<a href="#ERRBIN40negative-size" title="bin:negative-size">bin:negative-size</a>] is raised if <code>$size</code> is negative.</p><p><span class="deltaxml-old" style="background:#FF5555">[</span><a href="#ERRBIN40unknown-significance-order" title="bin:unknown-significance-order"><span class="deltaxml-old" style="background:#FF5555">bin:unknown-significance-order</span></a><span class="deltaxml-old" style="background:#FF5555">] is raised if the value </span><code><span class="deltaxml-old" style="background:#FF5555">$octet-order</span></code><span class="deltaxml-old" style="background:#FF5555"> is unrecognized.</span></p></dd><dt class="label">Notes</dt><dd><p class="note"><span class="deltaxml-old" style="background:#FF5555">For discussion on integer range see </span><a href="#integer"><b><span class="deltaxml-old" style="background:#FF5555">7.1.2 Integer representation</span></b></a><span class="deltaxml-old" style="background:#FF5555">.</span></p><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">For discussion on integer range see </span><a href="#integer"><b><span class="deltaxml-new" style="background:#90EE90">7.1.2 Integer representation</span></b></a><span class="deltaxml-new" style="background:#90EE90">.</span></p></div></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Examples</span></dt><dd><div class="example"><table class="medium"><thead><tr><th><span class="deltaxml-new" style="background:#90EE90">Expression</span></th><th><span class="deltaxml-new" style="background:#90EE90">Result</span></th></tr></thead><tbody><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-unsigned-integer(bin:hex('0100'), 0, 2)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">256</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-unsigned-integer(bin:hex('00000100'), 0, 4)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">256</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-unsigned-integer(bin:hex('FFFF'), 0, 2)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">65535</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-unsigned-integer(bin:hex('00FFFFFFFF'), 1, 4)</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">4294967295</span></pre></div></td></tr><tr><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><code><span class="deltaxml-new" style="background:#90EE90">bin:unpack-integer(bin:hex('FEFF'), 0, 2, "LE")</span></code></pre></div></td><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve"><span class="deltaxml-new" style="background:#90EE90">65279</span></pre></div></td></tr></tbody></table></div></dd></dl></div></div><div class="div1"><h2><a id="bitwise"></a>8 <a href="#bitwise" style="text-decoration: none">Bitwise operations</a></h2><div class="div2"><h3><a id="func-bin-or"></a>8.1 <a href="#func-bin-or" style="text-decoration: none">bin:or</a></h3><dl><dt class="label">Summary</dt><dd><p>Returns the <span class="deltaxml-old" style="background:#FF5555">"bitwise or"</span><span class="deltaxml-new" style="background:#90EE90">bitwise OR</span> of two binary <span class="deltaxml-old" style="background:#FF5555">arguments</span><span class="deltaxml-new" style="background:#90EE90">values</span>.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:or</code>(</td></tr><tr class="arg"><td><code>$a</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$b</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns "bitwise or" applied between </span><code><span class="deltaxml-old" style="background:#FF5555">$a</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code><span class="deltaxml-old" style="background:#FF5555">$b</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p>If either argument is the empty sequence, an empty sequence is returned.</p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, </span><code><span class="deltaxml-new" style="background:#90EE90">$a</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">$b</span></code><span class="deltaxml-new" style="background:#90EE90"> must have the same length.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The function converts </span><code><span class="deltaxml-new" style="background:#90EE90">$a</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">$b</span></code><span class="deltaxml-new" style="background:#90EE90"> to sequences of bits </span><var><span class="deltaxml-new" style="background:#90EE90">A</span></var><span class="deltaxml-new" style="background:#90EE90"> and </span><var><span class="deltaxml-new" style="background:#90EE90">B</span></var><span class="deltaxml-new" style="background:#90EE90">, and returns a binary value in which the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit is set to 1 if either or both of the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit of </span><var><span class="deltaxml-new" style="background:#90EE90">A</span></var><span class="deltaxml-new" style="background:#90EE90"> and the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit of </span><var><span class="deltaxml-new" style="background:#90EE90">B</span></var><span class="deltaxml-new" style="background:#90EE90"> are 1, and is set to 0 otherwise.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">let $toBin := fn($x) { bin:to-octets($x) 
                        =!&gt; format-integer('2^xxxxxxxx') 
                        =&gt; string-join() } 
let $A := $toBin($a) =&gt; characters(),
    $B := $toBin($b) =&gt; characters()
       
let $R := for-each-pair($A, $B, fn($p, $q) { if ($p eq '1' or $q eq '1')
                                             then '1' else '0 } )
return bin:bin($R)</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40differing-length-arguments" title="bin:differing-length-arguments">bin:differing-length-arguments</a>] is raised if the input arguments are of differing length.</p></dd></dl></div><div class="div2"><h3><a id="func-bin-xor"></a>8.2 <a href="#func-bin-xor" style="text-decoration: none">bin:xor</a></h3><dl><dt class="label">Summary</dt><dd><p>Returns the <span class="deltaxml-old" style="background:#FF5555">"bitwise xor"</span><span class="deltaxml-new" style="background:#90EE90">bitwise exclusive-OR</span> of two binary arguments.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:xor</code>(</td></tr><tr class="arg"><td><code>$a</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$b</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns "bitwise exclusive or" applied between </span><code><span class="deltaxml-old" style="background:#FF5555">$a</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code><span class="deltaxml-old" style="background:#FF5555">$b</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p>If either argument is the empty sequence, an empty sequence is returned.</p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, </span><code><span class="deltaxml-new" style="background:#90EE90">$a</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">$b</span></code><span class="deltaxml-new" style="background:#90EE90"> must have the same length.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The function converts </span><code><span class="deltaxml-new" style="background:#90EE90">$a</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">$b</span></code><span class="deltaxml-new" style="background:#90EE90"> to sequences of bits </span><var><span class="deltaxml-new" style="background:#90EE90">A</span></var><span class="deltaxml-new" style="background:#90EE90"> and </span><var><span class="deltaxml-new" style="background:#90EE90">B</span></var><span class="deltaxml-new" style="background:#90EE90">, and returns a binary value in which the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit is set to 1 if the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit of </span><var><span class="deltaxml-new" style="background:#90EE90">A</span></var><span class="deltaxml-new" style="background:#90EE90"> differs from the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit of </span><var><span class="deltaxml-new" style="background:#90EE90">B</span></var><span class="deltaxml-new" style="background:#90EE90">, and is set to 0 if they are the same.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">let $toBin := fn($x) { bin:to-octets($x) 
                        =!&gt; format-integer('2^xxxxxxxx') 
                        =&gt; string-join() } 
let $A := $toBin($a) =&gt; characters(),
    $B := $toBin($b) =&gt; characters()
       
let $R := for-each-pair($A, $B, fn($p, $q) { if ($p ne $q)
                                             then '1' else '0' } )
return bin:bin($R)</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40differing-length-arguments" title="bin:differing-length-arguments">bin:differing-length-arguments</a>] is raised if the input arguments are of differing length.</p></dd></dl></div><div class="div2"><h3><a id="func-bin-and"></a>8.3 <a href="#func-bin-and" style="text-decoration: none">bin:and</a></h3><dl><dt class="label">Summary</dt><dd><p>Returns the <span class="deltaxml-old" style="background:#FF5555">"bitwise and"</span><span class="deltaxml-new" style="background:#90EE90">bitwise AND</span> of two binary arguments.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:and</code>(</td></tr><tr class="arg"><td><code>$a</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$b</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Returns "bitwise and" applied between </span><code><span class="deltaxml-old" style="background:#FF5555">$a</span></code><span class="deltaxml-old" style="background:#FF5555"> and </span><code><span class="deltaxml-old" style="background:#FF5555">$b</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p>If either argument is the empty sequence, an empty sequence is returned.</p><p><span class="deltaxml-new" style="background:#90EE90">Otherwise, </span><code><span class="deltaxml-new" style="background:#90EE90">$a</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">$b</span></code><span class="deltaxml-new" style="background:#90EE90"> must have the same length.</span></p><p><span class="deltaxml-new" style="background:#90EE90">The function converts </span><code><span class="deltaxml-new" style="background:#90EE90">$a</span></code><span class="deltaxml-new" style="background:#90EE90"> and </span><code><span class="deltaxml-new" style="background:#90EE90">$b</span></code><span class="deltaxml-new" style="background:#90EE90"> to sequences of bits </span><var><span class="deltaxml-new" style="background:#90EE90">A</span></var><span class="deltaxml-new" style="background:#90EE90"> and </span><var><span class="deltaxml-new" style="background:#90EE90">B</span></var><span class="deltaxml-new" style="background:#90EE90">, and returns a binary value in which the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit is set to 1 if both the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit of </span><var><span class="deltaxml-new" style="background:#90EE90">A</span></var><span class="deltaxml-new" style="background:#90EE90"> and the </span><var><span class="deltaxml-new" style="background:#90EE90">N</span></var><span class="deltaxml-new" style="background:#90EE90">th bit of </span><var><span class="deltaxml-new" style="background:#90EE90">B</span></var><span class="deltaxml-new" style="background:#90EE90"> are 1, and is set to 0 otherwise.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">let $toBin := fn($x) { bin:to-octets($x) 
                        =!&gt; format-integer('2^xxxxxxxx') 
                        =&gt; string-join() } 
let $A := $toBin($a) =&gt; characters(),
    $B := $toBin($b) =&gt; characters()
       
let $R := for-each-pair($A, $B, fn($p, $q) { if ($p eq '1' and $q eq '1')
                                             then '1' else '0 } )
return bin:bin($R)</span></pre></div></dd><dt class="label">Error Conditions</dt><dd><p>[<a href="#ERRBIN40differing-length-arguments" title="bin:differing-length-arguments">bin:differing-length-arguments</a>] is raised if the input arguments are of differing length.</p></dd></dl></div><div class="div2"><h3><a id="func-bin-not"></a>8.4 <a href="#func-bin-not" style="text-decoration: none">bin:not</a></h3><dl><dt class="label">Summary</dt><dd><p>Returns the "bitwise not" of a binary argument.</p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:not</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p>Returns "bitwise not" applied to <code>$in</code>.</p><p>If the argument is the empty sequence, an empty sequence is returned.</p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">let $toBin := fn($x) { bin:to-octets($x) 
                           =!&gt; format-integer('2^xxxxxxxx') 
                           =&gt; string-join() } 
   return $toBin($in) 
          =&gt; translate('01', '10') 
          =&gt; bin:bin()</span></pre></div></dd></dl></div><div class="div2"><h3><a id="func-bin-shift"></a>8.5 <a href="#func-bin-shift" style="text-decoration: none">bin:shift</a></h3><dl><dt class="label">Summary</dt><dd><p><span class="deltaxml-old" style="background:#FF5555">Shift bits in binary data.</span></p><p><span class="deltaxml-new" style="background:#90EE90">Shift the bits of a binary value left or right.</span></p></dd><dt class="label">Signature</dt><dd><div class="proto"><table class="proto" border="0"><tbody><tr class="name"><td colspan="3"><code class="function">bin:shift</code>(</td></tr><tr class="arg"><td><code>$in</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>(xs:hexBinary | xs:base64Binary)?</code></code>,</td><td></td></tr><tr class="arg"><td><code>$by</code></td><td><code class="as">as&nbsp;</code><code class="type"><code>xs:integer</code></code></td><td></td></tr><tr class="return-type"><td colspan="3">)<code class="as">&nbsp;as&nbsp;</code><code><code>xs:base64Binary?</code></code></td></tr></tbody></table></div></dd><dt class="label">Properties</dt><dd><p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-deterministic">deterministic</a><sup><small>FO</small></sup>, <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-context-independent">context-independent</a><sup><small>FO</small></sup>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/#dt-focus-independent">focus-independent</a><sup><small>FO</small></sup>. </p></dd><dt class="label">Rules</dt><dd><p><span class="deltaxml-new" style="background:#90EE90">If the value of </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90"> is the empty sequence, the function returns an empty sequence.</span></p><p><span class="deltaxml-new" style="background:#90EE90">In other cases the length of the result is always the same as the length of </span><code><span class="deltaxml-new" style="background:#90EE90">$in</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p><p><span style="display: none;" class="delete_version">If <code>$by</code> is positive then bits are shifted <code>$by</code> times to the left.</span><span style="display: none;" class="add_version">If <code>$by</code> is positive then bits are shifted <code>$by</code> times to the left. The first <code>$by</code> bits are discarded, and <code>$by</code> zero bits are injected at the end.</span><span class="modify_version">If <code>$by</code> is positive then bits are shifted <code>$by</code> times to the left.<span class="deltaxml-new" style="background:#90EE90"> The first </span><code><span class="deltaxml-new" style="background:#90EE90">$by</span></code><span class="deltaxml-new" style="background:#90EE90"> bits are discarded, and </span><code><span class="deltaxml-new" style="background:#90EE90">$by</span></code><span class="deltaxml-new" style="background:#90EE90"> zero bits are injected at the end.</span></span></p><p><span style="display: none;" class="delete_version">If <code>$by</code> is negative then bits are shifted <code>-$by</code> times to the right.</span><span style="display: none;" class="add_version">If <code>$by</code> is negative then bits are shifted <code>-$by</code> times to the right. The last <code>-$by</code> bits are discarded, and <code>-$by</code> zero bits are injected at the start.</span><span class="modify_version">If <code>$by</code> is negative then bits are shifted <code>-$by</code> times to the right.<span class="deltaxml-new" style="background:#90EE90"> The last </span><code><span class="deltaxml-new" style="background:#90EE90">-$by</span></code><span class="deltaxml-new" style="background:#90EE90"> bits are discarded, and </span><code><span class="deltaxml-new" style="background:#90EE90">-$by</span></code><span class="deltaxml-new" style="background:#90EE90"> zero bits are injected at the start.</span></span></p><p>If <code>$by</code> is zero, the result is identical to <code>$in</code>.</p><p><span style="display: none;" class="delete_version">If <code>|$by|</code> is greater than the bit-length of <code>$in</code> then an all-zeros result, of the same length as <code>$in</code>, is returned.</span><span style="display: none;" class="add_version">If <code>abs($by)</code> is greater than the bit-length of <code>$in</code> then an all-zeros result, of the same length as <code>$in</code>, is returned.</span><span class="modify_version">If <code><span class="deltaxml-old" style="background:#FF5555">|</span><span class="deltaxml-new" style="background:#90EE90">abs(</span>$by<span class="deltaxml-old" style="background:#FF5555">|</span><span class="deltaxml-new" style="background:#90EE90">)</span></code> is greater than the bit-length of <code>$in</code> then an all-zeros result, of the same length as <code>$in</code>, is returned.</span></p><p><span style="display: none;" class="delete_version"><code>|$by|</code> can be greater than 8, implying multi-byte shifts.</span><span style="display: none;" class="add_version"><code>abs($by)</code> can be greater than 8, implying multi-byte shifts.</span><span class="modify_version"><code><span class="deltaxml-old" style="background:#FF5555">|</span><span class="deltaxml-new" style="background:#90EE90">abs(</span>$by<span class="deltaxml-old" style="background:#FF5555">|</span><span class="deltaxml-new" style="background:#90EE90">)</span></code> can be greater than 8, implying multi-byte shifts.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The result always has the same size as </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555">.</span></p><p><span class="deltaxml-old" style="background:#FF5555">The shifting is logical: zeros are placed into discarded bits.</span></p><p><span class="deltaxml-old" style="background:#FF5555">If the value of </span><code><span class="deltaxml-old" style="background:#FF5555">$in</span></code><span class="deltaxml-old" style="background:#FF5555"> is the empty sequence, the function returns an empty sequence.</span></p></dd><dt class="label"><span class="deltaxml-new" style="background:#90EE90">Formal Equivalent</span></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The effect of the function is equivalent to the result of the following XPath expression, except in error cases.</span></p><div class="exampleInner"><pre xml:space="preserve" class="small"><span class="deltaxml-new" style="background:#90EE90">(: convert to a string of 1s and 0s :)
   let $s := bin:to-octets($in) 
             =!&gt; format-integer('2^xxxxxxxx') 
             =&gt; string-join()
   
   (: the length of the input in bits :)          
   let $len := string-length($s)
   
   (: a string of zeros equal in length to the size of the shift :)
   let $padding := string-join((1 to abs($by)) ! '0')
   
   (: the binary value as a string, padded left and right :)
   let $padded-string := $padding || $s || $padding
   
   (: the relevant substring of the padded string :)
   let $shifted := substring($padded-string, $len - $by, $len)
   
   (: the result of converting back to a binary value :)
   return bin:bin($shifted)</span></pre></div></dd><dt class="label">Notes</dt><dd><p class="note"><span class="deltaxml-old" style="background:#FF5555">Bit shifting across byte boundaries implies 'big-endian' treatment, i.e. the leftmost (high-order) bit when shifted left becomes the low-order bit of the preceding byte.</span></p><div class="note"><p><span class="deltaxml-new" style="background:#90EE90">Bit shifting across byte boundaries implies 'big-endian' treatment, i.e. the leftmost (high-order) bit when shifted left becomes the low-order bit of the preceding byte.</span></p></div></dd><dt class="label">Examples</dt><dd><div class="example"><table class="medium"><tbody><tr class="testdiv"><th style="vertical-align:top">Expression:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:shift(bin:hex("000001"), 17)</pre></div></td></tr><tr><th style="vertical-align:top">Result:</th><td style="vertical-align:top"><div class="exampleInner"><pre xml:space="preserve">bin:hex("020000")</pre></div></td></tr></tbody></table></div></dd></dl></div></div></div><div class="back"><div class="div1"><h2><a id="biblio"></a>A <a href="#biblio" style="text-decoration: none">References</a></h2><div class="div2"><h3><a id="normative-biblio"></a>A.1 <a href="#normative-biblio" style="text-decoration: none">Normative references</a></h3><dl><dt class="label"><span><a id="expath-bin"></a>EXPath Binary 1.0</span></dt><dd><div><a href="http://expath.org/spec/binary">Binary Module 1.0</a>. Jirka Kosek and John Lumley, editors. EXPath Module. 3 December 2013.</div></dd><dt class="label"><span style="display: none;" class="delete_version"><span><a id="expath-file"></a>EXPath File 1.0</span></span><span style="display: none;" class="add_version"><span><a id="expath-file-40"></a>EXPath File 4.0</span></span><span class="modify_version"><span><a id="expath-file"></a><a id="expath-file-40"></a>EXPath File <span class="deltaxml-old" style="background:#FF5555">1.0</span><span class="deltaxml-new" style="background:#90EE90">4.0</span></span></span></dt><dd><div><a href="http://expath.org/spec/file"><span class="deltaxml-old" style="background:#FF5555">File Module 1.0</span></a><span class="deltaxml-old" style="background:#FF5555">. Christian Grün, Matthias Brantner and Gabriel Petrovay, editors. EXPath Module 20 February 2015.</span></div></dd><dt class="label"><span><a id="expath-file-40"></a><span class="deltaxml-old" style="background:#FF5555">EXPath File 4.0</span></span></dt><dd><div><a href="https://qt4cg.org/specifications/EXPath/file-40/Overview.html"><cite>EXPath File Module 4.0</cite></a>, Christian Grün, Matthias Brantner and Gabriel Petrovay, editors. XSLT Extensions Community Group, World Wide Web Consortium.</div></dd><dt class="label"><span><a id="ieee754"></a>IEEE 754-1985</span></dt><dd><div>IEEE Standard for Binary Floating-Point Arithmetic. See <a href="http://standards.ieee.org/reading/ieee/std_public/description/busarch/754-1985_desc.html">http://standards.ieee.org/reading/ieee/std_public/description/busarch/754-1985_desc.html</a></div></dd><dt class="label"><span><a id="ieee754-2019"></a>IEEE 754-2019</span></dt><dd><div>IEEE. <em>IEEE Standard for Floating-Point Arithmetic.</em></div></dd><dt class="label"><span><a id="xpath20"></a>XML Path Language (XPath) 2.0</span></dt><dd><div><a href="https://www.w3.org/TR/xpath20/"><cite>XML Path Language (XPath) 2.0 (Second Edition)</cite></a>, Don Chamberlin, Anders Berglund, Scott Boag, <em>et. al.</em>, Editors. World Wide Web Consortium, 14 December 2010. This version is https://www.w3.org/TR/2010/REC-xpath20-20101214/. The <a href="https://www.w3.org/TR/xpath20/">latest version</a> is available at https://www.w3.org/TR/xpath20/.</div></dd><dt class="label"><span><a id="xpath-functions-40"></a>XQuery and XPath Functions and Operators 4.0</span></dt><dd><div><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html"><cite>XQuery and XPath Functions and Operators 4.0</cite></a>, XSLT Extensions Community Group, World Wide Web Consortium.</div></dd><dt class="label"><span><a id="xpath-40"></a>XML Path Language (XPath) 4.0</span></dt><dd><div></div></dd><dt class="label"><span><a id="xslt-40"></a>XSL Transformations (XSLT) Version 4.0</span></dt><dd><div><em>CITATION: T.B.D.</em></div></dd><dt class="label"><span><a id="xpath-datamodel-40"></a>XQuery and XPath Data Model (XDM) 4.0</span></dt><dd><div><a href="https://qt4cg.org/specifications/xpath-datamodel-40/Overview.html"><cite>XQuery and XPath Data Model (XDM) 4.0</cite></a>, XSLT Extensions Community Group, World Wide Web Consortium.</div></dd><dt class="label"><span style="display: none;" class="delete_version"><span><a id="xquery-40"></a>XQuery 4.1: An XML Query Language</span></span><span style="display: none;" class="add_version"><span><a id="xquery-40"></a>XQuery 4.0: An XML Query Language</span></span><span class="modify_version"><span><a id="xquery-40"></a>XQuery <span class="deltaxml-old" style="background:#FF5555">4.1</span><span class="deltaxml-new" style="background:#90EE90">4.0</span>: An XML Query Language</span></span></dt><dd><div><em>CITATION: T.B.D.</em></div></dd><dt class="label"><span><a id="xmlschema-2"></a>XML Schema Part 2: Datatypes Second Edition</span></dt><dd><div> XML Schema Part 2: Datatypes Second Edition, Oct. 28 2004. Available at: <a href="http://www.w3.org/TR/xmlschema-2/">http://www.w3.org/TR/xmlschema-2/</a></div></dd></dl></div><div class="div2"><h3><a id="non-normative-biblio"></a>A.2 <a href="#non-normative-biblio" style="text-decoration: none">Non-normative references</a></h3><dl><dt class="label"><span><a id="asn1"></a>ASN.1</span></dt><dd><div> OSI networking and system aspects – Abstract Syntax Notation One (ASN.1) – see <a href="http://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf">ASN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER) </a>. ITU-T X.690 (07/2002) </div></dd><dt class="label"><span><a id="tests.binary"></a>Test-suite</span></dt><dd><div>The test suite for this module, using QT3 format, is in the EXPath repository <a href="http://github.com/expath/expath-cg/tree/master/tests/qt3/binary">http://github.com/expath/expath-cg</a> in the directory tests/qt3/binary/</div></dd><dt class="label"><span><a id="qt3"></a>QT3</span></dt><dd><div><a href="http://dev.w3.org/2011/QT3-test-suite/">XML Query Test Suite</a>. W3C 21 June 2013. </div></dd><dt class="label"><span><a id="expath"></a>EXPath</span></dt><dd><div>EXPath: Collaboratively Defining Open Standards for Portable XPath Extensions. <a href="http://expath.org/">http://expath.org/</a>.</div></dd></dl></div></div><div class="div1"><h2><a id="error-summary"></a>B <a href="#error-summary" style="text-decoration: none">Error summary</a></h2><p>The error text provided with these errors is non-normative.</p><dl><dt><a name="ERRBIN40conversion-error"></a>bin:conversion-error</dt><dd><p>Error in converting to/from a string.</p></dd><dt><a name="ERRBIN40differing-length-arguments"></a>bin:differing-length-arguments, Arguments of different length</dt><dd><p>The two arguments to a bitwise operation are of differing lengths.</p></dd><dt><a name="ERRBIN40index-out-of-range"></a>bin:index-out-of-range</dt><dd><p>Attempting to retrieve data outside the meaningful range of a binary data type.</p></dd><dt><a name="ERRBIN40negative-size"></a>bin:negative-size</dt><dd><p>Size of binary portion, required numeric size or padding is negative.</p></dd><dt><a name="ERRBIN40non-numeric-character"></a>bin:non-numeric-character</dt><dd><p>Wrong character in binary 'numeric constructor' string.</p></dd><dt><a name="ERRBIN40octet-out-of-range"></a>bin:octet-out-of-range</dt><dd><p>Attempting to pack binary value with octet outside range 0-255.</p></dd><dt><span class="deltaxml-new" style="background:#90EE90">err:FOoctet-out-of-range</span></dt><dd><span class="deltaxml-new" style="background:#90EE90">(Error code unused?)</span></dd><dt><a name="ERRBIN40unknown-encoding"></a>bin:unknown-encoding</dt><dd><p>The specified encoding is not supported.</p></dd><dt><a name="ERRBIN40unknown-significance-order"></a>bin:unknown-significance-order</dt><dd><p>Unknown octet-order value.</p></dd><dt><span class="deltaxml-new" style="background:#90EE90">err:FOunknown-significance-order</span></dt><dd><span class="deltaxml-new" style="background:#90EE90">(Error code unused?)</span></dd></dl></div><div class="div1"><h2><a id="glossary"></a>C <a href="#glossary" style="text-decoration: none">Glossary</a> (Non-Normative)</h2><dl><dt><a href="#dt-binary-value"><span class="deltaxml-new" style="background:#90EE90">binary value</span></a></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">The term </span><b><span class="deltaxml-new" style="background:#90EE90">binary value</span></b><span class="deltaxml-new" style="background:#90EE90"> is used to mean a sequence of octets represented as an instance of </span><code><span class="deltaxml-new" style="background:#90EE90">xs:base64Binary</span></code><span class="deltaxml-new" style="background:#90EE90"> or </span><code><span class="deltaxml-new" style="background:#90EE90">xs:hexBinary</span></code><span class="deltaxml-new" style="background:#90EE90">.</span></p></dd><dt><a href="#dt-zero-length"><span class="deltaxml-new" style="background:#90EE90">zero-length</span></a></dt><dd><p><span class="deltaxml-new" style="background:#90EE90">A </span><a title="binary value" class="termref" href="#dt-binary-value"><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span><span class="deltaxml-new" style="background:#90EE90">binary value</span><span class="arrow"><span class="deltaxml-new" style="background:#90EE90">·</span></span></a><span class="deltaxml-new" style="background:#90EE90"> that contains no octets is referred to as being </span><b><span class="deltaxml-new" style="background:#90EE90">zero-length</span></b><span class="deltaxml-new" style="background:#90EE90">. A zero-length binary value is an item, and as such is a sequence of length one, which is not the same thing as an empty sequence.</span></p></dd></dl></div><div class="div1"><h2><a id="other-functions"></a>D <a href="#other-functions" style="text-decoration: none">Other Functions</a> (Non-Normative)</h2><p>This Appendix describes some sources of functions or operators that fall outside the scope of the function library defined in this specification. It includes both function specifications and function implementations. Inclusion of a function in this appendix does not constitute any kind of recommendation or endorsement; neither is omission from this appendix to be construed negatively. This Appendix does not attempt to give any information about licensing arrangements for these function specifications or implementations.</p><div class="div2"><h3><a id="functions-in-other-w3c-specs"></a>D.1 <a href="#functions-in-other-w3c-specs" style="text-decoration: none">XPath Functions and Operators Defined in Other W3C Recommendations</a></h3><p>A number of W3C Recommendations make use of XPath, and in some cases such Recommmendations define additional functions to be made available when XPath is used in a specific host language.</p><div class="div3"><h4><a id="functions-defined-in-XPathFO"></a>D.1.1 <a href="#functions-defined-in-XPathFO" style="text-decoration: none">Functions and Operators Defined in XPath and XQuery Functions and Operators</a></h4><p>Of particular interest to this specification, <a href="#xpath-functions-40">[XQuery and XPath Functions and Operators 4.0]</a> defines</p><ul><li><p>Comparison operators on <code>xs:hexBinary</code> and <code>xs:base64Binary</code> values, defining the semantics of the <code>eq</code>, <code>ne</code>, <code>lt</code> and <code>ge</code> operators applied to binary data. Each returns a boolean value.</p></li><li><p>A function to retrieve the value of a binary resource</p></li></ul><p></p><table class="data"><thead><tr><th>Function name</th><th>Availability</th><th>Notes</th></tr></thead><tbody><tr><td><a href="https://qt4cg.org/specifications/xpath-functions-40/#func-binary-equal">Section 11.1.1 op:binary-equal</a><sup><small>FO</small></sup></td><td>XPath4.0+</td><td>Returns <code>true</code> if both binary values contain the same octet sequence.</td></tr><tr><td><a href="https://qt4cg.org/specifications/xpath-functions-40/#func-binary-less-than">Section 11.1.2 op:binary-less-than</a><sup><small>FO</small></sup></td><td>XPath4.0+</td><td>Returns <code>true</code> if the first argument is less than the second.</td></tr><tr><td><span class="markup-error">[TITLE OF FO40 SPEC, TITLE OF func-binary-resource SECTION]<sup><small>FO40</small></sup></span></td><td>XPath4.0+</td><td>Returns a resource as <code>xs:base64Binary</code>.</td></tr></tbody></table></div></div><div class="div2"><h3><a id="functions-defined-by-community-groups"></a>D.2 <a href="#functions-defined-by-community-groups" style="text-decoration: none">Functions Defined by Community Groups</a></h3><div class="div3"><h4><a id="functions-defined-in-EXPathFile"></a>D.2.1 <a href="#functions-defined-in-EXPathFile" style="text-decoration: none">Functions Defined in EXPath File</a></h4><p>Of particular interest to this specification, <a href="#expath-file-40">[EXPath File 4.0]</a> defines the following functions for input and output of <code>xs:base64Binary</code> values:</p><table class="data"><thead><tr><th>Function name</th><th>Availability</th><th>Notes</th></tr></thead><tbody><tr><td><a href="https://qt4cg.org/specifications/EXPath/file-40/#func-file-read-binary">Section 4.5 file:read-binary</a><sup><small>FILE</small></sup></td><td>XPath4.0+</td><td>Returns the content of a file in its Base64 representation.</td></tr><tr><td><a href="https://qt4cg.org/specifications/EXPath/file-40/#func-file-write-binary">Section 4.9 file:write-binary</a><sup><small>FILE</small></sup></td><td>XPath4.0+</td><td>Writes a Base64 item as binary data to a file.</td></tr><tr><td><a href="https://qt4cg.org/specifications/EXPath/file-40/#func-file-append-binary">Section 4.2 file:append-binary</a><sup><small>FILE</small></sup></td><td>XPath4.0+</td><td>Appends a Base64 item as binary data to a file.</td></tr></tbody></table></div></div></div><div class="div1"><h2><a id="impl-def"></a>E <a href="#impl-def" style="text-decoration: none">Checklist of implementation-defined features</a> (Non-Normative)</h2><ol></ol></div><div class="div1"><h2><a id="changelog"></a>F <a href="#changelog" style="text-decoration: none">Changes since version 1.0</a> (Non-Normative)</h2><div class="div2"><h3><a id="changes-summary"></a>F.1 <a href="#changes-summary" style="text-decoration: none">Summary of Changes</a></h3><ol><li><p>Use the arrows to browse significant changes since the 1.0 version of this specification.</p><p>See <a href="#intro"><b>1 Introduction</b></a></p></li><li><p>Sections with significant changes are marked Δ in the table of contents. New functions introduced in this version are marked ➕ in the table of contents.</p><p>See <a href="#intro"><b>1 Introduction</b></a></p></li><li><p><span style="display: none;" class="delete_version">Binary 'data' arguments to the functions are now declared to be either <code>xs:hexBinary</code> or <code>xs:base64Binary</code>, but binary function results remain of type <code>xs:base64Binary</code>. This should not cause any backward incompatibilities as casting back and forth between the two representations has been possible since at least version 2.0</span><span style="display: none;" class="add_version">Binary arguments to the functions are now declared to be either <code>xs:hexBinary</code> or <code>xs:base64Binary</code>, but binary function results remain of type <code>xs:base64Binary</code>. This should not cause any backward incompatibilities as casting back and forth between the two representations has been possible since at least version 2.0</span><span class="modify_version">Binary <span class="deltaxml-old" style="background:#FF5555">'data' </span>arguments to the functions are now declared to be either <code>xs:hexBinary</code> or <code>xs:base64Binary</code>, but binary function results remain of type <code>xs:base64Binary</code>. This should not cause any backward incompatibilities as casting back and forth between the two representations has been possible since at least version 2.0</span></p><p>See <a href="#type"><span style="display: none;" class="delete_version"><b>1.2 Binary type</b></span><span style="display: none;" class="add_version"><b>1.2 Binary types</b></span><span class="modify_version"><b>1.2 Binary <span class="deltaxml-old" style="background:#FF5555">type</span><span class="deltaxml-new" style="background:#90EE90">types</span></b></span></a></p></li><li><p>The functions in this example have been moved into a differing namespace prefix (<code>asn:</code>) to avoid suggesting that they are part of the supported function set.</p><p>See <a href="#example-ASN1"><b>2.2 Example – reading and writing variable length ASN.1 integers</b></a></p></li><li><p>The <a href="#xpath-functions-40">[XQuery and XPath Functions and Operators 4.0]</a> function <code>fn:binary-resource</code> has been added to the list of useful functions.</p><p>See <a href="#loading"><span style="display: none;" class="delete_version"><b>3 Loading and saving binary data</b></span><span style="display: none;" class="add_version"><b>3.4 Loading and saving binary data</b></span><span class="modify_version"><b><span class="deltaxml-old" style="background:#FF5555">3</span><span class="deltaxml-new" style="background:#90EE90">3.4</span> Loading and saving binary data</b></span></a></p></li><li class="add_version" style="display: none;"><p>The result type is changed from <code>xs:integer</code> to <code>xs:unsignedByte</code>. This is made possible by the more liberal coercion rules defined in XPath 4.0.</p><p>See <a href="#func-bin-to-octets"><b>4.4 bin:to-octets</b></a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">The result type is changed from </span><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90">. This is made possible by the more liberal coercion rules defined in XPath 4.0.</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-bin-to-octets"><b><span class="deltaxml-new" style="background:#90EE90">4.4 bin:to-octets</span></b></a></p></li><li class="add_version" style="display: none;"><p>The argument type is changed from <code>xs:integer</code> to <code>xs:unsignedByte</code>. This is made possible by the more liberal coercion rules defined in XPath 4.0. A consequence of the change is that supplying an out-of-range integer value is now a type error with the standard error code <code>XPTY0004</code>, rather than the custom error code <code>bin:octet-out-of-range</code> previously used.</p><p>See <a href="#func-bin-from-octets"><b>4.5 bin:from-octets</b></a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">The argument type is changed from </span><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90">. This is made possible by the more liberal coercion rules defined in XPath 4.0. A consequence of the change is that supplying an out-of-range integer value is now a type error with the standard error code </span><code><span class="deltaxml-new" style="background:#90EE90">XPTY0004</span></code><span class="deltaxml-new" style="background:#90EE90">, rather than the custom error code </span><code><span class="deltaxml-new" style="background:#90EE90">bin:octet-out-of-range</span></code><span class="deltaxml-new" style="background:#90EE90"> previously used.</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-bin-from-octets"><b><span class="deltaxml-new" style="background:#90EE90">4.5 bin:from-octets</span></b></a></p></li><li><p>The function <code>find-all</code> in the example for <a href="#func-bin-find"><code>bin:find</code></a> has been moved into a differing namespace prefix (<code>f:</code>) to avoid suggesting that it is part of the supported function set.</p><p>See <a href="#basic-operations"><b>5 Basic operations</b></a></p></li><li class="add_version" style="display: none;"><p> The <code>octet-order</code> parameter of relevant functions now has an <code>enum</code> type rather than a string type. In consequence, supplying an incorrect value is now a type error ([<a href="https://www.w3.org/TR/xpath20/#ERRXPTY0004" title="bin:TY0004">bin:TY0004</a>]<sup><small>XP</small></sup>) and no longer has a custom error code. </p><p>See <a href="#endianness"><b>7.1.1 Octet order</b></a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90"> The </span><code><span class="deltaxml-new" style="background:#90EE90">octet-order</span></code><span class="deltaxml-new" style="background:#90EE90"> parameter of relevant functions now has an </span><code><span class="deltaxml-new" style="background:#90EE90">enum</span></code><span class="deltaxml-new" style="background:#90EE90"> type rather than a string type. In consequence, supplying an incorrect value is now a type error ([</span><a href="https://www.w3.org/TR/xpath20/#ERRXPTY0004" title="bin:TY0004"><span class="deltaxml-new" style="background:#90EE90">bin:TY0004</span></a><span class="deltaxml-new" style="background:#90EE90">]</span><sup><small><span class="deltaxml-new" style="background:#90EE90">XP</span></small></sup><span class="deltaxml-new" style="background:#90EE90">) and no longer has a custom error code. </span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#endianness"><b><span class="deltaxml-new" style="background:#90EE90">7.1.1 Octet order</span></b></a></p></li><li class="add_version" style="display: none;"><p>PR <a href="https://github.com/qt4cg/qtspecs/pull/1753">1753&nbsp;</a></p><p>The input string is now allowed to include embedded underscores and whitespace.</p><p>See <a href="#func-bin-hex"><b>4.1 bin:hex</b></a></p><p>See <a href="#func-bin-binary"><b>4.2 bin:bin</b></a></p><p>See <a href="#func-bin-octal"><b>4.3 bin:octal</b></a></p><p>The way in which the value is adjusted to a whole number of octets has been clarified. The rules have been made more precise, and might not match the interpretation adopted by existing implementations.</p><p>See <a href="#func-bin-octal"><b>4.3 bin:octal</b></a></p><p>The argument type for <code>$octet</code> is changed from <code>xs:integer</code> to <code>xs:unsignedByte</code>. This is made possible by the more liberal coercion rules defined in XPath 4.0. A consequence of the change is that supplying an out-of-range integer value is now a type error with the standard error code <code>XPTY0004</code>, rather than the custom error code <code>bin:octet-out-of-range</code> previously used.</p><p>See <a href="#func-bin-pad-left"><b>5.5 bin:pad-left</b></a></p><p>See <a href="#func-bin-pad-right"><b>5.6 bin:pad-right</b></a></p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">PR </span><a href="https://github.com/qt4cg/qtspecs/pull/1753"><span class="deltaxml-new" style="background:#90EE90">1753&nbsp;</span></a></p><p><span class="deltaxml-new" style="background:#90EE90">The input string is now allowed to include embedded underscores and whitespace.</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-bin-hex"><b><span class="deltaxml-new" style="background:#90EE90">4.1 bin:hex</span></b></a></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-bin-binary"><b><span class="deltaxml-new" style="background:#90EE90">4.2 bin:bin</span></b></a></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-bin-octal"><b><span class="deltaxml-new" style="background:#90EE90">4.3 bin:octal</span></b></a></p><p><span class="deltaxml-new" style="background:#90EE90">The way in which the value is adjusted to a whole number of octets has been clarified. The rules have been made more precise, and might not match the interpretation adopted by existing implementations.</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-bin-octal"><b><span class="deltaxml-new" style="background:#90EE90">4.3 bin:octal</span></b></a></p><p><span class="deltaxml-new" style="background:#90EE90">The argument type for </span><code><span class="deltaxml-new" style="background:#90EE90">$octet</span></code><span class="deltaxml-new" style="background:#90EE90"> is changed from </span><code><span class="deltaxml-new" style="background:#90EE90">xs:integer</span></code><span class="deltaxml-new" style="background:#90EE90"> to </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90">. This is made possible by the more liberal coercion rules defined in XPath 4.0. A consequence of the change is that supplying an out-of-range integer value is now a type error with the standard error code </span><code><span class="deltaxml-new" style="background:#90EE90">XPTY0004</span></code><span class="deltaxml-new" style="background:#90EE90">, rather than the custom error code </span><code><span class="deltaxml-new" style="background:#90EE90">bin:octet-out-of-range</span></code><span class="deltaxml-new" style="background:#90EE90"> previously used.</span></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-bin-pad-left"><b><span class="deltaxml-new" style="background:#90EE90">5.5 bin:pad-left</span></b></a></p><p><span class="deltaxml-new" style="background:#90EE90">See </span><a href="#func-bin-pad-right"><b><span class="deltaxml-new" style="background:#90EE90">5.6 bin:pad-right</span></b></a></p></li></ol></div><div class="div2"><h3><a id="changes-to-function-signatures"></a>F.2 <a href="#changes-to-function-signatures" style="text-decoration: none">Changes to Function Signatures</a></h3><ol class="enumar"><li><p>The function signatures of all the specified signatures now use the 'optional argument' syntax of XPath 4.0 where appropriate, rather than giving several signatures of differing arity. Other than that, no intended change to the semantics of the functions are assumed.</p></li></ol></div><div class="div2"><h3><a id="editorial-changes"></a>F.3 <a href="#editorial-changes" style="text-decoration: none">Editorial Changes</a></h3><p>These changes are not highlighted in the change-marked version of the specification.</p><ol class="enumar"><li><p>The example functions in <a href="#example-ASN1"><b>2.2 Example – reading and writing variable length ASN.1 integers</b></a> have been moved into a differing namespace prefix (<code>asn:</code>) to avoid suggesting that they are part of the supported function set. This is in accordance with the principle that the namespace <code>http://expath.org/ns/binary</code> is reserved solely for use in QNames for functions specified in this module.</p></li></ol></div></div><div class="div1"><h2><a id="back-compatibility"></a>G <a href="#back-compatibility" style="text-decoration: none">Compatibility with Previous Versions</a> (Non-Normative)</h2><p>This section summarizes the extent to which this specification is compatible with previous versions.</p><p>Version 4.0 of this function library is fully backwards compatible with version 1.0, except as noted below:</p><ol class="enumar"><li><p>The use of optional arguments in the function signatures means that minor alterations to possible function calls, which would be invalid in 1.0, are now supported. For example:</p><div class="exampleInner"><pre xml:space="preserve">bin:decode-string($string,'utf-8',0,())</pre></div><p>would be invalid in 1.0, as the fourth argument <code>$size</code> is defined to be of type <code>xs:integer</code>. It is valid for 4.0 as the empty sequence denotes default behaviour, that is decoding all octets after <code>$offset</code></p><p>The functions <a href="#func-bin-decode-string"><code>bin:decode-string</code></a>,<a href="#func-bin-encode-string"><code>bin:encode-string</code></a>, <a href="#func-bin-pack-double"><code>bin:pack-double</code></a>, <a href="#func-bin-pack-float"><code>bin:pack-float</code></a>, <a href="#func-bin-pack-integer"><code>bin:pack-integer</code></a>, <a href="#func-bin-pad-left"><code>bin:pad-left</code></a>, <a href="#func-bin-pad-right"><code>bin:pad-right</code></a>, <a href="#func-bin-part"><code>bin:part</code></a>, <a href="#func-bin-unpack-double"><code>bin:unpack-double</code></a>, <a href="#func-bin-unpack-float"><code>bin:unpack-float</code></a>, <a href="#func-bin-unpack-integer"><code>bin:unpack-integer</code></a> and <a href="#func-bin-unpack-unsigned-integer"><code>bin:unpack-unsigned-integer</code></a> all have similar incompatibilities.</p></li><li class="add_version" style="display: none;"><p>The use of the type <code>xs:unsignedByte</code> for octet arguments, and of an <code>enum</code> type for octet order, means that invalid values for these arguments will now result in a type error [<a href="https://www.w3.org/TR/xpath20/#ERRXPTY0004" title="bin:TY0004">bin:TY0004</a>]<sup><small>XP</small></sup>, rather than a dynamic error with a code in the <code>bin</code> namespace.</p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">The use of the type </span><code><span class="deltaxml-new" style="background:#90EE90">xs:unsignedByte</span></code><span class="deltaxml-new" style="background:#90EE90"> for octet arguments, and of an </span><code><span class="deltaxml-new" style="background:#90EE90">enum</span></code><span class="deltaxml-new" style="background:#90EE90"> type for octet order, means that invalid values for these arguments will now result in a type error [</span><a href="https://www.w3.org/TR/xpath20/#ERRXPTY0004" title="bin:TY0004"><span class="deltaxml-new" style="background:#90EE90">bin:TY0004</span></a><span class="deltaxml-new" style="background:#90EE90">]</span><sup><small><span class="deltaxml-new" style="background:#90EE90">XP</span></small></sup><span class="deltaxml-new" style="background:#90EE90">, rather than a dynamic error with a code in the </span><code><span class="deltaxml-new" style="background:#90EE90">bin</span></code><span class="deltaxml-new" style="background:#90EE90"> namespace.</span></p></li><li class="add_version" style="display: none;"><p>The way in which <code>bin:octal</code> adjusts the supplied value to a whole number of octets is now specified much more precisely, and the result might differ from the interpretation adopted by existing implementations. Specifically, the result might differ through the presence or absence of leading zero octets.</p></li><li class="modify_version"><p><span class="deltaxml-new" style="background:#90EE90">The way in which </span><code><span class="deltaxml-new" style="background:#90EE90">bin:octal</span></code><span class="deltaxml-new" style="background:#90EE90"> adjusts the supplied value to a whole number of octets is now specified much more precisely, and the result might differ from the interpretation adopted by existing implementations. Specifically, the result might differ through the presence or absence of leading zero octets.</span></p></li></ol></div></div><script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script><script src="js/toc.js"></script><script src="/js/scroll.js"></script></body></html>